### NodeJs , npm , package.json

- NodeJsëŠ” ë¸Œë¼ìš°ì € ë°–ì—ì„œ ëŒì•„ê°€ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì´ë‹¤.
- ê·¸ë˜ì„œ node index.js ë¥¼ ì¹˜ë©´ jsíŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¬ìˆ˜ ìˆë‹¤.
- [react](https://velog.io/@jini_eun/React-React.js%EB%9E%80-%EA%B0%84%EB%8B%A8-%EC%A0%95%EB%A6%AC)ë€? í”„ë¡ íŠ¸ì—”ë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬
- [express](https://velog.io/@madpotato1713/JAVASCRIPT-express%EB%9E%80)ë€? nodejsë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ë¥¼ ê°œë°œí•˜ê³ ì í•˜ëŠ” ê°œë°œìë“¤ì„ ìœ„í•˜ì—¬ ì„œë²„ë¥¼ ì‰½ê²Œ êµ¬ì„±í• ìˆ˜ ìˆê²Œ ë§Œë“  í”„ë ˆì„ì›Œí¬ì´ë‹¤.

- npm: ì—¬ëŸ¬ì‚¬ëŒë“¤ì´ íŒ¨í‚¤ì§€ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ”ë° ìš°ë¦¬ëŠ” íŒ¨í‚¤ì§€ë¥¼ ê°€ì ¸ë‹¤ê°€ ì“¸ìˆ˜ìˆë‹¤. ê°œë°œì„ ì‰½ê²Œ ë§Œë“¤ì–´ì£¼ë‹ˆê¹Œ, ê·¸ë˜ì„œ npmì„ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ ëˆ„êµ°ê°€ê°€ ë§Œë“¤ì–´ ë†“ì€ íŒ¨í‚¤ì§€ë¥¼ ì‰½ê²Œ ì“¸ìˆ˜ ìˆë‹¤.
- json: í”„ë¡œê·¸ë˜ë¨¸ê°€ íŒŒì¼ì— ì •ë³´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ ë§Œë“  ë°©ì‹ ì¤‘ í•˜ë‚˜. ê·¸ëƒ¥ í…ìŠ¤íŠ¸ íŒŒì¼ì¼ë¿ì´ë‹¤.
- "scripts" ë€? ë‚´ê°€ ì‹¤í–‰í•˜ê³ ì‹¶ì€ê²ƒì„ ë§í•¨. ê·¸ë˜ì„œ node index.jsë¥¼ í•˜ëŠ”ê²ƒì„ npmì´ í•˜ë„ë¡ ë§Œë“¤ ìˆ˜ìˆìŒ(npm run ~~). ë‚˜ì¤‘ì—ëŠ” ì„œë²„ë¥¼ ì‹œì‘í•˜ëŠ” script, cssë¥¼ ì••ì¶•í•˜ëŠ” script, ì›¹ì‚¬ì´í‹€ ë¹Œë“œí•˜ê³  ì„œë²„ì— ë°°í¬í•˜ëŠ” scriptë“±ë“±. ìš”ì ì€ ë‚´ê°€ ë§Œë“  scriptë¥¼ í„°ë¯¸ë„ì—ì„œ ì“¸ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.
- ì²˜ìŒ ì‹œì‘í• ë•Œ npm init

### npmjs package express, package.json

- [npm](https://www.npmjs.com/) i express
- express í´ë”ì˜ pakcage.jsoníŒŒì¼ì„ ë³´ë©´ <u>dependenciesê°€</u> ìˆëŠ”ë° expressê°€ ì‘ë™ë˜ë ¤ë©´ í•„ìš”í•œ íŒ¨í‚¤ì§€ë“¤ì„ ë§í•œë‹¤. ê·¸ë˜ì„œ expressë‹¤ìš´ë¡œë“œë°›ì„ë•Œ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ ëœë‹¤.
- ì²´ì¸ì²˜ëŸ¼ íŒ¨í‚¤ì§€ë“¤ì´ ì„œë¡œë¥¼ í•„ìš”ë¡œ í•œë‹¤. ê·¸ë˜ì„œ ìë™ìœ¼ë¡œ ì—°ê²°ëœë‹¤.
- npmì´ ë˜‘ë˜‘í•´ì„œ dependenciesì— ìˆëŠ” ëª¨ë“ˆë“¤ì„ ìë™ìœ¼ë¡œ ì„¤ì¹˜í•´ì¤€ë‹¤. npm ië§Œ í•´ë„
- ì´ë˜ì„œ package.jsonì´ë¼ëŠ” íŒŒì¼ì´ ì¤‘ìš”í•˜ë‹¤. í”„ë¡œì íŠ¸ë¥¼ ë™ì‘ì‹œí‚¬ë•Œ í•„ìš”í•œ ëª¨ë“ˆë“¤ì´ ì–´ë–¤ê±´ì§€ ì •ë³´ë¥¼ ë‹´ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.
- node_modulesë¥¼ ê¹ƒí—ˆë¸Œì— ì˜¬ë¦´í•„ìš”ê°€ ì—†ë‹¤. ì´ë˜ì„œ ì¤‘ìš”í•œë“¯. ê·¸ë˜ì„œ ì¹œêµ¬ê°€ í”„ë¡œì íŠ¸ë¥¼ ì—´ì–´ì„œ npm ië§Œ í•´ì£¼ë©´ ë˜ëŠ”ê²ƒì´ë‹¤.
- devDependenciesì— ì¶”ê°€ë˜ëŠ” ëª¨ë“ˆë“¤ë„ ìˆëŠ”ë° ì´ê²ƒì€ ê°œë°œìì—ê²Œ í•„ìš”í•œ dependenciesë¥¼ ë§í•˜ëŠ” ê²ƒì´ë‹¤. --save-dev ì˜µì…˜ì„ ì£¼ë©´ dev~ì— ì¶”ê°€ëœë‹¤.

### package-lock.json

- ë‚˜ì˜ íŒ¨í‚¤ì§€ë“¤ì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•´ì¤€ë‹¤. ê·¸ë˜ì„œ ë‹¤ë¥¸ì‚¬ëŒë“¤ë„ npm i ë§Œ í•˜ë©´ ì •í™•íˆ ë‚˜ë‘ ë˜‘ê°™ì€ ë²„ì „ì„ ë‹¤ìš´ë¡œë“œ ë°›ê²Œ ëœë‹¤.(ë‚˜ì˜ package.jsoníŒŒì¼ì„ ê°€ì§€ê³ ìˆëŠ” ìƒíƒœì—¬ì•¼í•œë‹¤.) npmì´ ë˜‘ë˜‘í•´ì„œ ë‹¤ ê´€ë¦¬ í•´ì¤€ë‹¤.

### Babel

- nodeJSê°€ ì´í•´í•˜ì§€ ëª»í•˜ëŠ” ìµœì‹ ì½”ë“œë¥¼ [babel](https://babeljs.io/setup#installation)nodeê°€ ì»´íŒŒì¼í•´ì¤„ê²ƒì´ë‹¤. ê²€ìƒ‰í‚¤ì›Œë“œ babel install ë§¨ìœ„ ê²Œì‹œë¬¼.
- touch babel.config.json , touchë¼ëŠ” ëª…ë ¹ì–´ëŠ” íŒŒì¼ì„ ë§Œë“¤ì–´ ì£¼ëŠ” ëª…ë ¹ì–´ì´ë‹¤.
- "presets": ["@babel/preset-env"] ì€ ìµœì‹  ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì“¸ìˆ˜ ìˆëŠ” í”ŒëŸ¬ê·¸ì¸ì´ë‹¤.
- ìµœì¢…ì ìœ¼ë¡œ babel-nodeë¥¼ ì„¤ì¹˜í•˜ë©´ babelë¡œ jsíŒŒì¼ì„ ìµœì‹ ë¬¸ë²•ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¬ìˆ˜ ìˆë‹¤.
  babel-node index.js
- [nodemon](https://shlee0882.tistory.com/231)ì€ ìš°ë¦¬ê°€ ë§Œë“  íŒŒì¼ì´ ìˆ˜ì •ë˜ëŠ”ê±¸ ê°ì‹œí•´ì£¼ë©°,ì•Œì•„ì„œ ì¬ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ê¸°ëŠ¥ì„ ê°–ê³ ìˆë‹¤. ê·¸ë˜ì„œ npm run devë¼ëŠ”ê²ƒì„ ê³„ì† í•´ì¤„ í•„ìš”ëŠ” ì—†ìŒ. [ì •ì‹ë§í¬](https://www.npmjs.com/package/nodemon)

### server,callback

- ì„œë²„ëŠ” í•­ìƒ ì¼œì ¸ ìˆê³ , ì¸í„°ë„·ì— ì—°ê²°ë¼ìˆëŠ” ì»´í“¨í„°ë¼ê³  í• ìˆ˜ ìˆë‹¤.
- requestë¥¼ ë³´ë‚´ë©´ í•­ìƒ ë‹µí•´ì¤€ë‹¤.
- ì„œë²„ëŠ” listeningì¤‘ì´ê³  ë„ˆë¥¼ ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤.-> ì„œë²„ê°€ ì‚¬ëŒë“¤ì´ ë­”ê°€ë¥¼ ìš”ì²­í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê²Œ í•´ì•¼í•œë‹¤.

```js
app.listen(PORT, handleListening); //ì„œë²„ê°€ ë§Œë“¤ì–´ì¡Œê³ , ì„œë²„ì—ê²Œ ì–´ë–¤ portë¥¼ listeningí• ì§€ ì–˜ê¸°í•´ì¤˜ì•¼í•œë‹¤.
```

- ì„œë²„ê°€ ë‚´ ì»´í“¨í„° ì „ì²´ë¥¼ listení• ìˆ˜ëŠ” ì—†ë‹¤. ì´ë¯¸ ë§ì€ í”„ë¡œê·¸ë¨ë“¤ì´ portë“¤ì„ í†µí•´ì„œ ì†Œí†µí•˜ê³ ìˆë‹¤. 4000ë²ˆì„ ì“°ëŠ”ê²Œ ë°±ì•¤ë“œì—ì„œëŠ” ê´€ë¡€ì´ë‹¤. ë‚˜ì¤‘ì—ëŠ” ì´ portê°€ ì´ë¯¸ì“°ê³ ìˆë‹¤ê³  ì—ëŸ¬ê°€ ìƒê¸¸ìˆ˜ë„ ìˆë‹¤.
- ë’¤ì—ìˆëŠ” í•¨ìˆ˜ê°€ [callback](https://dalkomit.tistory.com/65)í•¨ìˆ˜ë¼ê³  í•˜ëŠ”ì§€ëŠ” ëª¨ë¥´ê² ëŠ”ë°(ì´ í•¨ìˆ˜ëŠ” listeningì´ ì‹œì‘ë˜ë©´ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì´ë‹¤.),
  ë¬´ì—‡ì¸ê°€ ì¼ì„ ë‹¤ë¥¸ ê°ì²´ì—ê²Œ ì‹œí‚¤ê³ , ê·¸ì¼ì´ ëë‚˜ëŠ”ê²ƒì„ ê¸°ë‹¤ë¦¬ëŠ”ê²Œ ì•„ë‹ˆë¼, ë‚˜ë¥¼ ë‹¤ì‹œ ë¶€ë¥¼ë•Œê¹Œì§€ ë‚´í• ì¼ í•˜ê³ ìˆëŠ”ê²ƒ..., ë¹„ë™ê¸° ë°©ì‹ì´ë¼ê³ í•œë‹¤. -> ë’¤ì—ë” ìì„¸í•˜ê²Œ ì„¤ëª…í•œê±°ìˆìŒ

### requestì— respondí•˜ëŠ”ë°©ë²•ì„ ì•Œì•„ë³¼ê²ƒì´ë‹¤.

- localhost:4000 ë¥¼ ì›¹í˜ì´ì¦ˆì—ì„œ ì‹¤í–‰í•´ë³´ë©´ "Cannot GET /"ì´ë¼ëŠ”ê²ƒì´ ëœ¬ë‹¤.
- / ì„œë²„ì˜ root, í˜¹ì€ ì²« í˜ì´ì§€ë¥¼ ì˜ë¯¸í•œë‹¤. google.com === google.com/
- GETì€ HTTP methodì´ë‹¤, HTTPë€? ìš°ë¦¬ê°€ ì„œë²„ì™€ ì†Œí†µí•˜ëŠ”ë°©ë²•, ì„œë²„ê°€ ì„œë¡œ ì†Œí†µí•˜ëŠ” ë°©ì‹ì´ë‹¤. ê·¸ë˜ì„œ ì£¼ì†Œì— ì ‘ì†í•˜ë©´ ë¸Œë¼ìš°ì €ê°€ ëŒ€ì‹ í•´ì„œ http requestë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.
  ì¦‰ ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í•˜ê³  ì„œë²„ì— ì •ë³´ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•ì´ë‹¤. get this page(í˜ì´ì§€ë¥¼ ê°–ë‹¤ì¤˜)ì™€ ê°™ì€ ì˜ë¯¸ì´ë‹¤. ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í•˜ë ¤í• ë•Œ, ë„ˆê°€ ì§ì ‘ ì ‘ì†í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼, ë„ˆë„¤ í™ˆí˜ì´ì§€ë¥¼ ê°€ì ¸ë‹¤ì¤˜ ë¼ëŠ” ì˜ë¯¸. ë¸Œë¼ìš°ì €ê°€ ê°€ì ¸ë‹¤ ì£¼ëŠ”ê²ƒì´ë‹¤.

```js
app.get("/", () => console.log("Somebody is trying to go home.")); //ëˆ„ê°€ rootí˜ì´ì§€ì— ìš”ì²­ì„ ë³´ë‚¸ë‹¤ë©´, ì´ callbackí•¨ìˆ˜ë¥¼ ì‹¤í–‰í• ê²ƒì´ë‹¤.
// ë¸Œë¼ìš°ì €ê°€ get requestsë¥¼ ë³´ë‚´ê³  ìˆëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì´ëŸ°ì‹ìœ¼ë¡œëŠ” responseë¥¼ í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ê³„ì† ë¡œë”©ì¤‘ì¼ê²ƒì´ë‹¤.

const handleHome = (req, res) => {
  console.log(req);
  return res.end(); // requestë¥¼ ë³´ë‚´ë©´ returnìœ¼ë¡œ responseë¥¼ í•´ì¤˜ì•¼ í•˜ê³ , ì´ ë©”ì„œë“œëŠ” responseë¥¼ ëë‚´ê² ë‹¤ëŠ” ê²ƒì´ë‹¤.
  return res.send("i still love you"); // ì´ë ‡ê²Œë„ í• ìˆ˜ ìˆë‹¤. ì´ëŸ¬ë©´ ë¸Œë¼ìš°ì €ê°€ ê¸€ì”¨ê°€ ë‚˜ì˜¨ë‹¤.
  // ì´ëŸ¬í•œê²ƒë“¤ì„ í•œì¤„ë¡œ ì“°ë©´ returnì„ ìƒëµí•´ë„ëœë‹¤.
};
// eventlistenerì— ë¸Œë¼ìš°ì €ê°€ ê³µì§œë¡œ eventë¼ëŠ” argumentì— ë„£ì–´ì£¼ëŠ”ê²ƒì²˜ëŸ¼, route handlerì—ëŠ” ë‘ê°œì˜ objectê°€ ìˆë‹¤.(request,response)
// ì¦‰ homeìœ¼ë¡œ get requestê°€ ì˜¤ë©´, expressëŠ” handleHomeì—ë‹¤ê°€ ë‘ê°œì˜ objectë¥¼ ë„£ì–´ì£¼ëŠ” ê²ƒì´ë‹¤.
// request objectë¥¼ ì‚´í´ë³´ë©´ ì¿ í‚¤ë‚˜ methodê°™ì€ ì •ë³´ë¥¼ ì–»ì„ìˆ˜ ìˆì—ˆë‹¤.
```

- [document](https://expressjs.com/ko/api.html#express) ë©”ì†Œë“œë“¤ì— ëŒ€í•œ ì„¤ëª…ì´ ìˆë‹¤. ì—¬ê¸°ì— ìˆëŠ”ê²Œ ì „ë¶€ì´ë‹¤.
- ì–´ë–¤ ì‚¬ì´íŠ¸ì— ì ‘ì†í• ë•Œë§ˆë‹¤ get request ìƒì„±í•˜ê³ , ì´ get requestì— ì‘ë‹µí•˜ëŠ” ì„œë²„ê°€ ìˆì–´ì•¼ í•œë‹¤.
- [Route](https://dog-paw.tistory.com/entry/7-MEAN-%EC%8A%A4%ED%83%9D-Express-Route-%EC%A0%95%EC%9D%98)routeëŠ” ê·¸ëƒ¥ urlì´ë¼ê³  ë³´ë©´ë ë“¯í•˜ë‹¤. ê²½ë¡œ! [Route](https://stylishc.tistory.com/120) - routerëŠ” handlerë¡œ URLì„ ì •ëˆí•˜ëŠ” ê²ƒì´ë‹¤.

### middleware ~=== controller , next()

```js
const gossipMiddleware = (req, res, next) => {
  console.log("I`m in the miiddle!");
  console.log(`Someone is going to ${req.url}`);
  next(); //express next()ë¥¼ ë³´ê³  ë‹¤ìŒí•¨ìˆ˜ì¸ handleHomeì„ í˜¸ì¶œí• ê²ƒì´ë‹¤.
  // ê·¸ë˜ì„œ ì´ëŸ°ì‹ìœ¼ë¡œ ë³´ë©´ handleHomeì€ final wareê°€ ë˜ëŠ”ê²ƒì´ë‹¤.
  // ëª¨ë“  controllerê°€ middlewareê°€ ë ìˆ˜ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œê³  ìˆìœ¼ì…ˆ.
  // middlewareëŠ” requestì— ì‘ë‹µí•˜ëŠ”ê²ƒì´ ì•„ë‹Œ ì§€ì†ì‹œì¼œì£¼ëŠ”ê²ƒì´ë‹¤.
};

const handleHome = (req, res) => {
  return res.send("I love middlewares");
};
// nextëŠ” ë‹¤ìŒ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œì¼œì¤€ë‹¤.

app.get("/", gossipMiddleware, handleHome); // ì´ëŸ°ì‹ìœ¼ë¡œ ì—°ê²°ë˜ì–´ìˆì–´ì•¼ next()ë¥¼ í–ˆì„ë•Œ ë‹¤ìŒí•¨ìˆ˜ë¡œ ì´ë™í•œë‹¤.
```

- [expressjs.com](https://expressjs.com/ko/guide/using-middleware.html)
- ì¤‘ê°„ì— ìˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì˜ë¯¸í•œë‹¤. ë¸Œë¼ìš°ì €ê°€ ë­”ê°€ë¥¼ requestë¥¼ í•˜ë©´ ì„œë²„ê°€ responseë¥¼ í•´ì¤€ë‹¤. ì´ ì‚¬ì´ì— middlewareê°€ ìˆëŠ” ê²ƒì´ë‹¤. ëª¨ë“  handlerê°€ middlewareì´ë‹¤.
- handlerë¼ëŠ” ë§ëŒ€ì‹  controllerë¼ëŠ” ë§ì„ ì´ì œë¶€í„° ì“¸ê²ƒì´ë‹¤. controllerì—ëŠ” ì‚¬ì‹¤
  req,res ë‘ê°œë§ê³  ì¸ìê°€ í•˜ë‚˜ ë”ìˆë‹¤. ê·¸ê²Œë°”ë¡œ ë‹¤ìŒí•¨ìˆ˜ë¥¼ ê°€ë¥´í‚¤ëŠ” nextì´ë‹¤.
- í•¨ìˆ˜ë¥¼ controllerë¼ê³  ìƒê°í•´ë„ë ë“¯í•˜ë‹¤.
- next()ë¥¼ ì‚¬ìš©í•´ì•¼ middlewareë¼ê³ í•œë‹¤. ì—†ìœ¼ë©´ middlewareë¼ê³ í• ìˆ˜ì—†ë‹¤. ì—°ê²°ì´ ëŠì–´ì§€ê¸° ë•Œë¬¸ì´ë‹¤. controllerì™€ middlewareê°€ ê±°ì˜ ê°™ì€ ì˜ë¯¸ë¡œ ì“°ì¸ë‹¤.
- ë§ˆì§€ë§‰ controolerì—ëŠ” nextë¥¼ ê´€ìŠµì ìœ¼ë¡œ ì“°ì§€ ì•ŠëŠ”ë‹¤.

### app.use()

- ì–´ë–¤ urlì—ë„ ì‘ë™í•˜ëŠ” middlewareë¥¼ ë§Œë“¤ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.
- ì¦‰, ëª¨ë“  routeì—ì„œ ì´ í•¨ìˆ˜ë¥¼ ì‚¬ìš© í•˜ëŠ” ê²ƒì´ë‹¤.
- app.get()ë³´ë‹¤ ë†’ì€ìœ„ì¹˜ì— ë‘¬ì•¼ ëª¨ë“  routeì—ì„œ ì‘ë™ì„ í•œë‹¤.
- ìˆœì„œê°€ ì¤‘ìš”í•˜ë‹¤. ì‹œê°í™” í•˜ëŠ” ë°©ë²•ì€ ì—°ê²°ì´ ìœ„ì—ì„œë¶€í„° ì°¨ë¡€ëŒ€ë¡œ ì˜¨ë‹¤ê³  ìƒê°í•˜ì.

### middleware morgan

- [morgan](https://www.npmjs.com/package/morgan) nodejsìš© request logger middlewareì´ë‹¤.
- morganí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´, ë‚´ê°€ ì„¤ì •í•œëŒ€ë¡œ middlewareë¥¼ returní•´ì¤€ë‹¤. í•¨ìˆ˜ë¥¼ ë¦¬í„´í•´ì£¼ëŠ”ê²ƒì´ë‹¤.!(ë‹¤ì„¯ê°€ì§€ì˜µì…˜ì´ ìˆë‹¤. ì†ŒìŠ¤ì½”ë“œë“¤ë„ ë³¼ìˆ˜ìˆëŠ”ë° í•œë²ˆë³´ë©´ ì¢‹ì„ë“¯. ë¬¸ì„œë„.)
- app.use(~~) callbackí•¨ìˆ˜ì´ê¸°ë•Œë¬¸ì—, rendergí•´ì¤€ë’¤ì— ì‹¤í–‰ëœë‹¤.

### routerë€?

- ë‚´ê°€ ì‘ì—…ì¤‘ì¸ ì£¼ì œë¥¼ ê¸°ë°˜ìœ¼ë¡œ URLì„ ê·¸ë£¹í™” í•´ì¤€ë‹¤.

```js

//ê¸€ë¡œë²Œ ë¼ìš°í„°
/ -> Home
/join -> Join
/login -> Login
/search -> Search
// ë…¼ë¦¬ìƒìœ¼ë¡œëŠ” user/loginì¸ë° ì˜ˆì™¸ìƒí™©ìœ¼ë¡œ URLì„ ê¹”ë”í•˜ê²Œí•˜ê³ , ì§§ê²Œí•œë‹¤.
// ê²°ë¡ ì€ URLì„ ê¹”ë”í•˜ê²Œí•˜ê¸°ìœ„í•´ ì˜ˆì™¸ìƒí™©ì„ ë‘˜ìˆ˜ìˆë‹¤.
//ìœ ì € ë¼ìš°í„°
/users/edit -> Edit user
/users/delete -> Delete user
//ë¹„ë””ì˜¤ ë¼ìš°í„°
/videos/watch -> Watch Video
/videos/edit -> Edit Video
/videos/delete -> Delete Video
/videos/comments -> Comment on a video
/videos/comments/delete -> Delete A Comment of a Video

/delete-users -> /users/delete //ì´ëŸ°ì‹ìœ¼ë¡œ ë°”ê¾¸ì–´ ê´€ë¦¬ë¥¼ ì‰½ê²Œ í• ìˆ˜ìˆë‹¤. ì½”ë“œê°€ í•œê³³ì— ë„ˆë¬´ëª¨ì—¬ìˆìœ¼ë©´ ë³µì¡í•˜ë‹ˆê¹Œ
/users //ë¥¼ë§Œë“¤ê³  ê·¸ë’¤ì— URLì„ ì¶”ê°€í•´ì£¼ëŠ”ê²ƒì´ë‹¤.
```

- [routing](http://expressjs.com/en/starter/basic-routing.html) :íŠ¹ì • ì—”ë“œí¬ì¸íŠ¸(íŠ¹ì •ê²½ë¡œì— == URL)ì— ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‘ë‹µí•˜ëŠ” ë°©ì‹ì„ ê²°ì •í•˜ëŠ”ê²ƒì„ ë§í•¨.
- expressì—ì„œ ì œê³µí•˜ëŠ” (express.router)[https://expressjs.com/ko/guide/routing.html]ë¥¼ ì´ìš©í•˜ë©´ ëª¨ë“ˆë¡œì¨ ì‰½ê²Œ ê´€ë¦¬í• ìˆ˜ìˆë‹¤. urlì´ ì–´ë–»ê²Œ ì‹œì‘í•˜ëŠ”ì§€ì— ë”°ë¼ ë‚˜ëˆ„ëŠ” ë°©ë²•ì´ë‹¤.(ê³µí†µ ì‹œì‘ë¶€ë¶„ìœ¼ë¡œ ê·¸ë£¹í™”)
- urlì„ ê·¸ë£¹ìœ¼ë¡œ ì •ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ í˜ë“¤ì–´ì§€ë‹ˆê¹Œ.

```js
//server.js
app.use(logger);
app.use("/", globalRouter);
app.use("/videos", videoRouter);
app.use("/users", userRouter);
// Routerë“¤ì€ ë”°ë¡œ íŒŒì¼ì„ ë§Œë“¤ì–´ì„œ ëª¨ë“ˆí™” í•´ì£¼ì—ˆë‹¤.
```

- /videosë¡œ ê²½ë¡œë¡œì˜¤ë©´ videoRouterë¡œ ì¼ë‹¨ ë“¤ì–´ê°„ë’¤, ê±°ê¸°ì„œë‹¤ì‹œ(videoRouter.jsíŒŒì¼ì—ì„œ,í•˜ë‚˜ì”© ìª¼ê°œì„œ ëª¨ë‘˜í™” í•´ì¤¬ìœ¼ë‹ˆê¹Œ) /watch, /editì„ ì°¾ì•„ ì´ë™í•œë‹¤.

### controller == function

- routeríŒŒì¼ì•ˆì—ëŠ” routeríŒŒì¼ë§Œ ìˆì–´ì•¼í•˜ê¸°ë•Œë¬¸ì— controller(function)í´ë”ë¥¼ ë˜ ë”°ë¡œ ë§Œë“¤ì–´ ì¤„ê²ƒì´ë‹¤.
- ë‚˜ì¤‘ì—ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë“± ì—¬ëŸ¬ê°€ì§€ë¥¼ ë„£ì–´ì•¼í•˜ê¸° ë•Œë¬¸ì— ë¶„ë¦¬í•˜ëŠ”ê²Œ ì¢‹ë‹¤.
- routerëŠ” ê²°êµ­ controller(function)ì„ ì‚¬ìš©í•˜ëŠ” ì…ì¥ì´ë‹¤.
- ê²°êµ­, ìƒê°í•´ë³´ë‹ˆ routerë¼ëŠ” ê°œë…ì´ ë‚˜ì˜¨ê²ƒë„ ëª¨ë‘ í•œíŒŒì¼ì— ë†”ë‘ê¸°ì—ëŠ” ë„ˆë¬´ ë³µì¡í•´ì§€ë‹ˆ ì„¸ì„¸í•˜ê²Œ ë‚˜ëˆˆë“¯ í•˜ë‹¤.

### export import

- ë‚´ í”„ë¡œì íŠ¸ì˜ íŒŒì¼ë“¤ì€ ëª¨ë‘ë‹¤ ë…ë¦½ì ì´ê¸°ë•Œë¬¸ì— exportì„ í•´ì•¼ë§Œ ê³µìœ í• ìˆ˜ ìˆë‹¤.

```js
//globalRouter.js
globalRouter.get("/", handleHome);

export default globalRouter;
// defaultì˜ ëœ»ì€ ë‹¤ë¥¸ íŒŒì¼ì—ì„œ importë¥¼ í• ë•Œ
// import aijewfi from "./routers/globalRouter"; ì´ëŸ°ì‹ìœ¼ë¡œ ì´ë¦„ì„ ë§ˆìŒëŒ€ë¡œí• ìˆ˜ìˆë‹¤. í•˜ì§€ë§Œ í—·ê°ˆë¦´ìˆ˜ìˆê¸°ë•Œë¬¸ì— ëŒ€ë¶€ë¶„ ë˜‘ê°™ê²Œ í•œë‹¤.
```

- export default: ìœ„ì²˜ëŸ¼ defaultë¥¼ í•˜ë©´ í•˜ë‚˜ë°–ì— exportë¥¼ í•˜ì§€ëª»í•œë‹¤. ì—¬ëŸ¬ê°œë¥¼ í• ë ¤ë©´? [Link](https://ko.javascript.info/import-export) ëŒ€ë¶€ë¶„ ì—¬ëŸ¬ê°œë¥¼ exportí•œë‹¤.
- export default ì¸ê²½ìš°ì—ëŠ” importí• ë•Œ ì´ë¦„ì„ ë§ˆìŒëŒ€ë¡œ í• ìˆ˜ ìˆì§€ë§Œ, exportë¥¼ ì—¬ëŸ¬ê°œë¥¼ í•´ì•¼í• ê²½ìš° ì •í™•íˆ ê·¸ ì´ë¦„ìœ¼ë¡œ ì„¤ì •í•´ì£¼ì–´ì•¼í•œë‹¤.
- (DBë¶€ë¶„ì— ì ì–´ë†“ì€ê±° ê°€ì ¸ì˜´. )import exportë¥¼ ë³´ë©´ì„œ ë‹¤ìŒì— ë‚´ê°€ ë‹¤ë¥¸ ì–¸ì–´ë¥¼ ë³´ë©´ ì´ë ‡ê²Œí• ìˆ˜ìˆì„ê¹Œ ë¼ëŠ” ìƒê°ì´ë“¤ì—ˆë‹¤ -> ê³„ì†ê³ ë¯¼í•´ë´£ëŠ”ë° ë„ˆë¬´ ì–´ë µê²Œ ìƒê°í•œë“¯í•˜ë‹¤. ëª¨ë‘ê·¸ëƒ¥ í•œ íŒŒì¼ì— ì ì„ìˆ˜ ìˆëŠ”ë°, ê·¸ëŸ¬ë©´ ë„ˆë¬´ ì–´ì§€ëŸ¬ìš°ë‹ˆê¹Œ ë”°ë¡œë”°ë¡œ ìª¼ê°œì„œ í•˜ëŠ”ê±°ê³  ê·¸ê²ƒì„ ë‹¨ì§€ ì—°ê²°ë§Œ ì‹œì¼œì¤¬ì„ë¿ì´ë¼ê³  ìƒê°í•˜ê¸°ë¡œ í–ˆë‹¤.

### Plannig Routes

- ì–´ë–¤ê¸°ëŠ¥ì´ í•„ìš”í•œê°€ì— ë”°ë¼ì„œ ë¯¸ë¦¬ ê³„íšì„ ì„¸ì›Œì¤˜ì•¼ëŒ. README.mdíŒŒì¼ì— ë¯¸ë¦¬ ì •ë¦¬í•˜ë©´ì„œ ë‹ˆê¼¬ëŠ” í•¨.(ì»¤ë§¨ë“œí‚¤ + í´ë¦­ í•˜ë©´ ë§í¬ë¡œ íŒŒì¼ì´ ìƒˆë¡œì—´ë¦°ë‹¤. importë¶€ë¶„ ë§í¬+ í•¨ìˆ˜ë„ ì •ì˜ë˜ì–´ ìˆëŠ”ë°ë¡œ ì´ë™í•œë‹¤.)

### URL ì— ë³€ìˆ˜ë¥¼ í¬í•¨ì‹œí‚¤ê²Œ í•´ì¤€ë‹¤. URL Parameters

```js
videoRouter.get("/:id/edit", edit);
// idì´ë“¯ potatoì´ë“¯ ìƒê´€ì—†ë‹¤. :ê°€ í•„ìš”í•˜ë‹¤.
//constrollerì—ì„œ
console.log(req.params); // ë˜ëŠ” console.log(req.params.id);
// ì´ëŸ°ì‹ìœ¼ë¡œí•˜ë©´ expressê°€ ë°›ì•„ë“¤ì´ë‹¤ëŠ” ê²ƒì„ ì•Œìˆ˜ ìˆë‹¤.
// ë¼ìš°í„°ì—ì„œ :idì˜ ìœ„ì¹˜ê°€ ì¤‘ìš”í•˜ë‹¤. ë§¨ìœ„ì— ìˆìœ¼ë©´ ë¬´ì—‡ì„í•˜ë“  ë¬´ì¡°ê±´ ë³€ìˆ˜ë¡œ ë°›ì•„ë“¤ì´ê¸°ë•Œë¬¸ì´ë‹¤.
```

- [expressjs](http://expressjs.com/en/guide/routing.html) -> ì •ê·œì‹ìœ¼ë¡œë„ ì„ íƒí• ìˆ˜ìˆë‹¤.
- ì—¬ê¸°ì„œ :idë¥¼ í•´ì£¼ë©´ ë³€ìˆ˜ë¡œ ì“¸ìˆ˜ìˆë‹¤.(í”¼ë¼ë¯¸í„°ë¼ê³  í•œë‹¤.-> req.paramsí• ë•Œ ê·¸ ê°’ì„ ì˜ë¯¸í•œë‹¤.)
- ì´ë ‡ê²Œ í‘œì‹œí•˜ëŠ”ê±´ expressí•œí…Œ ì´ê²Œ ë³€ìˆ˜ë¼ëŠ”ê±¸ ì•Œë ¤ì£¼ê¸¸ ì›í•´ì„œì´ë‹¤.

### ì •ê·œì‹(regular expression)

- [regular expression](https://chrisjune-13837.medium.com/%EC%A0%95%EA%B7%9C%EC%8B%9D-%ED%8A%9C%ED%86%A0%EB%A6%AC%EC%96%BC-%EC%98%88%EC%A0%9C%EB%A5%BC-%ED%86%B5%ED%95%9C-cheatsheet-%EB%B2%88%EC%97%AD-61c3099cdca8) [expressjs](https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Regular_Expressions): ë¬¸ìì—´ë¡œë¶€í„° íŠ¹ì • ì •ë³´ë¥¼ ì¶”ì¶œí•´ë‚´ëŠ” ë°©ë²•ì´ë‹¤.ëª¨ë“  í”„ë¡œê·¸ë˜ë°ì–¸ì–´ì— ì¡´ì¬í•œë‹¤.
- ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ì—°ìŠµí• ìˆ˜ ìˆëŠ” ê³³ [Link](https://regexr.com/)
- [stackoverflow](https://stackoverflow.com/questions/15228901/express-js-filter-a-number-and-a-string-in-the-url/15229495) ê²€ìƒ‰í‚¤ì›Œë“œ express url only number
- [stackoverflow](https://stackoverflow.com/questions/34095126/express-router-id) ê²€ìƒ‰í‚¤ì›Œë“œ express /:id
- expressë¬¸ì„œì—ì„œ /:id ì— ëŒ€í•œ ë‚´ìš©ì„ ì°¾ì•„ë³´ë‹ˆ [Link](http://expressjs.com/ko/api.html#req) ì—¬ê¸°ìˆì—ˆìŒ. ì´ ë‚´ìš©ì€ expressì—ë§Œ í•´ë‹¹ë˜ëŠ”ê²ƒì¸ê°€?

```js
videoRouter.get("/:id(\\d+)", see);
videoRouter.get("/:id(\\d+)/edit", edit);
videoRouter.get("/:id(\\d+)/delete", deleteVideo);
```

- idë¼ëŠ”ê²ƒì„ ê·¸ëŒ€ë¡œ ë‘” ì´ìœ : ì´ë¦„ì„ ì–»ê¸°ìœ„í•´ì„œ
- \ì˜ ì˜ë¯¸, ì´ê²ƒì€ ë‹¨ìˆœí•œ ë¬¸ìê°€ ì•„ë‹ˆë¼ëŠ”ê²ƒì„ ì•Œë ¤ì£¼ê¸°ìœ„í•´ì„œ

### Express template

- controller(function)ì—ì„œ htmlì„ returní•˜ëŠ”ë°©ë²•ì´ë‹¤.
- [Pug](https://www.zerocho.com/category/NodeJS/post/578c64621e3613150037d3b3) (êµ¬ Jade) - ê°€ì¥ ìœ ìš”í•œ í…œí”Œë¦¿ì¤‘ í•˜ë‚˜. ê³µì‹ [npm](npmjs.com/package/pug) ì—¬ê¸°ì„œ ë³´ëŠ”ê²Œ ì¢‹ì€ë“¯ ê°„ë‹¨í•œ ë¬¸ë²•(Syntax)ë„ ë³¼ìˆ˜ìˆì–´ì„œ.
- expressì—ê²Œ ì´ì œë¶€í„° ì‚¬ìš©í•  ë·° ì—”ì§„ì€ pugë¼ê³  ë§ì„ í•´ì£¼ì–´ì•¼í•œë‹¤.
- [expressjs](https://expressjs.com/ko/4x/api.html#app)ì—ì„œ Application Settings( app.set() )ì„ ë³´ë©´ propertyì— view engineì´ë¼ê³  ìˆë‹¤.
- 1ë‹¨ê³„ pug ì„¤ì¹˜(npm i pug) <br>
  2ë‹¨ê³„ pugë¥¼ ë·° ì—”ì§„ìœ¼ë¡œ ì„¤ì •(app.set("view engine", "pug")) <br>
  3ë‹¨ê³„ ì‹¤ì œë¡œ pugíŒŒì¼ì„ ìƒì„±í•œë‹¤.
- expressjsì—ì„œ ë¬¸ì„œë¥¼ ë³´ë©´ viewsì—ì„œ defaultë¡œ process.cwd() + "/views" ë¼ê³  ì í˜€ìˆëŠ”ë°, cwdì˜ ëœ»ì€ current working directoryì´ë‹¤. ì¦‰, í˜„ì¬ í´ë”ì—ì„œ viewsì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ íŒŒì¼ì„ ì°¾ê² ë‹¤ëŠ” ê²ƒì´ë‹¤.
- ì´ì œ pugíŒŒì¼ì„ ë Œë”ë§í•´ì£¼ì–´ì•¼í•˜ëŠ”ë° í•˜ëŠ” ë°©ë²•ì€, res.redner("íŒŒì¼ì´ë¦„")ì´ë‹¤.
- í•˜ì§€ë§Œ ì—ëŸ¬ê°€ ìƒê¸¸ê±°ì„. ì‹¤ì œë¡œ íŒŒì¼ì€ wetube/src/viewsì— ìˆê¸°ë•Œë¬¸ì—(wetube/views)ì—ì„œ ì°¾ìœ¼ë‹ˆ ì•ˆë³´ì´ëŠ”ê±°ì„.(ì—ëŸ¬ë¥¼ ê¼¼ê¼¼íˆ ì½ì–´ì„œ ë­ê°€ ë¬¸ì œì¸ì§€ ì•„ëŠ”ê²Œ ì¤‘ìš”í•œë“¯.)
- í•´ê²°ë°©ë²•ì€ ë””í´íŠ¸ê°’ì„ ìˆ˜ì •í•´ì£¼ëŠ”ê²ƒì„. app.set("views", process.cwd() + "/src/views");
- [ë Œë”ë§](https://velog.io/@ru_bryunak/%EB%A0%8C%EB%8D%94%EB%A7%81%EC%9D%B4%EB%9E%80)ì´ë€? htmlíŒŒì¼ì„ ë°›ì•„ ë¸Œë¼ìš°ì €ì— ë¿Œë ¤ì£¼ëŠ” ê³¼ì •.

### pug Interplation ë³´ê°„ë²• Escape ,HTML Entity

```js
doctype html
html(lang="ko")
    head
        title Wetube
    body
        h1 Welcome to Wetube
        footer &copy; #{new Date().getFullYear()} Wetube
```

- ìœ„ì—ì„œ #{}ì´ëŸ°ì‹(h1=pageTitle ì´ë ‡ê²Œì“°ë©´ variableë¡œ ì¸ì‹í•œë‹¤. í•˜ì§€ë§Œ ì¤‘ê°„ì— ë‹¤ë¥¸ stringì„ ë¼ì›Œë†“ì„ìˆ˜ ì—†ë‹¤.) ìœ¼ë¡œ ì¤‘ê°„ì— Jscode ë¥¼ ê»´ë†“ëŠ”ê²ƒì„ [ë³´ê°„ë²•](https://pugjs.org/language/interpolation.html)ì´ë¼ê³  í•œë‹¤. Pug ë³´ê°„ë²•[ë˜ ë‹¤ë¥¸ ë§í¬](https://sodocumentation.net/pug/topic/9565/interpolation-with-pug)

-ê·¸ë¦¬ê³  &copyë“±ì€ [HTML Entity](https://www.zerocho.com/category/HTML&DOM/post/587f50b1308ed50018a00d51)ë¼ê³ í•œë‹¤.(ì¢‹ì€ì‚¬ì´íŠ¸ì¸ê±°ê°™ë‹¤.) íŠ¹ìˆ˜ë¬¸ìë¥¼ í‘œí˜„í•˜ê¸°ìœ„í•´ ì‚¬ìš©í•œë‹¤.

### pug partials

- ë°˜ë³µë˜ëŠ” ë¶€ë¶„ì„ íŒŒì¼ë¡œ ìª¼ê°œì„œ ì‰½ê²Œ ë¶ˆëŸ¬ì˜¬ìˆ˜ ìˆë‹¤.!
- [ê³µì‹ë¬¸ì„œ](https://pugjs.org/api/getting-started.html) [includes](https://pugjs.org/language/includes.html)ë¥¼ ëˆŒëŸ¬ë³´ë©´ ë‹¤ë¥¸íŒŒì¼ì„ í¬í•¨ì‹œí‚¬ìˆ˜ìˆëŠ” ë°©ë²•ì´ ìˆë‹¤.(ì´ëŸ°ì‹ìœ¼ë¡œ ë¬¸ì„œë¥¼ ì½ëŠ” ë°©ë²•ì„ ì˜ ë°°ì›Œì•¼ í• ê±° ê°™ë‹¤.)
- ì²«ë²ˆì§¸ ì´ê²ƒìœ¼ë¡œ ì•Œìˆ˜ ìˆëŠ”ì ì€ ê¹”ë”í•œ htmlì„ ì‘ì„±í•˜ë„ë¡ í•´ì¤€ë‹¤ëŠ” ê²ƒì´ë‹¤. <br>
  ë‘ë²ˆì§¸ ìš°ë¦¬ì˜ htmlì— ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í¬í•¨ì‹œí‚¬ìˆ˜ ìˆë‹¤ëŠ” ì .
  ì„¸ë²ˆì§¸ ìš°ë¦¬ê°€ ë°˜ë³µí•˜ì§€ í•˜ì§€ì•Šê³  í•œë²ˆì— ëª¨ë“  í…œí”Œë¦¿ì„ ì—…ë°ì´íŠ¸í• ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.
- í”„ë¡œê·¸ë˜ë¨¸ë“¤ì€ ë°˜ë³µë˜ëŠ”ê²ƒì„ ì‹«ì–´í•˜ê¸° ë•Œë¬¸ì—(ê²Œìœ¼ë¥´ê¸°ë•Œë¬¸ì—) ë” ë°˜ë³µë˜ëŠ”ê²ƒì„ ì¤„ì¼ìˆ˜ ìˆë‹¤. ì•„ë˜ì—ì„œ ë°˜ë³µëœë‹¤.

### pug Template Inheritance (ìƒì†)

- [ìƒì†](https://pugjs.org/language/inheritance.html)ì´ ì™œ ì“°ëƒë©´ì€, ì¼ì¢…ì˜ ë² ì´ìŠ¤ í‹€ì„ ë§Œë“¤ì–´ ì£¼ê¸°ë•Œë¬¸ì´ë‹¤. ê³„ì† ë² ì´ìŠ¤ê°€ ë°˜ë³µë˜ê¸°ë•Œë¬¸ì— ê·¸ê²ƒë§ˆì € ì¤„ì—¬ì¤„ë ¤ê³  ìƒì†ì´ë¼ëŠ”ê²ƒì„ ì“°ëŠ”ê²ƒì´ë‹¤.
- ëª¨ë“ íŒŒì¼ì´ ë² ì´ìŠ¤ë¶€í„° í™•ì¥í•´ ë‚˜ê°€ëŠ”ê²ƒì´ë‹¤.
- í•˜ì§€ë§Œ ì—¬ê¸°ì„œ ëë‚˜ëŠ”ê²Œ ì•„ë‹ˆë¼ blockì´ë¼ëŠ” ê°œë…ë„ ì•Œì•„ì•¼ í•œë‹¤. -> ë¬´ì–¸ê°€ë¥¼ ì§‘ì–´ ë„£ì„ìˆ˜ ìˆëŠ”ê³³. ë‹¤ë¥¸ pugíŒŒì¼ì´ ì±„ì›Œë†“ì„ìˆ˜ ìˆëŠ”ê³³. ê³µì‹ ë¬¸ì„œë¥¼ ë³´ë©´ ì•Œìˆ˜ ìˆë‹¤.
- res.render("",{})ëŠ” 2ê°€ì§€ ì¸ìˆ˜ë¥¼ ë°›ëŠ”ë° í•˜ë‚˜ëŠ” view ì´ë¦„ì´ê³  í•˜ë‚˜ëŠ” í…œí”Œë¦¿ì— ë³´ë‚¼ ë³€ìˆ˜ì´ë‹¤. express ë¬¸ì„œë¥¼ ë³´ë©´ ë³€ìˆ˜ë¥¼ ë³´ë‚¼ìˆ˜ ìˆë‹¤ê³  ë‚˜ì™€ìˆê³ , Interplation(ë³´ê°„ë²•)ì™€ í™œìš©í•´ì„œ expressì—ì„œ ë³€ìˆ˜ì˜ ê°’ì„ ë„˜ê¸¸ìˆ˜ ìˆë‹¤.(ë Œë”ë§í•˜ëŠ”ê³¼ì •ì—ì„œ)

### pug conditionals,iteration

- docì— ë„ˆë¬´ ìì„¸íˆ ì˜ë‚˜ì™€ìˆì–´ì„œ ì„¤ëª…ì•ˆí•´ë„ ë ë“¯.
- [conditionals](https://pugjs.org/language/conditionals.html) ì¡°ê±´ë¬¸
- [iteration](https://pugjs.org/language/iteration.html) ë°˜ë³µ
- [mixin](https://pugjs.org/language/mixins.html) ë˜‘ë˜‘í•œ partialì´ë‹¤. ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ì¼ì¢…ì˜ ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ HTML blockì´ë¼ ë³¼ìˆ˜ ìˆë‹¤. [ì»´í¬ë„ŒíŠ¸](https://mommoo.tistory.com/55)ì˜ ì¬ì‚¬ìš©ì„ ìœ„í•´ì„œ ë§Œë“¤ì–´ì§„ë“¯. ìœ íŠœë¸Œë¥¼ ë³´ë©´ ë¹„ë””ì˜¤ì— ëŒ“ê¸€, í‰ì , ì¢‹ì•„ìš” ë“±ë“±ì´ í•˜ë‚˜ì˜ ì»´í¬ë„ŒíŠ¸ë¼ê³  ìƒê°í•˜ê³ , ê·¸ê²ƒë“¤ì„ ì¼ì¼íˆ copy pasteí•˜ê¸°ì—ëŠ” ê²Œìœ¼ë¥´ë‹ˆ, ë°˜ë³µì„ ì¤„ì´ê¸°ìœ„í•´, ê·¸ë¦¬ê³  ì½”ë“œì˜ ì¬ì‚¬ìš©ì„ í•˜ê¸°ìœ„í•´ì„œ.

### MVP css

- HTML íƒœê·¸ì— ëª‡ê°€ì§€ ê¸°ë³¸ìŠ¤íƒ€ì¼ì„ ì…í˜€ì¤€ë‹¤. [Link](https://andybrewer.github.io/mvp/)
- ë„ˆë¬´ ëª»ìƒê¸´ìƒíƒœë¡œ í•˜ë©´ ì¢€ ê·¸ëŸ¬ë‹ˆê¹Œ ë­ë¼ë„ ì…íŒê²ƒì´ë‹¤. ê·¸ëƒ¥ ì„ì‹œë°©í¸ì •ë„.

### í…ìŠ¤íŠ¸ì™€ variableì„ ì„ëŠ”ë²•

```js
a((href = "/video/" + video.id));
a((href = `/video/ + ${video.id}`));

const { id } = req.params;
const id = req.params.id; // ES6ë°©ì‹
```

- [req.parms](https://wooooooak.github.io/web/2018/11/10/req.params-vs-req.query/) ì–´ë–¤ê²ƒì„ í´ë¦­í–ˆì„ë•Œ ì–´ë–¤ objcet í´ë¦­ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í• ìˆ˜ ìˆì„ë“¯.

### ternary operator

- [Link](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Operators/Conditional_Operator) jsì—ì„œ ì œê³µë˜ëŠ” ì—°ì‚°ìì´ë‹¤.

```js
h3 #{video.views} #{video.views === 1 ? "view" : "views" }
```

### ì ˆëŒ€ê²½ë¡œ(absoulte url)ì™€ ìƒëŒ€ê²½ë¡œ(relative url)

-ì œì¼ì•ì— /ê°€ìˆìœ¼ë©´ ì ˆëŒ€ê²½ë¡œ, ë¬´ì¡°ê±´ ë£¨íŠ¸ì—ì„œ ì‹œì‘. <br>
a(href="/edit")--->localhost:4000/edit <br>
a(href="edit")--->localhost:4000/videos/edit <br>
a(href=`${video.id}/edit`)--->localhost:4000/videos/1/edit

> watch.pugì—ì„œ
> href="edit"ì˜ ìƒëŒ€ ê²½ë¡œê°€ ì™œ videos/editìœ¼ë¡œ ê°€ë‚˜ìš”??
> í˜„ì¬ ê²½ë¡œê°€ videos/:idì´ë¯€ë¡œ videos/:id/editìœ¼ë¡œ ê°€ì•¼í•˜ëŠ”ê±° ì•„ë‹Œê°€ìš”??
>
> > No, it does not add to the path, it changes the last path.

### POSTì™€ GET

```js
block content
    h4 Change Titie of video
    form(method="POST")
        input(name="title" placeholder="Viedo Title" value=video.title,required)
        input(value="Save",type="submit")
```

- HTTP method
- [formíƒœê·¸](https://www.nextree.co.kr/p8428/) ê¸°ë³¸ì ìœ¼ë¡œ methodëŠ” GETìœ¼ë¡œ ë˜ì–´ìˆìŒ.
  <br> GETì€ ë°ì´í„°ë¥¼ ìš”ì²­í• ê²½ìš° ì”€, ìš°ë¦¬ê°€ ë„¤ì´ë²„ê²€ìƒ‰í•˜ê±°ë‚˜ ìœ íŠœë¸Œê²€ìƒ‰í• ë•Œ ì”€. URLëì— ë¶™ì–´ì„œ ëˆˆì—ë³´ì„. -> ë³´ì•ˆì— ì·¨ì•½
  <br> POSTì€ ë°ì´í„°ë¥¼ ì²˜ë¦¬í• ê²½ìš° ì”€.ë¡œê·¸ì¸í• ë•Œë‚˜ ìœ íŠœë¸Œ ì œëª©ìˆ˜ì • ë“±ì— ì“°ì„.
  <br> ì¦‰ formíƒœê·¸ì˜ methodëŠ” formê³¼ back endì‚¬ì´ì˜ ì •ë³´ì „ì†¡ì— ê´€í•œ ë°©ì‹ì´ë‹¤. ì°©ê°í•˜ì§€ë§ì•„ì•¼ í• ê²ƒ, postë„ requestë¥¼ ë°›ìœ¼ë©´ response í•´ì¤˜ì•¼í•œë‹¤ëŠ” ê²ƒ.

### POSTë¥¼ ë°›ì•˜ì„ë•Œ back endì—ì„œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•

```js
videoRouter.get("/:id(\\d+)/edit", getEdit);
videoRouter.post("/:id(\\d+)/edit", postEdit);
// ì´ëŸ°ì‹ìœ¼ë¡œ ì§§ê²Œ ì“¸ìˆ˜ë„ ìˆë‹¤.
videoRouter.route("/:id(\\d+)/edit").get(getEdit).post(postEdit);

// postEditì—ì„œ idê°’ì€ ì–´ë””ì„œ ê°€ì ¸ì˜¤ëŠ”ê²ƒì´ëƒ? videoRouterì˜ :idì—ì„œ ê°€ì ¸ì˜¤ëŠ”ê²ƒì´ë‹¤.
export const postEdit = (req, res) => {
  const { id } = req.params; // URL :id parameterë¥¼ ì˜ë¯¸í•œë‹¤.
  const { title } = req.body; // formì•ˆì—ìˆëŠ” valueì˜ javascript representationì´ë‹¤.
  console.log(req.body); // ì–´ë–¤ ê²ƒì„ ë°›ì•˜ëŠ”ì§€ í™•ì¸í•˜ê³ ì‹¶ì€ë° undefinedì´ë¼ê³  ëœ¸.
  //ì™œ express applicationì€ formì„ ì–´ë–»ê²Œ ë‹¤ë£¨ëŠ”ì§€ ëª¨ë¥¸ë‹¤.
  console.log(title);
  // ì•„ë˜ì™€ê°™ì´ëŠ” ì•ˆëœë‹¤ê³ í–ˆëŠ”ë° ë˜ê¸´ëœë‹¤.
  // const video = videos[id - 1];
  // video.title = title;
  const video = videos[id - 1];
  return res.redirect(`/videos/${id}`);
};
```

- express applicationì´ formì„ ì–´ë–»ê²Œ ë‹¤ë£¸? -> [doc](https://expressjs.com/ko/4x/api.html#express.urlencoded) express.urlencodedë¼ëŠ” ê²Œ formì˜ valueì„ ì´í•´í•˜ê²Œ í•´ì¤€ë‹¤.
- HTML postì‚¬ìš©í• ë•Œ ìœ ì˜í• ì . inputì— name ì„¤ì •ì„ í•´ì£¼ì§€ ì•Šìœ¼ë©´ ë°ì´í„°ê°€ ì „ì†¡ë˜ì§€ ì•ŠëŠ”ë‹¤.
- redirectì´ urlë¡œ ì—°ê²°.
- ê³„ì† ê°•ì˜ë¥¼ ë“¤ìœ¼ë©´ì„œ ëŠë‚€ì ì€ ë¬¸ì„œë¥¼ ë³´ëŠ”ê²Œ ì¤‘ìš”í•˜ë‹¤ëŠ”ê²ƒì´ë‹¤. ë­”ê°€ í”„ë¡œì íŠ¸ë¥¼ í•˜ê¸°ì „ì— ë¬¸ì„œë¥¼ ëŒ€ëµ ì½ì–´ë³´ëŠ”ê²Œ ì¢‹ì„ê±°ê°™ê³ , í‰ì†Œì—ë„ ë³´ëŠ”ê²Œ ì¢‹ì„ë“¯í•˜ë‹¤.
  > req.bodyëŠ” get request ê°’ì€ ë°›ì•„ì˜¬ ìˆ˜ ì—†ë‚˜ìš”?
  > post request ë¡œ ì „ì†¡ëœ ê°’ë§Œ ê°ì²´ë¡œ ë°›ì•„ì˜¬ ìˆ˜ ìˆëŠ”ê±´ê°€ìš”?
  >
  > > req.body is only with POST :) <br>
  > > Not really, is just that only in POST we can send data. Not on GET

### DATABASE mongoDB,mongoose

- mongoDB: ì¼ë°˜ì ìœ¼ë¡œëŠ” sqlë² ì´ìŠ¤ì¸ë° doucment-basedì´ë‹¤. í”„ë¡œê·¸ë˜ë¨¸ì²˜ëŸ¼ objectë¡œ ìƒê°í•œë‹¤. JSON-like-document -> packag.jsonì²˜ëŸ¼ ì €ì¥
- ì„¤ì¹˜ë°©ë²• mongoDB -> docs -> server -> installation -> [community edition](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/)
- ì˜ ì„¤ì¹˜ë¬ëŠ”ì§€ í™•ì¸ì¥ë²• mongodì…ë ¥. mongoë¥¼ ì¹˜ë©´ mongoì‰˜ì— ì…ì¥ê°€ëŠ¥.(nodeë„ ì¹˜ë©´ ë˜‘ê°™ì´ ë“¤ì–´ê°.)
- [mongoose](https://mongoosejs.com/): node.js ì™€ mongoDBë¥¼ ì´ì–´ì£¼ëŠ” ë‹¤ë¦¬(ìƒí˜¸ì‘ìš©í•´ì£¼ê¸°ìœ„í•´ ì‚¬ìš©), ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì ìœ¼ë©´ mongooseê°€ mongoDBì—ê²Œ ì „í•´ì¤€ë‹¤.
- object(dataë“¤)ë¥¼ ìƒì„±í•˜ë©´ ìë™ìœ¼ë¡œ idë¥¼ ë¶€ì—¬í•´ì¤€ë‹¤.

```js
//db.js
import mongoose from "mongoose";
mongoose.connect("mongodb://127.0.0.1:27017/wetube", {
  useNewUrlParser: true,
  useUnifiedTopology: true,
}); // ì•ì—ìˆëŠ”ê²ƒì€ ë‚´ ë¡œì»¬í˜¸ìŠ¤íŠ¸ì´ë‹¤. mongoë¥¼ì¹ ë•Œ ë³´ë©´ ì–»ì„ìˆ˜ìˆë‹¤. ë’¤ì— wetubeëŠ” ì´ì œë¶€í„° ì—¬ê¸°ì— ì—°ê²°í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤(ì•„ì§ ìƒì„±ì€ ì•ˆë˜ì—ˆë‹¤.). ë’¤ì—ìˆëŠ”ê²ƒì€ ì˜µì…˜ì¸ë° ê²½ê³ ë¥¼ í•´ì¤˜ì„œ ì˜µì…˜ì„ ì¶”ê°€í•´ì£¼ì—ˆë‹¤.

const db = mongoose.connection;
const handleOpen = () => console.log("âœ… Conected to DB");
const handleError = (error) => console.log("DB Error", error);
db.on("error", handleError); //ì—¬ëŸ¬ë²ˆ ë°œë™ê°€ëŠ¥
db.once("open", handleOpen); //í•œë²ˆë§Œ ë°œë™
//server.js
import "./db"; //dbíŒŒì¼ì„ ì„í¬ìŠ¤í•´ì¤Œìœ¼ë¡œì¨ ë‚´ ì„œë²„ê°€ mongoì— ì—°ê²°ì´ ëœë‹¤. ë°ì´í„°ë² ì´ìŠ¤ë¥¼ importí•´ì¤€ê²Œì•„ë‹ˆë¼ dbì„¤ì •íŒŒì¼?ì„ importí•´ì¤€ê²ƒì´ë‹¤. importí•´ì¤€ìˆœê°„ ìë™ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.
```

- CRUD, create, read , upload ,delete

### modelsí´ë” Video.js -> Video Model

- databaseê°€ ì•Œì•„ì•¼ í• ê²ƒì€ ë°ì´í„°ê°€ ì–´ë–»ê²Œ ìƒê²¼ëŠ”ê°€ì— ëŒ€í•œê²ƒ. êµ¬ì²´ì ì¸ ê°’ì´ ì•„ë‹ˆë¼
- ê·¸ë˜ì„œ ìš°ë¦¬ê°€ ì„¤ëª…ì„ í•´ì£¼ì–´ì•¼ëŒ. videoë¼ëŠ” ê°ì²´ì— ì–´ë–¤ ë°ì´í„°ë“¤ì´ í•„ìš”í•œì§€.
- ì´ëŸ¬í•œ ìƒê¹€ìƒˆë¥¼ schemaë¼ê³  ì—¬ê¸°ì„œ ë¶€ë¥¸ë‹¤. ìŠ¤í‚¤ë§ˆë¼ëŠ”ê²ƒì€ ë¶•ì–´ë¹µí‹€? ì •ë„ë¼ë„ ìƒê°í•˜ë©´ë ë“¯

```js
//Video.js
import mongoose from "mongoose";

const videoSchema = new mongoose.Schema({
  title: String,
  description: String,
  createdAt: Date,
  hashtags: [{ type: String }],
  meta: {
    views: Number,
    rating: Number,
  },
});

const Video = mongoose.model("Video", videoSchema);

export default Video;

//server.js
import "./db"; //ì´ dbì— ì—°ê±¸í• ê²Œìš”
import "./models/Video"; // ë¶•ì–´ë¹µí‹€
```

- import exportë¥¼ ë³´ë©´ì„œ ë‹¤ìŒì— ë‚´ê°€ ë‹¤ë¥¸ ì–¸ì–´ë¥¼ ë³´ë©´ ì´ë ‡ê²Œí• ìˆ˜ìˆì„ê¹Œ ë¼ëŠ” ìƒê°ì´ë“¤ì—ˆë‹¤ -> ê³„ì†ê³ ë¯¼í•´ë´£ëŠ”ë° ë„ˆë¬´ ì–´ë µê²Œ ìƒê°í•œë“¯í•˜ë‹¤. ëª¨ë‘ê·¸ëƒ¥ í•œ íŒŒì¼ì— ì ì„ìˆ˜ ìˆëŠ”ë°, ê·¸ëŸ¬ë©´ ë„ˆë¬´ ì–´ì§€ëŸ¬ìš°ë‹ˆê¹Œ ë”°ë¡œë”°ë¡œ ìª¼ê°œì„œ í•˜ëŠ”ê±°ê³  ê·¸ê²ƒì„ ë‹¨ì§€ ì—°ê²°ë§Œ ì‹œì¼œì¤¬ì„ë¿ì´ë¼ê³  ìƒê°í•˜ê¸°ë¡œ í–ˆë‹¤.
- moogooseì˜ ë§í¬ë“¤ [Link1](https://poiemaweb.com/mongoose) [Link2](https://dhddl.tistory.com/173)
- validation: numberë¶€ë¶„ì— stringì„ ë„£ìœ¼ë©´ ê·¸ë¶€ë¶„ì´ í¬í•¨ë˜ì§€ì•Šì€ì±„ ë§Œë“¤ì–´ì§„ë‹¤ëŠ”ê²ƒì„ ì•Œìˆ˜ìˆë‹¤.(ì˜¬ë°”ë¥´ì§€ì•Šì€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³ ì‹¶ì§€ì•Šìœ¼ë‹ˆê¹Œ) ì–´ëŠì •ë„ ë³´í˜¸ëœê°€ëŠ”ê²ƒì„ ì•Œìˆ˜ ìˆë‹¤.

<br>
### init.js -> importê°€ ë„ˆë¬´ë§ì•„ ê¸°ëŠ¥ë³„ë¡œ ë¶„ë¦¬

```js
import "./db";
import "./models/Video";
```

- server.jsì—ëŠ” serverì™€ ê´€ë ¨ëœ expressë§Œ
- ìœ„ì™€ê°™ì€ í˜•ì‹ì˜ importë¥¼ ì—„ì²­ë§ì´í•˜ê²Œë í…ë° ê·¸ëŸ¬ë©´ ì¢€ ë³µì¡í•´ì§€ë‹ˆ ë¶„ë¦¬í•˜ê² ë‹¤.

> server.js ì—ì„œ
> const PORT = 4000;
> const handleListening = () =>
> console.log(`âœ… Server listenting on http://localhost:${PORT} ğŸš€`);
> app.listen(PORT, handleListening);
> ë¶€ë¶„ì„ init.js ë¡œ ì˜®ê²¼ëŠ”ë°, ì´ ë¶€ë¶„ë„ server ì— ê´€ë ¨ëœ ì½”ë“œê°€ ì•„ë‹Œê°€ìš”?
> or
> app.listen(PORT, handleListening); ëŠ” just ì„œë²„ê°€ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ í™•ì¸ë§Œ í•˜ê³  handleListening í•¨ìˆ˜ë¥¼ callback í•´ì£¼ëŠ” ê±´ê°€ìš”?
> (ê·¸ë ‡ë‹¤ë©´ ì„œë²„ë¥¼ ì—´ì–´ì£¼ëŠ” ê²ƒì€ const app = express(); ë¶€ë¶„ì¸ê°€ìš”?)
>
> > ë‹µ .listen() is the code that opens the port to listen for connections.

<br>

### (dbì—ì„œ ë‚˜ì˜´) callbackê³¼ promise

- databaseê°€ ì¢…ë£Œë˜ê±°ë‚˜, ë°”ì˜ê±°ë‚˜ ë“±ë“±, databaseê°€ jsê°€ ì¡´ì¬í•˜ê¸°ë•Œë¬¸
- <br>
  [ë¹„ë™ê¸°ì²˜ë¦¬ë€?](https://joshua1988.github.io/web-development/javascript/javascript-asynchronous-operation/)
  íŠ¹ì • ì½”ë“œì˜ ì—°ì‚°ì´ ëë‚  ë•Œê¹Œì§€ ì½”ë“œì˜ ì‹¤í–‰ì„ ë©ˆì¶”ì§€ ì•Šê³  ë‹¤ìŒ ì½”ë“œë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ íŠ¹ì„±ì„ ì˜ë¯¸. ê·¸ë˜ì„œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ìœ„í•´ì„œ callbackí•¨ìˆ˜ë¥¼ ì‚¬ìš©-> ì˜¤ë˜ëœ ë°©ë²•ì„.
- [promise](https://joshua1988.github.io/web-development/javascript/promise-for-beginners/) : ë¹„ë™ê¸° ì²˜ë¦¬ì— ì‚¬ìš©ë˜ëŠ” ê°ì²´ ì¦‰, ë¹„ë™ê¸° ì²˜ë¦¬ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ê°ì²´ì´ë‹¤. í•´ê²°í•˜ê¸°ìœ„í•´ì„œ!
- [async & await](https://joshua1988.github.io/web-development/javascript/js-async-await/)
  callbackì˜ ìµœì‹ ë²„ì „, ê³„ì† ê¸°ë‹¬ë ¤ì¤€ë‹¤. ì§ê´€ì ì´ê¸°ë•Œë¬¸ì— javascriptê°€ ì–´ë””ì„œ ê¸°ë‹¤ë¦¬ëŠ”ì§€ ë°”ë¡œì•Œìˆ˜ìˆìŒ.(ìˆœì„œëŒ€ë¡œ ìœ„ì—ì„œë¶€í„° ì•„ë˜ë¡œì‹¤í–‰ëŒ.)
- [try catchë¬¸](https://skmagic.tistory.com/157) : errorë¥¼ ë‹¤ë£¨ê¸°ìœ„í•´ ì‚¬ìš©, tryë¶€ë¶„ì„ ì‹¤í–‰í•˜ë‹¤ê°€ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ errorê°ì²´ì— errorê°€ ì €ì¥ëŒ. catchë¶€ë¶„ì´ ì‹¤í–‰ëŒ. ê·¸ëƒ¥ ì–¸ì–´ì°¨ì›ì—ì„œ ì œê³µí•˜ëŠ”ê²ƒ. ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì•„ë‹ˆë¼
  <br>

### ì™œ callbackí•¨ìˆ˜ì— error argumentê°€ ê»´ìˆëŠëƒ?

- [Stackoverflow](https://stackoverflow.com/questions/31375728/node-js-callback-function-error-parameter-explanation)
- [Link](http://thenodeway.io/posts/understanding-error-first-callbacks/) : ì½œë°±ì˜ ì²«ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ì— ì—ëŸ¬ ê°ì²´ë¥¼ ì‚¬ìš©.ì¼ì¢…ì˜ ì½”ë”©ì•½ì† [Link](https://www.hanumoka.net/2018/11/02/javascript-20181102-javascript-error-first-callback-pattern/)

<br>

### hashtags -> split()

- "#hello,#hi,#lalala".split(",") -> arrayë¡œ ë¦¬í„´í•´ì¤€ë‹¤.
- ë¬¸ìì—´ì„ ë°°ì—´ë¡œ ë³€í™˜ [splití•¨ìˆ˜](https://hianna.tistory.com/377)
- "food,movies,music".split(",").map(word => `#${wrod}`) ì´ëŸ°ì‹ìœ¼ë¡œë„ ê°€ëŠ¥
- ëª¨ë“  ë°°ì—´ì˜ ê°’ì— functionì„ ì‹¤í–‰í•˜ëŠ” [mapí•¨ìˆ˜](https://velog.io/@daybreak/Javascript-map%ED%95%A8%EC%88%98)

### ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥

- ë‘ê°€ì§€ë°©ë²•ì´ ìˆìŒ

```js
export const postUpload =  async (req, res) => {const { title, description, hashtags } = req.body;
// objectë¥¼ ë§Œë“¤ì–´ ì¤€í›„ ì €ì¥
  const video = new Video({
  ...
  });
  await video.save(); // ë°ì´í„°ë² ì´ìŠ¤ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°–ì—ìˆì–´ì„œ ì´ëŸ°ì‹ìœ¼ë¡œ ì²˜ë¦¬í•´ì£¼ì–´ì•¼í•œë‹¤.
  return res.redirect("/");
};
// createë¥¼ ì¨ì„œ ê·¸ ê³¼ì •ì„ ìƒëµí•˜ê²Œ í•´ì¤Œ
await Video.create({
    title,
    description,
    createdAt: Date.now(),
    hashtags: hashtags.split(",").map((word) => `#${word}`),
    meta: {
      views: 0,
      rating: 0,
    },
  });

```

- [save(),create()](https://mongoosejs.com/docs/documents.html) documnet.save() ,model.create()
- modelê³¼ documentì˜ ì°¨ì´, ë‚´ê°€ ìƒê°í•˜ê¸°ë¡  modelì€ ë¹µí‹€ì´ê³ , documnetëŠ” ë¹µì´ë‹¤.
- ê·¸ëŸ°ë‹¤ìŒ moogo shell ì—ê°€ì„œ show dbsë¥¼ í•˜ë©´ wetubeë¼ëŠ” ì¹´í…Œë¡œê¸°ì— ìƒê¸´ê²ƒì„ ì•Œìˆ˜ìˆë‹¤.(ì €ì¥ë˜ì—ˆë‹¤ëŠ” ì˜ë¯¸ì„).
- show dbs -> use wetube -> show collections(docì˜ ë¬¶ìŒ) -> db.videos.find() --->helpì¹˜ë©´ ëª…ë ¹ì–´ë“¤ ë‚˜ì˜´
- ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”ë°©ë²•-> ì•„ì˜ˆ ì‚­ì œì‹œí‚¤ëŠ”ë²•
  > How to reset DB
  > on cmd(console), enter mongo ,use dbName; , db.dropDatabase();

### Video.js

```js
//Video.js
const videoSchema = new mongoose.Schema({
  title: { type: String, required: true },
  description: { type: String, required: true },
  createdAt: { type: Date, required: true, default: Date.now },
  hashtags: [{ type: String }],
  meta: {
    views: { type: Number, default: 0, required: true },
    rating: { type: Number, default: 0, required: true },
  },
});
```

- [ìŠ¤í‚¤ë§ˆì˜µì…˜ë“¤](https://mongoosejs.com/docs/schematypes.html) + maxlengthë¥¼ ì„¤ì •í• ë•Œ upload.pugíŒŒì¼(ì‚¬ìš©ìë¥¼ ìœ„í•œ)ê³¼ Video.jsíŒŒì¼ ë‘˜ë‹¤ ì„¤ì •ì„ í•´ì£¼ì–´ì•¼í•œë‹¤. pugíŒŒì¼ì€ì™œ í•˜ëƒë©´ ê·¸ëƒ¥ htmlíƒœê·¸ë¥¼ ì‚­ì œ ì‹œì¼œì„œ ì œí•œì„ í’€ì–´ë²„ë¦´ìˆ˜ìˆê¸°ë•Œë¬¸ì´ë‹¤.
- required : ê¼­ í•„ìš”í•˜ë‹¤. date.nowì—ì„œ ê´„í˜¸ê°€ ì—†ëŠ”ê²½ìš°, ()ê°€ ìˆìœ¼ë©´ ë°”ë¡œì‹¤í–‰ë˜ê¸°ë•Œë¬¸ì— ë¶ˆë €ì„ ë•Œ ì‹¤í–‰ì‹œí‚¤ê²Œ í•˜ê¸°ìœ„í•´ì„œ.
- defaultê°’ì„ ì§€ì •í•˜ë©´ ë”°ë¡œ docë¥¼ ë§Œë“¤ë•Œ ë‚´ê°€ ê°’ì„ ë„£ì§€ ì•Šì•„ë„ ìë™ìœ¼ë¡œ ë””í´íŠ¸ê°’ìœ¼ë¡œ ì§€ì •í•´ì¤€ë‹¤. ì´ëŸ°ì‹ìœ¼ë¡œ defaultê°’ì„ ì§€ì •í•˜ë©´, ì½”ë“œë¥¼ ì¢€ë” ì¤„ì—¬ë‚˜ê°ˆìˆ˜ìˆë‹¤.

### exec()

```js
export const watch = async (req, res) => {
  const { id } = req.params;
  const video = await Video.findById(id).exec();
  return res.render("watch", { pageTitle: `Watching`, video });
};
```

- exec() : promiseë¥¼ ë¦¬í„´í•´ì£¼ëŠ”ê²ƒì¸ë° async % await ë¥¼ ì“°ê³ ìˆì–´ì„œ ì‹ ê²½ì•ˆì¨ë„ëœë‹¤.

### ë‚´ê°€ ì°¾ëŠ” videoê°€ ì—†ì„ ê²½ìš°

```js
// videoController.js
export const watch = async (req, res) => {
  const { id } = req.params;
  const video = await Video.findById(id);
  if (!video) {
    // ë¨¼ì € ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•´ì¤€ë‹¤. 404.pugë¥¼ ë§Œë“¤ì–´ ì²˜ë¦¬í•´ì¤Œ. dbì—ì„œ ì˜¤ë¥˜ê°€ ë‚˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ê·¸ëƒ¥ ì—†ì–´ì„œ ê·¸ëŸ°ê±°ê¸°ë•Œë¬¸ì— try catchë¬¸ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì•„ë‹Œë“¯.
    return res.renser("404", { pagetitle: "Video no found." });
  }
  return res.render("watch", { pageTitle: video.title, video });
};
```

### .join() startWith()

```js
// edit.pug
// ìˆ˜ì •ì„ í• ê±´ë° ìˆ˜ì •í• ì¹¸ì— valueë¥¼ ì§€ì •í•´ì£¼ê³  ì‹¶ë‹¤.(ì›ë˜ ì›ë³¸ê°’ì„ ë„£ì–´ë†“ê³ ì‹¶ë‹¤.)
// ê·¸ëŸ°ë° video.jastagsì¶œë ¥í•´ë³´ë©´ ë°°ì—´ì´ê¸°ë•Œë¬¸ì— ë°°ì—´í˜•íƒœë¡œ ë‚˜ì˜¤ëŠ”ë° ê·¸ë°°ì—´ì„ í˜•íƒœë¥¼ ë°”ê¿”ì£¼ê¸° ìœ„í•´ join()ì‚¬ìš©í•œë‹¤.
input(
  (placeholder = "Hashtags, separated by comma."),
  required,
  (type = "text"),
  (name = "hashtags"),
  (value = video.hashtags.join())
);

/// videoController.js
video.hashtags = hashtags
  .split(",")
  .map((word) => (word.startsWith("#") ? word : `#${word}`));
await video.save();
```

- [join()](https://www.codingfactory.net/10450) : ë°°ì—´ì˜ ì›ì†Œë¥¼ ì—°ê²°í•˜ì—¬ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ë§Œë“¤ê¸°
- [startWith("#")](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith) : ì–´ë–¤ ë¬¸ìì—´ì´ íŠ¹ì • ë¬¸ìë¡œ ì‹œì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ì—¬ ê²°ê³¼ë¥¼ true í˜¹ì€ falseë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

### moonse, Video.exists(), Video.findByIdAndUpdate()

```js
// exists() ê°ì²´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ì•Šê³ , ê·¸ ë°ì´í„°ê°€ ì¡´ì¬í•˜ëŠ”ì§€ë§Œ í™•ì¸í•˜ì—¬ true falseë¥¼ ë¦¬í„´.
const video = await Video.findById(id);
const video = await Video.exists({ _id: id });
// findByIdAndUpdate() ì°¾ì€ê³¼ ë™ì‹œì— ì—…ë°ì´íŠ¸ë¥¼ í•´ì¤€ë‹¤.
await Video.findByIdAndUpdate(id, {
  title,
  description,
  hashtags: hashtags
    .split(",")
    .map((word) => (word.startsWith("#") ? word : `#${word}`)),
});
```

- ê³µì‹ë¬¸ì„œì—ì„œ ë©”ì„œë“œë“¤ì˜ ê¸°ëŠ¥ë“¤ì„ ë³´ë©´ì„œ ì–´ë–»ê²Œí•´ì•¼ ë‚´ ì½”ë“œì— ì˜ ì“¸ìˆ˜ìˆëŠ”ì§€ ì˜ ì‚´í´ë³´ëŠ”ê²Œ ì¤‘ìš”í•œë“¯.
- videoì™€ VideoëŠ” ì°¨ì´ê°€ìˆë‹¤. videoì€ ë°ì´í„°ë¥¼ ë‹´ì€ ê°ì²´ì´ê³ , VideoëŠ” ëª¨ë¸ì´ë‹¤.

### monose Middleware

- express Middlewareì²˜ëŸ¼ ì¤‘ê°„ì— ê·¸ëƒ¥ ì–´ë–¤ê²ƒì„ í•˜ê¸°ìœ„í•´ ë„£ëŠ”ê²ƒì´ë‹¤.
- ìœ„ì˜ hashtagsë¥¼ ë³´ë©´ stringìœ¼ë¡œ ë„˜ì–´ì˜¨ê²ƒì„ arrayë¡œ ë°”ê¿”ì£¼ê¸°ìœ„í•´ ì €ë ‡ê²Œ í•˜ê³ ìˆëŠ”ë° ì €ê²ƒì„ ì—†ì• ê¸° ìœ„í•´ì„œ Middlewareë¥¼ ì‚¬ìš©í•œë‹¤.

```js
//Video.js
videoSchema.pre("save", async function () {
  this.hashtags = this.hashtags[0]
    .split(",")
    .map((word) => (word.startsWith("#") ? word : `#${word}`));
});
```

- [ê³µì‹ë¬¸ì„œ](https://mongoosejs.com/docs/middleware.html)

### ëŠë‚€ì 

- ë¬¸ì„œë“¤ì„ ì²˜ìŒë³´ë©´ ì˜ˆì œë“¤ì´ ì‡ëŠ”ë° ì´ê²Œ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ ê²€ìƒ‰í•´ë³´ë©´ì„œ ì •ë¦¬í•˜ë©´ í° ë„ì›€ì´ ë ë“¯. ë¬¸ì„œë¿ë§Œ ì•„ë‹ˆë¼ ë‚¨ì˜ ì½”ë“œë“¤ë„.
- ë­”ê°€ ì½”ë”©ì€ ë°˜ë³µë˜ëŠ” ë¶€ë¶„ì„ ì¤„ì´ê³ ,ì´ê±°ëŠ” ìˆì„ë²•í•œ ê±´ë°í•˜ë©´ ìˆê³ , ë³µì¡í•´ë³´ì´ë©´ ë‚˜ëˆ„ê³  ì´ê²Œ ì¤‘ìš”í•œë“¯ í•˜ë‹¤.

### í”„ë¡œê·¸ë˜ë¨¸ë“¤ì—ê²Œ ë°”ì´ë¸”ì¸ì±… clean code ì—ì„œ ë‹ˆê¼¬ê°€ ë°°ìš´ê²ƒ

- ì¼ë‹¨ì€ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ë”ëŸ¬ì›Œë„ ìƒê´€ì—†ìŒ.
- ì½”ë“œë¥¼ ì‘ì„±í•œ ì‹œê°„ë§Œí¼ ì½”ë“œë¥¼ ì •ë¦¬ë¥¼ í•˜ëŠ”ë°ì— ì‹œê°„ì„ ì“°ëŠ”ê±°ì„

### ì‚¬ìš©í•œê²ƒë“¤

- Server: nodejs, express, npm <-> npxë€? + babel ,morgan
- Template: pug
- DB: mongoDB, monsgoose
- xcodeë€?

### ì–´ë– í•œê²ƒì„ ë§Œë“¤ë–„ ì–´ë–¤ ìŠ¤íƒ,ê¸°ìˆ ì„ ì‚¬ìš©í• ê²ƒì¸ì§€ì—ëŒ€í•´ ì•Œì•„ì•¼í• ë“¯. ê·¸ëŸ´ë ¤ë©´ ì–´ë–¤ ìŠ¤íƒ,ê¸°ìˆ ë“±ì´ í•„ìš”í•œì§€ ì •ë¦¬í•´ë´ì•¼í• ë“¯.í´ë¡ ì½”ë”©í• ë•Œë„ ì–´ë–¤ ìŠ¤íƒ,ê¸°ìˆ ì´ ì‚¬ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ”ê²Œ ì¢‹ì„ë“¯. í”„ë ˆì„ì›Œí¬ ê³µë¶€ë°©ë²•ë„ ì•Œì•„ë³´ë©´ì¢‹ì„ë“¯.
