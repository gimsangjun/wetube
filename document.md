### NodeJs , npm , package.json

- NodeJsëŠ” ë¸Œë¼ìš°ì € ë°–ì—ì„œ ëŒì•„ê°€ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì´ë‹¤. nodeJSëŠ” ë¸Œë¼ìš°ì €ê°€ ì•„ë‹Œê³³ì—ì„œ JSë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ì—”ì§„ì´ë‹¤.
- ê·¸ë˜ì„œ node index.js ë¥¼ ì¹˜ë©´ jsíŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¬ìˆ˜ ìˆë‹¤.
- [NodeJSëŠ” ë²¡ì—”ë“œì¸ê°€ìš” í”„ë¡ íŠ¸ì—”ë“œì¸ê°€ìš”](https://okky.kr/article/546877)
  > NodeJSëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¸Œë¼ìš°ì € ì™¸ì˜ í™˜ê²½ì—ì„œ êµ¬ë™í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì—”ì§„ì…ë‹ˆë‹¤.
  > NodeJS í™˜ê²½ì— express ë“±ì˜ í”„ë ˆì„ì›Œí¬ë¥¼ êµ¬ë™í•˜ë©´ ì„œë²„ê°€ ë  ìˆ˜ ìˆê³ 
  > NodeJS í™˜ê²½ìœ¼ë¡œ Reactë¥¼ ì œì‘í•˜ë©´ í”„ë¡ íŠ¸ì—”ë“œê°€ ë©ë‹ˆë‹¤
- [react](https://velog.io/@jini_eun/React-React.js%EB%9E%80-%EA%B0%84%EB%8B%A8-%EC%A0%95%EB%A6%AC)ë€? í”„ë¡ íŠ¸ì—”ë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬
- [express](https://velog.io/@madpotato1713/JAVASCRIPT-express%EB%9E%80)ë€? nodejsë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ë¥¼ ê°œë°œí•˜ê³ ì í•˜ëŠ” ê°œë°œìë“¤ì„ ìœ„í•˜ì—¬ ì„œë²„ë¥¼ ì‰½ê²Œ êµ¬ì„±í• ìˆ˜ ìˆê²Œ ë§Œë“  í”„ë ˆì„ì›Œí¬ì´ë‹¤.

- npm: ì—¬ëŸ¬ì‚¬ëŒë“¤ì´ íŒ¨í‚¤ì§€ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ”ë° ìš°ë¦¬ëŠ” íŒ¨í‚¤ì§€ë¥¼ ê°€ì ¸ë‹¤ê°€ ì“¸ìˆ˜ìˆë‹¤. ê°œë°œì„ ì‰½ê²Œ ë§Œë“¤ì–´ì£¼ë‹ˆê¹Œ, ê·¸ë˜ì„œ npmì„ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ ëˆ„êµ°ê°€ê°€ ë§Œë“¤ì–´ ë†“ì€ íŒ¨í‚¤ì§€ë¥¼ ì‰½ê²Œ ì“¸ìˆ˜ ìˆë‹¤.
- json: í”„ë¡œê·¸ë˜ë¨¸ê°€ íŒŒì¼ì— ì •ë³´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ ë§Œë“  ë°©ì‹ ì¤‘ í•˜ë‚˜. ê·¸ëƒ¥ í…ìŠ¤íŠ¸ íŒŒì¼ì¼ë¿ì´ë‹¤.
- "scripts" ë€? ë‚´ê°€ ì‹¤í–‰í•˜ê³ ì‹¶ì€ê²ƒì„ ë§í•¨. ê·¸ë˜ì„œ node index.jsë¥¼ í•˜ëŠ”ê²ƒì„ npmì´ í•˜ë„ë¡ ë§Œë“¤ ìˆ˜ìˆìŒ(npm run ~~). ë‚˜ì¤‘ì—ëŠ” ì„œë²„ë¥¼ ì‹œì‘í•˜ëŠ” script, cssë¥¼ ì••ì¶•í•˜ëŠ” script, ì›¹ì‚¬ì´í‹€ ë¹Œë“œí•˜ê³  ì„œë²„ì— ë°°í¬í•˜ëŠ” scriptë“±ë“±. ìš”ì ì€ ë‚´ê°€ ë§Œë“  scriptë¥¼ í„°ë¯¸ë„ì—ì„œ ì“¸ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.
- ì²˜ìŒ ì‹œì‘í• ë•Œ npm init

### npmjs package express, package.json

- [npm](https://www.npmjs.com/) i express
- express í´ë”ì˜ pakcage.jsoníŒŒì¼ì„ ë³´ë©´ <u>dependenciesê°€</u> ìˆëŠ”ë° expressê°€ ì‘ë™ë˜ë ¤ë©´ í•„ìš”í•œ íŒ¨í‚¤ì§€ë“¤ì„ ë§í•œë‹¤. ê·¸ë˜ì„œ expressë‹¤ìš´ë¡œë“œë°›ì„ë•Œ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ ëœë‹¤.
- ì²´ì¸ì²˜ëŸ¼ íŒ¨í‚¤ì§€ë“¤ì´ ì„œë¡œë¥¼ í•„ìš”ë¡œ í•œë‹¤. ê·¸ë˜ì„œ ìë™ìœ¼ë¡œ ì—°ê²°ëœë‹¤.
- npmì´ ë˜‘ë˜‘í•´ì„œ dependenciesì— ìˆëŠ” ëª¨ë“ˆë“¤ì„ ìë™ìœ¼ë¡œ ì„¤ì¹˜í•´ì¤€ë‹¤. npm ië§Œ í•´ë„
- ì´ë˜ì„œ package.jsonì´ë¼ëŠ” íŒŒì¼ì´ ì¤‘ìš”í•˜ë‹¤. í”„ë¡œì íŠ¸ë¥¼ ë™ì‘ì‹œí‚¬ë•Œ í•„ìš”í•œ ëª¨ë“ˆë“¤ì´ ì–´ë–¤ê±´ì§€ ì •ë³´ë¥¼ ë‹´ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.
- node_modulesë¥¼ ê¹ƒí—ˆë¸Œì— ì˜¬ë¦´í•„ìš”ê°€ ì—†ë‹¤. ì´ë˜ì„œ ì¤‘ìš”í•œë“¯. ê·¸ë˜ì„œ ì¹œêµ¬ê°€ í”„ë¡œì íŠ¸ë¥¼ ì—´ì–´ì„œ npm ië§Œ í•´ì£¼ë©´ ë˜ëŠ”ê²ƒì´ë‹¤.
- devDependenciesì— ì¶”ê°€ë˜ëŠ” ëª¨ë“ˆë“¤ë„ ìˆëŠ”ë° ì´ê²ƒì€ ê°œë°œìì—ê²Œ í•„ìš”í•œ dependenciesë¥¼ ë§í•˜ëŠ” ê²ƒì´ë‹¤. --save-dev ì˜µì…˜ì„ ì£¼ë©´ dev~ì— ì¶”ê°€ëœë‹¤.

### package-lock.json

- ë‚˜ì˜ íŒ¨í‚¤ì§€ë“¤ì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•´ì¤€ë‹¤. ê·¸ë˜ì„œ ë‹¤ë¥¸ì‚¬ëŒë“¤ë„ npm i ë§Œ í•˜ë©´ ì •í™•íˆ ë‚˜ë‘ ë˜‘ê°™ì€ ë²„ì „ì„ ë‹¤ìš´ë¡œë“œ ë°›ê²Œ ëœë‹¤.(ë‚˜ì˜ package.jsoníŒŒì¼ì„ ê°€ì§€ê³ ìˆëŠ” ìƒíƒœì—¬ì•¼í•œë‹¤.) npmì´ ë˜‘ë˜‘í•´ì„œ ë‹¤ ê´€ë¦¬ í•´ì¤€ë‹¤.

### Babel

- nodeJSê°€ ì´í•´í•˜ì§€ ëª»í•˜ëŠ” ìµœì‹ ì½”ë“œë¥¼ [babel](https://babeljs.io/setup#installation)nodeê°€ ì»´íŒŒì¼í•´ì¤„ê²ƒì´ë‹¤. ê²€ìƒ‰í‚¤ì›Œë“œ babel install ë§¨ìœ„ ê²Œì‹œë¬¼.
- touch babel.config.json , touchë¼ëŠ” ëª…ë ¹ì–´ëŠ” íŒŒì¼ì„ ë§Œë“¤ì–´ ì£¼ëŠ” ëª…ë ¹ì–´ì´ë‹¤.
- "presets": ["@babel/preset-env"] ì€ ìµœì‹  ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì“¸ìˆ˜ ìˆëŠ” í”ŒëŸ¬ê·¸ì¸ì´ë‹¤.
- ìµœì¢…ì ìœ¼ë¡œ babel-nodeë¥¼ ì„¤ì¹˜í•˜ë©´ babelë¡œ jsíŒŒì¼ì„ ìµœì‹ ë¬¸ë²•ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¬ìˆ˜ ìˆë‹¤.
  babel-node index.js
- [nodemon](https://shlee0882.tistory.com/231)ì€ ìš°ë¦¬ê°€ ë§Œë“  íŒŒì¼ì´ ìˆ˜ì •ë˜ëŠ”ê±¸ ê°ì‹œí•´ì£¼ë©°,ì•Œì•„ì„œ ì¬ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ê¸°ëŠ¥ì„ ê°–ê³ ìˆë‹¤. ê·¸ë˜ì„œ npm run devë¼ëŠ”ê²ƒì„ ê³„ì† í•´ì¤„ í•„ìš”ëŠ” ì—†ìŒ. [ì •ì‹ë§í¬](https://www.npmjs.com/package/nodemon)

### server,callback

- ì„œë²„ëŠ” í•­ìƒ ì¼œì ¸ ìˆê³ , ì¸í„°ë„·ì— ì—°ê²°ë¼ìˆëŠ” ì»´í“¨í„°ë¼ê³  í• ìˆ˜ ìˆë‹¤.
- requestë¥¼ ë³´ë‚´ë©´ í•­ìƒ ë‹µí•´ì¤€ë‹¤.
- ì„œë²„ëŠ” listeningì¤‘ì´ê³  ë„ˆë¥¼ ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤.-> ì„œë²„ê°€ ì‚¬ëŒë“¤ì´ ë­”ê°€ë¥¼ ìš”ì²­í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê²Œ í•´ì•¼í•œë‹¤.

```js
app.listen(PORT, handleListening); //ì„œë²„ê°€ ë§Œë“¤ì–´ì¡Œê³ , ì„œë²„ì—ê²Œ ì–´ë–¤ portë¥¼ listeningí• ì§€ ì–˜ê¸°í•´ì¤˜ì•¼í•œë‹¤.
```

- ì„œë²„ê°€ ë‚´ ì»´í“¨í„° ì „ì²´ë¥¼ listení• ìˆ˜ëŠ” ì—†ë‹¤. ì´ë¯¸ ë§ì€ í”„ë¡œê·¸ë¨ë“¤ì´ portë“¤ì„ í†µí•´ì„œ ì†Œí†µí•˜ê³ ìˆë‹¤. 4000ë²ˆì„ ì“°ëŠ”ê²Œ ë°±ì•¤ë“œì—ì„œëŠ” ê´€ë¡€ì´ë‹¤. ë‚˜ì¤‘ì—ëŠ” ì´ portê°€ ì´ë¯¸ì“°ê³ ìˆë‹¤ê³  ì—ëŸ¬ê°€ ìƒê¸¸ìˆ˜ë„ ìˆë‹¤.
- ë’¤ì—ìˆëŠ” í•¨ìˆ˜ê°€ [callback](https://dalkomit.tistory.com/65)í•¨ìˆ˜ë¼ê³  í•˜ëŠ”ì§€ëŠ” ëª¨ë¥´ê² ëŠ”ë°(ì´ í•¨ìˆ˜ëŠ” listeningì´ ì‹œì‘ë˜ë©´ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì´ë‹¤.),
  ë¬´ì—‡ì¸ê°€ ì¼ì„ ë‹¤ë¥¸ ê°ì²´ì—ê²Œ ì‹œí‚¤ê³ , ê·¸ì¼ì´ ëë‚˜ëŠ”ê²ƒì„ ê¸°ë‹¤ë¦¬ëŠ”ê²Œ ì•„ë‹ˆë¼, ë‚˜ë¥¼ ë‹¤ì‹œ ë¶€ë¥¼ë•Œê¹Œì§€ ë‚´í• ì¼ í•˜ê³ ìˆëŠ”ê²ƒ..., ë¹„ë™ê¸° ë°©ì‹ì´ë¼ê³ í•œë‹¤. -> ë’¤ì—ë” ìì„¸í•˜ê²Œ ì„¤ëª…í•œê±°ìˆìŒ

### requestì— respondí•˜ëŠ”ë°©ë²•ì„ ì•Œì•„ë³¼ê²ƒì´ë‹¤.

- localhost:4000 ë¥¼ ì›¹í˜ì´ì¦ˆì—ì„œ ì‹¤í–‰í•´ë³´ë©´ "Cannot GET /"ì´ë¼ëŠ”ê²ƒì´ ëœ¬ë‹¤.
- / ì„œë²„ì˜ root, í˜¹ì€ ì²« í˜ì´ì§€ë¥¼ ì˜ë¯¸í•œë‹¤. google.com === google.com/
- GETì€ HTTP methodì´ë‹¤, HTTPë€? ìš°ë¦¬ê°€ ì„œë²„ì™€ ì†Œí†µí•˜ëŠ”ë°©ë²•, ì„œë²„ê°€ ì„œë¡œ ì†Œí†µí•˜ëŠ” ë°©ì‹ì´ë‹¤. ê·¸ë˜ì„œ ì£¼ì†Œì— ì ‘ì†í•˜ë©´ ë¸Œë¼ìš°ì €ê°€ ëŒ€ì‹ í•´ì„œ http requestë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.
  ì¦‰ ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í•˜ê³  ì„œë²„ì— ì •ë³´ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•ì´ë‹¤. get this page(í˜ì´ì§€ë¥¼ ê°–ë‹¤ì¤˜)ì™€ ê°™ì€ ì˜ë¯¸ì´ë‹¤. ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í•˜ë ¤í• ë•Œ, ë„ˆê°€ ì§ì ‘ ì ‘ì†í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼, ë„ˆë„¤ í™ˆí˜ì´ì§€ë¥¼ ê°€ì ¸ë‹¤ì¤˜ ë¼ëŠ” ì˜ë¯¸. ë¸Œë¼ìš°ì €ê°€ ê°€ì ¸ë‹¤ ì£¼ëŠ”ê²ƒì´ë‹¤.

```js
app.get("/", () => console.log("Somebody is trying to go home.")); //ëˆ„ê°€ rootí˜ì´ì§€ì— ìš”ì²­ì„ ë³´ë‚¸ë‹¤ë©´, ì´ callbackí•¨ìˆ˜ë¥¼ ì‹¤í–‰í• ê²ƒì´ë‹¤.
// ë¸Œë¼ìš°ì €ê°€ get requestsë¥¼ ë³´ë‚´ê³  ìˆëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì´ëŸ°ì‹ìœ¼ë¡œëŠ” responseë¥¼ í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ê³„ì† ë¡œë”©ì¤‘ì¼ê²ƒì´ë‹¤.

const handleHome = (req, res) => {
  console.log(req);
  return res.end(); // requestë¥¼ ë³´ë‚´ë©´ returnìœ¼ë¡œ responseë¥¼ í•´ì¤˜ì•¼ í•˜ê³ , ì´ ë©”ì„œë“œëŠ” responseë¥¼ ëë‚´ê² ë‹¤ëŠ” ê²ƒì´ë‹¤.
  return res.send("i still love you"); // ì´ë ‡ê²Œë„ í• ìˆ˜ ìˆë‹¤. ì´ëŸ¬ë©´ ë¸Œë¼ìš°ì €ê°€ ê¸€ì”¨ê°€ ë‚˜ì˜¨ë‹¤.
  // ì´ëŸ¬í•œê²ƒë“¤ì„ í•œì¤„ë¡œ ì“°ë©´ returnì„ ìƒëµí•´ë„ëœë‹¤.
};
// eventlistenerì— ë¸Œë¼ìš°ì €ê°€ ê³µì§œë¡œ eventë¼ëŠ” argumentì— ë„£ì–´ì£¼ëŠ”ê²ƒì²˜ëŸ¼, route handlerì—ëŠ” ë‘ê°œì˜ objectê°€ ìˆë‹¤.(request,response)
// ì¦‰ homeìœ¼ë¡œ get requestê°€ ì˜¤ë©´, expressëŠ” handleHomeì—ë‹¤ê°€ ë‘ê°œì˜ objectë¥¼ ë„£ì–´ì£¼ëŠ” ê²ƒì´ë‹¤.
// request objectë¥¼ ì‚´í´ë³´ë©´ ì¿ í‚¤ë‚˜ methodê°™ì€ ì •ë³´ë¥¼ ì–»ì„ìˆ˜ ìˆì—ˆë‹¤.
```

- [document](https://expressjs.com/ko/api.html#express) ë©”ì†Œë“œë“¤ì— ëŒ€í•œ ì„¤ëª…ì´ ìˆë‹¤. ì—¬ê¸°ì— ìˆëŠ”ê²Œ ì „ë¶€ì´ë‹¤.
- ì–´ë–¤ ì‚¬ì´íŠ¸ì— ì ‘ì†í• ë•Œë§ˆë‹¤ get request ìƒì„±í•˜ê³ , ì´ get requestì— ì‘ë‹µí•˜ëŠ” ì„œë²„ê°€ ìˆì–´ì•¼ í•œë‹¤.
- [Route](https://dog-paw.tistory.com/entry/7-MEAN-%EC%8A%A4%ED%83%9D-Express-Route-%EC%A0%95%EC%9D%98)routeëŠ” ê·¸ëƒ¥ urlì´ë¼ê³  ë³´ë©´ë ë“¯í•˜ë‹¤. ê²½ë¡œ! [Route](https://stylishc.tistory.com/120) - routerëŠ” handlerë¡œ URLì„ ì •ëˆí•˜ëŠ” ê²ƒì´ë‹¤.

### middleware ~=== controller , next()

```js
const gossipMiddleware = (req, res, next) => {
  console.log("I`m in the miiddle!");
  console.log(`Someone is going to ${req.url}`);
  next(); //express next()ë¥¼ ë³´ê³  ë‹¤ìŒí•¨ìˆ˜ì¸ handleHomeì„ í˜¸ì¶œí• ê²ƒì´ë‹¤.
  // ê·¸ë˜ì„œ ì´ëŸ°ì‹ìœ¼ë¡œ ë³´ë©´ handleHomeì€ final wareê°€ ë˜ëŠ”ê²ƒì´ë‹¤.
  // ëª¨ë“  controllerê°€ middlewareê°€ ë ìˆ˜ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œê³  ìˆìœ¼ì…ˆ.
  // middlewareëŠ” requestì— ì‘ë‹µí•˜ëŠ”ê²ƒì´ ì•„ë‹Œ ì§€ì†ì‹œì¼œì£¼ëŠ”ê²ƒì´ë‹¤.
};

const handleHome = (req, res) => {
  return res.send("I love middlewares");
};
// nextëŠ” ë‹¤ìŒ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œì¼œì¤€ë‹¤.

app.get("/", gossipMiddleware, handleHome); // ì´ëŸ°ì‹ìœ¼ë¡œ ì—°ê²°ë˜ì–´ìˆì–´ì•¼ next()ë¥¼ í–ˆì„ë•Œ ë‹¤ìŒí•¨ìˆ˜ë¡œ ì´ë™í•œë‹¤.
```

- [expressjs.com](https://expressjs.com/ko/guide/using-middleware.html)
- ì¤‘ê°„ì— ìˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì˜ë¯¸í•œë‹¤. ë¸Œë¼ìš°ì €ê°€ ë­”ê°€ë¥¼ requestë¥¼ í•˜ë©´ ì„œë²„ê°€ responseë¥¼ í•´ì¤€ë‹¤. ì´ ì‚¬ì´ì— middlewareê°€ ìˆëŠ” ê²ƒì´ë‹¤. ëª¨ë“  handlerê°€ middlewareì´ë‹¤.
- handlerë¼ëŠ” ë§ëŒ€ì‹  controllerë¼ëŠ” ë§ì„ ì´ì œë¶€í„° ì“¸ê²ƒì´ë‹¤. controllerì—ëŠ” ì‚¬ì‹¤
  req,res ë‘ê°œë§ê³  ì¸ìê°€ í•˜ë‚˜ ë”ìˆë‹¤. ê·¸ê²Œë°”ë¡œ ë‹¤ìŒí•¨ìˆ˜ë¥¼ ê°€ë¥´í‚¤ëŠ” nextì´ë‹¤.
- í•¨ìˆ˜ë¥¼ controllerë¼ê³  ìƒê°í•´ë„ë ë“¯í•˜ë‹¤.
- next()ë¥¼ ì‚¬ìš©í•´ì•¼ middlewareë¼ê³ í•œë‹¤. ì—†ìœ¼ë©´ middlewareë¼ê³ í• ìˆ˜ì—†ë‹¤. ì—°ê²°ì´ ëŠì–´ì§€ê¸° ë•Œë¬¸ì´ë‹¤. controllerì™€ middlewareê°€ ê±°ì˜ ê°™ì€ ì˜ë¯¸ë¡œ ì“°ì¸ë‹¤.
- ë§ˆì§€ë§‰ controolerì—ëŠ” nextë¥¼ ê´€ìŠµì ìœ¼ë¡œ ì“°ì§€ ì•ŠëŠ”ë‹¤.

### app.use()

- ì–´ë–¤ urlì—ë„ ì‘ë™í•˜ëŠ” middlewareë¥¼ ë§Œë“¤ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.
- ì¦‰, ëª¨ë“  routeì—ì„œ ì´ í•¨ìˆ˜ë¥¼ ì‚¬ìš© í•˜ëŠ” ê²ƒì´ë‹¤.
- app.get()ë³´ë‹¤ ë†’ì€ìœ„ì¹˜ì— ë‘¬ì•¼ ëª¨ë“  routeì—ì„œ ì‘ë™ì„ í•œë‹¤.
- ìˆœì„œê°€ ì¤‘ìš”í•˜ë‹¤. ì‹œê°í™” í•˜ëŠ” ë°©ë²•ì€ ì—°ê²°ì´ ìœ„ì—ì„œë¶€í„° ì°¨ë¡€ëŒ€ë¡œ ì˜¨ë‹¤ê³  ìƒê°í•˜ì.

### middleware morgan

- [morgan](https://www.npmjs.com/package/morgan) nodejsìš© request logger middlewareì´ë‹¤.
- morganí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´, ë‚´ê°€ ì„¤ì •í•œëŒ€ë¡œ middlewareë¥¼ returní•´ì¤€ë‹¤. í•¨ìˆ˜ë¥¼ ë¦¬í„´í•´ì£¼ëŠ”ê²ƒì´ë‹¤.!(ë‹¤ì„¯ê°€ì§€ì˜µì…˜ì´ ìˆë‹¤. ì†ŒìŠ¤ì½”ë“œë“¤ë„ ë³¼ìˆ˜ìˆëŠ”ë° í•œë²ˆë³´ë©´ ì¢‹ì„ë“¯. ë¬¸ì„œë„.)
- app.use(~~) callbackí•¨ìˆ˜ì´ê¸°ë•Œë¬¸ì—, rendergí•´ì¤€ë’¤ì— ì‹¤í–‰ëœë‹¤.

### routerë€?

- ë‚´ê°€ ì‘ì—…ì¤‘ì¸ ì£¼ì œë¥¼ ê¸°ë°˜ìœ¼ë¡œ URLì„ ê·¸ë£¹í™” í•´ì¤€ë‹¤.

```js

//ê¸€ë¡œë²Œ ë¼ìš°í„°
/ -> Home
/join -> Join
/login -> Login
/search -> Search
// ë…¼ë¦¬ìƒìœ¼ë¡œëŠ” user/loginì¸ë° ì˜ˆì™¸ìƒí™©ìœ¼ë¡œ URLì„ ê¹”ë”í•˜ê²Œí•˜ê³ , ì§§ê²Œí•œë‹¤.
// ê²°ë¡ ì€ URLì„ ê¹”ë”í•˜ê²Œí•˜ê¸°ìœ„í•´ ì˜ˆì™¸ìƒí™©ì„ ë‘˜ìˆ˜ìˆë‹¤.
//ìœ ì € ë¼ìš°í„°
/users/edit -> Edit user
/users/delete -> Delete user
//ë¹„ë””ì˜¤ ë¼ìš°í„°
/videos/watch -> Watch Video
/videos/edit -> Edit Video
/videos/delete -> Delete Video
/videos/comments -> Comment on a video
/videos/comments/delete -> Delete A Comment of a Video

/delete-users -> /users/delete //ì´ëŸ°ì‹ìœ¼ë¡œ ë°”ê¾¸ì–´ ê´€ë¦¬ë¥¼ ì‰½ê²Œ í• ìˆ˜ìˆë‹¤. ì½”ë“œê°€ í•œê³³ì— ë„ˆë¬´ëª¨ì—¬ìˆìœ¼ë©´ ë³µì¡í•˜ë‹ˆê¹Œ
/users //ë¥¼ë§Œë“¤ê³  ê·¸ë’¤ì— URLì„ ì¶”ê°€í•´ì£¼ëŠ”ê²ƒì´ë‹¤.
```

- [routing](http://expressjs.com/en/starter/basic-routing.html) :íŠ¹ì • ì—”ë“œí¬ì¸íŠ¸(íŠ¹ì •ê²½ë¡œì— == URL)ì— ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‘ë‹µí•˜ëŠ” ë°©ì‹ì„ ê²°ì •í•˜ëŠ”ê²ƒì„ ë§í•¨.
- expressì—ì„œ ì œê³µí•˜ëŠ” (express.router)[https://expressjs.com/ko/guide/routing.html]ë¥¼ ì´ìš©í•˜ë©´ ëª¨ë“ˆë¡œì¨ ì‰½ê²Œ ê´€ë¦¬í• ìˆ˜ìˆë‹¤. urlì´ ì–´ë–»ê²Œ ì‹œì‘í•˜ëŠ”ì§€ì— ë”°ë¼ ë‚˜ëˆ„ëŠ” ë°©ë²•ì´ë‹¤.(ê³µí†µ ì‹œì‘ë¶€ë¶„ìœ¼ë¡œ ê·¸ë£¹í™”)
- urlì„ ê·¸ë£¹ìœ¼ë¡œ ì •ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ í˜ë“¤ì–´ì§€ë‹ˆê¹Œ.

```js
//server.js
app.use(logger);
app.use("/", globalRouter);
app.use("/videos", videoRouter);
app.use("/users", userRouter);
// Routerë“¤ì€ ë”°ë¡œ íŒŒì¼ì„ ë§Œë“¤ì–´ì„œ ëª¨ë“ˆí™” í•´ì£¼ì—ˆë‹¤.
```

- /videosë¡œ ê²½ë¡œë¡œì˜¤ë©´ videoRouterë¡œ ì¼ë‹¨ ë“¤ì–´ê°„ë’¤, ê±°ê¸°ì„œë‹¤ì‹œ(videoRouter.jsíŒŒì¼ì—ì„œ,í•˜ë‚˜ì”© ìª¼ê°œì„œ ëª¨ë‘˜í™” í•´ì¤¬ìœ¼ë‹ˆê¹Œ) /watch, /editì„ ì°¾ì•„ ì´ë™í•œë‹¤.

### controller == function

- routeríŒŒì¼ì•ˆì—ëŠ” routeríŒŒì¼ë§Œ ìˆì–´ì•¼í•˜ê¸°ë•Œë¬¸ì— controller(function)í´ë”ë¥¼ ë˜ ë”°ë¡œ ë§Œë“¤ì–´ ì¤„ê²ƒì´ë‹¤.
- ë‚˜ì¤‘ì—ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë“± ì—¬ëŸ¬ê°€ì§€ë¥¼ ë„£ì–´ì•¼í•˜ê¸° ë•Œë¬¸ì— ë¶„ë¦¬í•˜ëŠ”ê²Œ ì¢‹ë‹¤.
- routerëŠ” ê²°êµ­ controller(function)ì„ ì‚¬ìš©í•˜ëŠ” ì…ì¥ì´ë‹¤.
- ê²°êµ­, ìƒê°í•´ë³´ë‹ˆ routerë¼ëŠ” ê°œë…ì´ ë‚˜ì˜¨ê²ƒë„ ëª¨ë‘ í•œíŒŒì¼ì— ë†”ë‘ê¸°ì—ëŠ” ë„ˆë¬´ ë³µì¡í•´ì§€ë‹ˆ ì„¸ì„¸í•˜ê²Œ ë‚˜ëˆˆë“¯ í•˜ë‹¤.
- ë§í¬(ì£¼ì†Œ)ë¡œ ì´ë™í•˜ë©´ ê·¸ ì£¼ì†Œì˜ ì»¨íŠ¸ë¡¤ëŸ¬(í•¨ìˆ˜)ê°€ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì„ ì•Œê³ ìˆì–´ì•¼í•œë‹¤.

### export import

- ë‚´ í”„ë¡œì íŠ¸ì˜ íŒŒì¼ë“¤ì€ ëª¨ë‘ë‹¤ ë…ë¦½ì ì´ê¸°ë•Œë¬¸ì— exportì„ í•´ì•¼ë§Œ ê³µìœ í• ìˆ˜ ìˆë‹¤.

```js
//globalRouter.js
globalRouter.get("/", handleHome);

export default globalRouter;
// defaultì˜ ëœ»ì€ ë‹¤ë¥¸ íŒŒì¼ì—ì„œ importë¥¼ í• ë•Œ
// import aijewfi from "./routers/globalRouter"; ì´ëŸ°ì‹ìœ¼ë¡œ ì´ë¦„ì„ ë§ˆìŒëŒ€ë¡œí• ìˆ˜ìˆë‹¤. í•˜ì§€ë§Œ í—·ê°ˆë¦´ìˆ˜ìˆê¸°ë•Œë¬¸ì— ëŒ€ë¶€ë¶„ ë˜‘ê°™ê²Œ í•œë‹¤.
```

- export default: ìœ„ì²˜ëŸ¼ defaultë¥¼ í•˜ë©´ í•˜ë‚˜ë°–ì— exportë¥¼ í•˜ì§€ëª»í•œë‹¤. ì—¬ëŸ¬ê°œë¥¼ í• ë ¤ë©´? [Link](https://ko.javascript.info/import-export) ëŒ€ë¶€ë¶„ ì—¬ëŸ¬ê°œë¥¼ exportí•œë‹¤.
- export default ì¸ê²½ìš°ì—ëŠ” importí• ë•Œ ì´ë¦„ì„ ë§ˆìŒëŒ€ë¡œ í• ìˆ˜ ìˆì§€ë§Œ, exportë¥¼ ì—¬ëŸ¬ê°œë¥¼ í•´ì•¼í• ê²½ìš° ì •í™•íˆ ê·¸ ì´ë¦„ìœ¼ë¡œ ì„¤ì •í•´ì£¼ì–´ì•¼í•œë‹¤.
- (DBë¶€ë¶„ì— ì ì–´ë†“ì€ê±° ê°€ì ¸ì˜´. )import exportë¥¼ ë³´ë©´ì„œ ë‹¤ìŒì— ë‚´ê°€ ë‹¤ë¥¸ ì–¸ì–´ë¥¼ ë³´ë©´ ì´ë ‡ê²Œí• ìˆ˜ìˆì„ê¹Œ ë¼ëŠ” ìƒê°ì´ë“¤ì—ˆë‹¤ -> ê³„ì†ê³ ë¯¼í•´ë´£ëŠ”ë° ë„ˆë¬´ ì–´ë µê²Œ ìƒê°í•œë“¯í•˜ë‹¤. ëª¨ë‘ê·¸ëƒ¥ í•œ íŒŒì¼ì— ì ì„ìˆ˜ ìˆëŠ”ë°, ê·¸ëŸ¬ë©´ ë„ˆë¬´ ì–´ì§€ëŸ¬ìš°ë‹ˆê¹Œ ë”°ë¡œë”°ë¡œ ìª¼ê°œì„œ í•˜ëŠ”ê±°ê³  ê·¸ê²ƒì„ ë‹¨ì§€ ì—°ê²°ë§Œ ì‹œì¼œì¤¬ì„ë¿ì´ë¼ê³  ìƒê°í•˜ê¸°ë¡œ í–ˆë‹¤.

### importì™€ requireì˜ ì°¨ì´ì 

- [Link](https://www.delftstack.com/ko/howto/javascript/javascript-import-vs-require/) : require()ëŠ” CommonJSë¥¼ ì‚¬ìš©í•˜ëŠ” node.jsë¬¸ì´ì§€ë§Œ, import()ëŠ” ES6ì—ì„œë§Œ ì‚¬ìš©, í•˜ì§€ë§Œ importëŠ” babel-nodeë¥¼ ì´ìš©í•´ì„œ ES6ë¬¸ë²•ì„ ì‚¬ìš©í• ìˆ˜ ìˆëŠ”ë“¯.

### Plannig Routes

- ì–´ë–¤ê¸°ëŠ¥ì´ í•„ìš”í•œê°€ì— ë”°ë¼ì„œ ë¯¸ë¦¬ ê³„íšì„ ì„¸ì›Œì¤˜ì•¼ëŒ. README.mdíŒŒì¼ì— ë¯¸ë¦¬ ì •ë¦¬í•˜ë©´ì„œ ë‹ˆê¼¬ëŠ” í•¨.(ì»¤ë§¨ë“œí‚¤ + í´ë¦­ í•˜ë©´ ë§í¬ë¡œ íŒŒì¼ì´ ìƒˆë¡œì—´ë¦°ë‹¤. importë¶€ë¶„ ë§í¬+ í•¨ìˆ˜ë„ ì •ì˜ë˜ì–´ ìˆëŠ”ë°ë¡œ ì´ë™í•œë‹¤.)

### URL Parameters

- URLì— ë³€ìˆ˜ë¥¼ í¬í•¨ì‹œí‚¤ê²Œí•´ì¤€ë‹¤. ëª¨ë“  ë™ì˜ìƒë§ˆë‹¤ routerë¥¼ ì¶”ê°€í•´ì¤„ìˆ˜ëŠ” ì—†ê¸°ë•Œë¬¸ì—

```js
videoRouter.get("/:id/edit", edit);
// idì´ë“¯ potatoì´ë“¯ ìƒê´€ì—†ë‹¤. :ê°€ í•„ìš”í•˜ë‹¤.
// expressí•œí…Œ ë³€ìˆ˜ë¼ëŠ”ê²ƒì„ ì•Œë ¤ì£¼ë ¤ë©´ :ê°€ í•„ìš”í•˜ë‹¤.
//constrollerì—ì„œ
console.log(req.params); // ë˜ëŠ” console.log(req.params.id);
// ì´ëŸ°ì‹ìœ¼ë¡œí•˜ë©´ expressê°€ ë°›ì•„ë“¤ì´ë‹¤ëŠ” ê²ƒì„ ì•Œìˆ˜ ìˆë‹¤.
// ë¼ìš°í„°ì—ì„œ :idì˜ ìœ„ì¹˜ê°€ ì¤‘ìš”í•˜ë‹¤. ë§¨ìœ„ì— ìˆìœ¼ë©´ ë¬´ì—‡ì„í•˜ë“  ë¬´ì¡°ê±´ ë³€ìˆ˜ë¡œ ë°›ì•„ë“¤ì´ê¸°ë•Œë¬¸ì´ë‹¤.
```

- [expressjs](http://expressjs.com/en/guide/routing.html) -> ì •ê·œì‹ìœ¼ë¡œë„ ì„ íƒí• ìˆ˜ìˆë‹¤.
- ì—¬ê¸°ì„œ :idë¥¼ í•´ì£¼ë©´ ë³€ìˆ˜ë¡œ ì“¸ìˆ˜ìˆë‹¤.(í”¼ë¼ë¯¸í„°ë¼ê³  í•œë‹¤.-> req.paramsí• ë•Œ ê·¸ ê°’ì„ ì˜ë¯¸í•œë‹¤.)
- ì´ë ‡ê²Œ í‘œì‹œí•˜ëŠ”ê±´ expressí•œí…Œ ì´ê²Œ ë³€ìˆ˜ë¼ëŠ”ê±¸ ì•Œë ¤ì£¼ê¸¸ ì›í•´ì„œì´ë‹¤.

### ì •ê·œì‹(regular expression)

- [regular expression](https://chrisjune-13837.medium.com/%EC%A0%95%EA%B7%9C%EC%8B%9D-%ED%8A%9C%ED%86%A0%EB%A6%AC%EC%96%BC-%EC%98%88%EC%A0%9C%EB%A5%BC-%ED%86%B5%ED%95%9C-cheatsheet-%EB%B2%88%EC%97%AD-61c3099cdca8) [expressjs](https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Regular_Expressions): ë¬¸ìì—´ë¡œë¶€í„° íŠ¹ì • ì •ë³´ë¥¼ ì¶”ì¶œí•´ë‚´ëŠ” ë°©ë²•ì´ë‹¤.ëª¨ë“  í”„ë¡œê·¸ë˜ë°ì–¸ì–´ì— ì¡´ì¬í•œë‹¤. íŠ¹ì •ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” stringì„ ë‹´ì„ìˆ˜ ìˆëŠ” containerê°™ì€ ëŠë‚Œì´ë‹¤.
- ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ì—°ìŠµí• ìˆ˜ ìˆëŠ” ê³³ [Link](https://regexr.com/)
- [stackoverflow](https://stackoverflow.com/questions/15228901/express-js-filter-a-number-and-a-string-in-the-url/15229495) ê²€ìƒ‰í‚¤ì›Œë“œ express url only number
- [stackoverflow](https://stackoverflow.com/questions/34095126/express-router-id) ê²€ìƒ‰í‚¤ì›Œë“œ express /:id
- expressë¬¸ì„œì—ì„œ /:id ì— ëŒ€í•œ ë‚´ìš©ì„ ì°¾ì•„ë³´ë‹ˆ [Link](http://expressjs.com/ko/api.html#req) ì—¬ê¸°ìˆì—ˆìŒ. ì´ ë‚´ìš©ì€ expressì—ë§Œ í•´ë‹¹ë˜ëŠ”ê²ƒì¸ê°€?

```js
videoRouter.get("/:id(\\d+)", see);
videoRouter.get("/:id(\\d+)/edit", edit);
videoRouter.get("/:id(\\d+)/delete", deleteVideo);
```

- idë¼ëŠ”ê²ƒì„ ê·¸ëŒ€ë¡œ ë‘” ì´ìœ : ì´ë¦„ì„ ì–»ê¸°ìœ„í•´ì„œ
- \ì˜ ì˜ë¯¸, ì´ê²ƒì€ ë‹¨ìˆœí•œ ë¬¸ìê°€ ì•„ë‹ˆë¼ëŠ”ê²ƒì„ ì•Œë ¤ì£¼ê¸°ìœ„í•´ì„œ

### Express template

- controller(function)ì—ì„œ htmlì„ returní•˜ëŠ”ë°©ë²•ì´ë‹¤.
- [Pug](https://www.zerocho.com/category/NodeJS/post/578c64621e3613150037d3b3) (êµ¬ Jade) - ê°€ì¥ ìœ ìš”í•œ í…œí”Œë¦¿ì¤‘ í•˜ë‚˜. ê³µì‹ [npm](npmjs.com/package/pug) ì—¬ê¸°ì„œ ë³´ëŠ”ê²Œ ì¢‹ì€ë“¯ ê°„ë‹¨í•œ ë¬¸ë²•(Syntax)ë„ ë³¼ìˆ˜ìˆì–´ì„œ.
- expressì—ê²Œ ì´ì œë¶€í„° ì‚¬ìš©í•  ë·° ì—”ì§„ì€ pugë¼ê³  ë§ì„ í•´ì£¼ì–´ì•¼í•œë‹¤.
- [expressjs](https://expressjs.com/ko/4x/api.html#app)ì—ì„œ Application Settings( app.set() )ì„ ë³´ë©´ propertyì— view engineì´ë¼ê³  ìˆë‹¤.
- 1ë‹¨ê³„ pug ì„¤ì¹˜(npm i pug) <br>
  2ë‹¨ê³„ pugë¥¼ ë·° ì—”ì§„ìœ¼ë¡œ ì„¤ì •(app.set("view engine", "pug")) <br>
  3ë‹¨ê³„ ì‹¤ì œë¡œ pugíŒŒì¼ì„ ìƒì„±í•œë‹¤.
- expressjsì—ì„œ ë¬¸ì„œë¥¼ ë³´ë©´ viewsì—ì„œ defaultë¡œ process.cwd() + "/views" ë¼ê³  ì í˜€ìˆëŠ”ë°, cwdì˜ ëœ»ì€ current working directoryì´ë‹¤. ì¦‰, í˜„ì¬ í´ë”ì—ì„œ viewsì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ íŒŒì¼ì„ ì°¾ê² ë‹¤ëŠ” ê²ƒì´ë‹¤.
- ì´ì œ pugíŒŒì¼ì„ ë Œë”ë§í•´ì£¼ì–´ì•¼í•˜ëŠ”ë° í•˜ëŠ” ë°©ë²•ì€, res.redner("íŒŒì¼ì´ë¦„")ì´ë‹¤.
- í•˜ì§€ë§Œ ì—ëŸ¬ê°€ ìƒê¸¸ê±°ì„. ì‹¤ì œë¡œ íŒŒì¼ì€ wetube/src/viewsì— ìˆê¸°ë•Œë¬¸ì—(wetube/views)ì—ì„œ ì°¾ìœ¼ë‹ˆ ì•ˆë³´ì´ëŠ”ê±°ì„.(ì—ëŸ¬ë¥¼ ê¼¼ê¼¼íˆ ì½ì–´ì„œ ë­ê°€ ë¬¸ì œì¸ì§€ ì•„ëŠ”ê²Œ ì¤‘ìš”í•œë“¯.)
- í•´ê²°ë°©ë²•ì€ ë””í´íŠ¸ê°’ì„ ìˆ˜ì •í•´ì£¼ëŠ”ê²ƒì„. app.set("views", process.cwd() + "/src/views");
- [ë Œë”ë§](https://velog.io/@ru_bryunak/%EB%A0%8C%EB%8D%94%EB%A7%81%EC%9D%B4%EB%9E%80)ì´ë€? htmlíŒŒì¼ì„ ë°›ì•„ ë¸Œë¼ìš°ì €ì— ë¿Œë ¤ì£¼ëŠ” ê³¼ì •.

### pug Interplation ë³´ê°„ë²• Escape ,HTML Entity

```js
doctype html
html(lang="ko")
    head
        title Wetube
    body
        h1 Welcome to Wetube
        footer &copy; #{new Date().getFullYear()} Wetube
```

- ìœ„ì—ì„œ #{}ì´ëŸ°ì‹(h1=pageTitle ì´ë ‡ê²Œì“°ë©´ variableë¡œ ì¸ì‹í•œë‹¤. í•˜ì§€ë§Œ ì¤‘ê°„ì— ë‹¤ë¥¸ stringì„ ë¼ì›Œë†“ì„ìˆ˜ ì—†ë‹¤.) ìœ¼ë¡œ ì¤‘ê°„ì— Jscode ë¥¼ ê»´ë†“ëŠ”ê²ƒì„ [ë³´ê°„ë²•](https://pugjs.org/language/interpolation.html)ì´ë¼ê³  í•œë‹¤. Pug ë³´ê°„ë²•[ë˜ ë‹¤ë¥¸ ë§í¬](https://sodocumentation.net/pug/topic/9565/interpolation-with-pug)

-ê·¸ë¦¬ê³  &copyë“±ì€ [HTML Entity](https://www.zerocho.com/category/HTML&DOM/post/587f50b1308ed50018a00d51)ë¼ê³ í•œë‹¤.(ì¢‹ì€ì‚¬ì´íŠ¸ì¸ê±°ê°™ë‹¤.) íŠ¹ìˆ˜ë¬¸ìë¥¼ í‘œí˜„í•˜ê¸°ìœ„í•´ ì‚¬ìš©í•œë‹¤.

### pug partials

- ë°˜ë³µë˜ëŠ” ë¶€ë¶„ì„ íŒŒì¼ë¡œ ìª¼ê°œì„œ ì‰½ê²Œ ë¶ˆëŸ¬ì˜¬ìˆ˜ ìˆë‹¤.!
- [ê³µì‹ë¬¸ì„œ](https://pugjs.org/api/getting-started.html) [includes](https://pugjs.org/language/includes.html)ë¥¼ ëˆŒëŸ¬ë³´ë©´ ë‹¤ë¥¸íŒŒì¼ì„ í¬í•¨ì‹œí‚¬ìˆ˜ìˆëŠ” ë°©ë²•ì´ ìˆë‹¤.(ì´ëŸ°ì‹ìœ¼ë¡œ ë¬¸ì„œë¥¼ ì½ëŠ” ë°©ë²•ì„ ì˜ ë°°ì›Œì•¼ í• ê±° ê°™ë‹¤.)
- ì²«ë²ˆì§¸ ì´ê²ƒìœ¼ë¡œ ì•Œìˆ˜ ìˆëŠ”ì ì€ ê¹”ë”í•œ htmlì„ ì‘ì„±í•˜ë„ë¡ í•´ì¤€ë‹¤ëŠ” ê²ƒì´ë‹¤. <br>
  ë‘ë²ˆì§¸ ìš°ë¦¬ì˜ htmlì— ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í¬í•¨ì‹œí‚¬ìˆ˜ ìˆë‹¤ëŠ” ì .
  ì„¸ë²ˆì§¸ ìš°ë¦¬ê°€ ë°˜ë³µí•˜ì§€ í•˜ì§€ì•Šê³  í•œë²ˆì— ëª¨ë“  í…œí”Œë¦¿ì„ ì—…ë°ì´íŠ¸í• ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.
- í”„ë¡œê·¸ë˜ë¨¸ë“¤ì€ ë°˜ë³µë˜ëŠ”ê²ƒì„ ì‹«ì–´í•˜ê¸° ë•Œë¬¸ì—(ê²Œìœ¼ë¥´ê¸°ë•Œë¬¸ì—) ë” ë°˜ë³µë˜ëŠ”ê²ƒì„ ì¤„ì¼ìˆ˜ ìˆë‹¤. ì•„ë˜ì—ì„œ ë°˜ë³µëœë‹¤.

### pug Template Inheritance (ìƒì†)

- [ìƒì†](https://pugjs.org/language/inheritance.html)ì´ ì™œ ì“°ëƒë©´ì€, ì¼ì¢…ì˜ ë² ì´ìŠ¤ í‹€ì„ ë§Œë“¤ì–´ ì£¼ê¸°ë•Œë¬¸ì´ë‹¤. ê³„ì† ë² ì´ìŠ¤ê°€ ë°˜ë³µë˜ê¸°ë•Œë¬¸ì— ê·¸ê²ƒë§ˆì € ì¤„ì—¬ì¤„ë ¤ê³  ìƒì†ì´ë¼ëŠ”ê²ƒì„ ì“°ëŠ”ê²ƒì´ë‹¤.
- ëª¨ë“ íŒŒì¼ì´ ë² ì´ìŠ¤ë¶€í„° í™•ì¥í•´ ë‚˜ê°€ëŠ”ê²ƒì´ë‹¤.
- í•˜ì§€ë§Œ ì—¬ê¸°ì„œ ëë‚˜ëŠ”ê²Œ ì•„ë‹ˆë¼ blockì´ë¼ëŠ” ê°œë…ë„ ì•Œì•„ì•¼ í•œë‹¤. -> ë¬´ì–¸ê°€ë¥¼ ì§‘ì–´ ë„£ì„ìˆ˜ ìˆëŠ”ê³³. ë‹¤ë¥¸ pugíŒŒì¼ì´ ì±„ì›Œë†“ì„ìˆ˜ ìˆëŠ”ê³³. ê³µì‹ ë¬¸ì„œë¥¼ ë³´ë©´ ì•Œìˆ˜ ìˆë‹¤.
- res.render("",{})ëŠ” 2ê°€ì§€ ì¸ìˆ˜ë¥¼ ë°›ëŠ”ë° í•˜ë‚˜ëŠ” view ì´ë¦„ì´ê³  í•˜ë‚˜ëŠ” í…œí”Œë¦¿ì— ë³´ë‚¼ ë³€ìˆ˜ì´ë‹¤. express ë¬¸ì„œë¥¼ ë³´ë©´ ë³€ìˆ˜ë¥¼ ë³´ë‚¼ìˆ˜ ìˆë‹¤ê³  ë‚˜ì™€ìˆê³ , Interplation(ë³´ê°„ë²•)ì™€ í™œìš©í•´ì„œ expressì—ì„œ ë³€ìˆ˜ì˜ ê°’ì„ ë„˜ê¸¸ìˆ˜ ìˆë‹¤.(ë Œë”ë§í•˜ëŠ”ê³¼ì •ì—ì„œ)

### pug conditionals,iteration

- docì— ë„ˆë¬´ ìì„¸íˆ ì˜ë‚˜ì™€ìˆì–´ì„œ ì„¤ëª…ì•ˆí•´ë„ ë ë“¯.
- [conditionals](https://pugjs.org/language/conditionals.html) ì¡°ê±´ë¬¸
- [iteration](https://pugjs.org/language/iteration.html) ë°˜ë³µ
- [mixin](https://pugjs.org/language/mixins.html) ë˜‘ë˜‘í•œ partialì´ë‹¤. ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ì¼ì¢…ì˜ ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ HTML blockì´ë¼ ë³¼ìˆ˜ ìˆë‹¤. [ì»´í¬ë„ŒíŠ¸](https://mommoo.tistory.com/55)ì˜ ì¬ì‚¬ìš©ì„ ìœ„í•´ì„œ ë§Œë“¤ì–´ì§„ë“¯. ìœ íŠœë¸Œë¥¼ ë³´ë©´ ë¹„ë””ì˜¤ì— ëŒ“ê¸€, í‰ì , ì¢‹ì•„ìš” ë“±ë“±ì´ í•˜ë‚˜ì˜ ì»´í¬ë„ŒíŠ¸ë¼ê³  ìƒê°í•˜ê³ , ê·¸ê²ƒë“¤ì„ ì¼ì¼íˆ copy pasteí•˜ê¸°ì—ëŠ” ê²Œìœ¼ë¥´ë‹ˆ, ë°˜ë³µì„ ì¤„ì´ê¸°ìœ„í•´, ê·¸ë¦¬ê³  ì½”ë“œì˜ ì¬ì‚¬ìš©ì„ í•˜ê¸°ìœ„í•´ì„œ.

### MVP css

- HTML íƒœê·¸ì— ëª‡ê°€ì§€ ê¸°ë³¸ìŠ¤íƒ€ì¼ì„ ì…í˜€ì¤€ë‹¤. [Link](https://andybrewer.github.io/mvp/)
- ë„ˆë¬´ ëª»ìƒê¸´ìƒíƒœë¡œ í•˜ë©´ ì¢€ ê·¸ëŸ¬ë‹ˆê¹Œ ë­ë¼ë„ ì…íŒê²ƒì´ë‹¤. ê·¸ëƒ¥ ì„ì‹œë°©í¸ì •ë„.

### í…ìŠ¤íŠ¸ì™€ variableì„ ì„ëŠ”ë²•

```js
a((href = "/video/" + video.id));
a((href = `/video/ + ${video.id}`));

const { id } = req.params;
const id = req.params.id; // ES6ë°©ì‹
```

- [req.parms](https://wooooooak.github.io/web/2018/11/10/req.params-vs-req.query/) ì–´ë–¤ê²ƒì„ í´ë¦­í–ˆì„ë•Œ ì–´ë–¤ objcet í´ë¦­ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í• ìˆ˜ ìˆì„ë“¯.

### ternary operator

- [Link](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Operators/Conditional_Operator) jsì—ì„œ ì œê³µë˜ëŠ” ì—°ì‚°ìì´ë‹¤.

```js
h3 #{video.views} #{video.views === 1 ? "view" : "views" }
```

### ì ˆëŒ€ê²½ë¡œ(absoulte url)ì™€ ìƒëŒ€ê²½ë¡œ(relative url)

-ì œì¼ì•ì— /ê°€ìˆìœ¼ë©´ ì ˆëŒ€ê²½ë¡œ, ë¬´ì¡°ê±´ ë£¨íŠ¸ì—ì„œ ì‹œì‘. ì—†ìœ¼ë©´ ìƒëŒ€ê²½ë¡œ ë’·ë¶€ë¶„ë§Œ ë°”ë€œ <br>
a(href="/edit")--->localhost:4000/edit <br>
a(href="edit")--->localhost:4000/videos/edit <br>
a(href=`${video.id}/edit`)--->localhost:4000/videos/1/edit

> watch.pugì—ì„œ
> href="edit"ì˜ ìƒëŒ€ ê²½ë¡œê°€ ì™œ videos/editìœ¼ë¡œ ê°€ë‚˜ìš”??
> í˜„ì¬ ê²½ë¡œê°€ videos/:idì´ë¯€ë¡œ videos/:id/editìœ¼ë¡œ ê°€ì•¼í•˜ëŠ”ê±° ì•„ë‹Œê°€ìš”??
>
> > No, it does not add to the path, it changes the last path.

### POSTì™€ GET

```js
block content
    h4 Change Titie of video
    form(method="POST")
        input(name="title" placeholder="Viedo Title" value=video.title,required)
        input(value="Save",type="submit")
```

- HTTP method
- GET ê³¼ POST ëŠ” HTTP ë©”ì„œë“œë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë¬´ì–¸ê°€ë¥¼ ìš”ì²­í•  ë•Œ ì‚¬ìš©í•œë‹¤.
- getê³¼ postì˜ ì°¨ì´ [Link](https://noahlogs.tistory.com/35) getì„ í†µí•œ ìš”ì²­ì€ URLì£¼ì†Œëì— íŒŒë¼ë¯¸í„°ë¡œ í¬í•¨ë˜ì–´ ì „ì†¡. ì´ë¶€ë¶„ì„ ì¿¼ë¦¬ ìŠ¤íŠ¸ë§(query string)ì´ë¼í•œë‹¤.
- [formíƒœê·¸](https://www.nextree.co.kr/p8428/) ê¸°ë³¸ì ìœ¼ë¡œ methodëŠ” GETìœ¼ë¡œ ë˜ì–´ìˆìŒ.
  <br> GETì€ ë°ì´í„°ë¥¼ ìš”ì²­í• ê²½ìš° ì”€, ìš°ë¦¬ê°€ ë„¤ì´ë²„ê²€ìƒ‰í•˜ê±°ë‚˜ ìœ íŠœë¸Œê²€ìƒ‰í• ë•Œ ì”€. URLëì— ë¶™ì–´ì„œ ëˆˆì—ë³´ì„. -> ë³´ì•ˆì— ì·¨ì•½
  <br> POSTì€ ë°ì´í„°ë¥¼ ì²˜ë¦¬í• ê²½ìš° ì”€.ë¡œê·¸ì¸í• ë•Œë‚˜ ìœ íŠœë¸Œ ì œëª©ìˆ˜ì • ë“±ì— ì“°ì„. ê¸°ë³¸ì ìœ¼ë¡œ postë¥¼ ë³´ë‚´ëŠ” ì£¼ì†ŒëŠ” ìê¸°ì£¼ì†Œì™€ ê°™ìŒ. actionìœ¼ë¡œ ìˆ˜ì •ê°€ëŠ¥.
  <br> ì¦‰ formíƒœê·¸ì˜ methodëŠ” formê³¼ back endì‚¬ì´ì˜ ì •ë³´ì „ì†¡ì— ê´€í•œ ë°©ì‹ì´ë‹¤. ì°©ê°í•˜ì§€ë§ì•„ì•¼ í• ê²ƒ, postë„ requestë¥¼ ë°›ìœ¼ë©´ response í•´ì¤˜ì•¼í•œë‹¤ëŠ” ê²ƒ.

### POSTë¥¼ ë°›ì•˜ì„ë•Œ back endì—ì„œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•

```js
videoRouter.get("/:id(\\d+)/edit", getEdit);
videoRouter.post("/:id(\\d+)/edit", postEdit);
// ì´ëŸ°ì‹ìœ¼ë¡œ ì§§ê²Œ ì“¸ìˆ˜ë„ ìˆë‹¤.
videoRouter.route("/:id(\\d+)/edit").get(getEdit).post(postEdit);

// postEditì—ì„œ idê°’ì€ ì–´ë””ì„œ ê°€ì ¸ì˜¤ëŠ”ê²ƒì´ëƒ? videoRouterì˜ :idì—ì„œ ê°€ì ¸ì˜¤ëŠ”ê²ƒì´ë‹¤.
export const postEdit = (req, res) => {
  const { id } = req.params; // URL :id parameterë¥¼ ì˜ë¯¸í•œë‹¤.
  const { title } = req.body; // formì•ˆì—ìˆëŠ” valueì˜ javascript representationì´ë‹¤.
  console.log(req.body); // ì–´ë–¤ ê²ƒì„ ë°›ì•˜ëŠ”ì§€ í™•ì¸í•˜ê³ ì‹¶ì€ë° undefinedì´ë¼ê³  ëœ¸.
  //ì™œ express applicationì€ formì„ ì–´ë–»ê²Œ ë‹¤ë£¨ëŠ”ì§€ ëª¨ë¥¸ë‹¤.
  console.log(title);
  // ì•„ë˜ì™€ê°™ì´ëŠ” ì•ˆëœë‹¤ê³ í–ˆëŠ”ë° ë˜ê¸´ëœë‹¤.
  // const video = videos[id - 1];
  // video.title = title;
  const video = videos[id - 1];
  return res.redirect(`/videos/${id}`);
};
```

- express applicationì´ formì„ ì–´ë–»ê²Œ ë‹¤ë£¸? -> [doc](https://expressjs.com/ko/4x/api.html#express.urlencoded) express.urlencodedë¼ëŠ” ê²Œ formì˜ valueì„ ì´í•´í•˜ê²Œ í•´ì¤€ë‹¤.
- HTML postì‚¬ìš©í• ë•Œ ìœ ì˜í• ì . inputì— name ì„¤ì •ì„ í•´ì£¼ì§€ ì•Šìœ¼ë©´ ë°ì´í„°ê°€ ì „ì†¡ë˜ì§€ ì•ŠëŠ”ë‹¤.
- redirectì´ urlë¡œ ì—°ê²°.
- ê³„ì† ê°•ì˜ë¥¼ ë“¤ìœ¼ë©´ì„œ ëŠë‚€ì ì€ ë¬¸ì„œë¥¼ ë³´ëŠ”ê²Œ ì¤‘ìš”í•˜ë‹¤ëŠ”ê²ƒì´ë‹¤. ë­”ê°€ í”„ë¡œì íŠ¸ë¥¼ í•˜ê¸°ì „ì— ë¬¸ì„œë¥¼ ëŒ€ëµ ì½ì–´ë³´ëŠ”ê²Œ ì¢‹ì„ê±°ê°™ê³ , í‰ì†Œì—ë„ ë³´ëŠ”ê²Œ ì¢‹ì„ë“¯í•˜ë‹¤.
  > req.bodyëŠ” get request ê°’ì€ ë°›ì•„ì˜¬ ìˆ˜ ì—†ë‚˜ìš”?
  > post request ë¡œ ì „ì†¡ëœ ê°’ë§Œ ê°ì²´ë¡œ ë°›ì•„ì˜¬ ìˆ˜ ìˆëŠ”ê±´ê°€ìš”?
  >
  > > req.body is only with POST :) <br>
  > > Not really, is just that only in POST we can send data. Not on GET

### DATABASE mongoDB,mongoose

- mongoDB: ì¼ë°˜ì ìœ¼ë¡œëŠ” sqlë² ì´ìŠ¤ì¸ë° doucment-basedì´ë‹¤. í”„ë¡œê·¸ë˜ë¨¸ì²˜ëŸ¼ objectë¡œ ìƒê°í•œë‹¤. JSON-like-document -> packag.jsonì²˜ëŸ¼ ì €ì¥
- ì„¤ì¹˜ë°©ë²• mongoDB -> docs -> server -> installation -> [community edition](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/)
- ì˜ ì„¤ì¹˜ë¬ëŠ”ì§€ í™•ì¸ì¥ë²• mongodì…ë ¥. mongoë¥¼ ì¹˜ë©´ mongoì‰˜ì— ì…ì¥ê°€ëŠ¥.(nodeë„ ì¹˜ë©´ ë˜‘ê°™ì´ ë“¤ì–´ê°.)
- [mongoose](https://mongoosejs.com/): node.js ì™€ mongoDBë¥¼ ì´ì–´ì£¼ëŠ” ë‹¤ë¦¬(ìƒí˜¸ì‘ìš©í•´ì£¼ê¸°ìœ„í•´ ì‚¬ìš©), ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì ìœ¼ë©´ mongooseê°€ mongoDBì—ê²Œ ì „í•´ì¤€ë‹¤.
- object(dataë“¤)ë¥¼ ìƒì„±í•˜ë©´ ìë™ìœ¼ë¡œ idë¥¼ ë¶€ì—¬í•´ì¤€ë‹¤.
- testí• ë•Œ ë°ì´í„° ì§€ìš°ëŠ”ë²• : db.\_collection_name.remove({})

```js
//db.js
import mongoose from "mongoose";
mongoose.connect("mongodb://127.0.0.1:27017/wetube", {
  useNewUrlParser: true,
  useUnifiedTopology: true,
}); // ì•ì—ìˆëŠ”ê²ƒì€ ë‚´ ë¡œì»¬í˜¸ìŠ¤íŠ¸ì´ë‹¤. mongoë¥¼ì¹ ë•Œ ë³´ë©´ ì–»ì„ìˆ˜ìˆë‹¤. ë’¤ì— wetubeëŠ” ì´ì œë¶€í„° ì—¬ê¸°ì— ì—°ê²°í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤(ì•„ì§ ìƒì„±ì€ ì•ˆë˜ì—ˆë‹¤.). ë’¤ì—ìˆëŠ”ê²ƒì€ ì˜µì…˜ì¸ë° ê²½ê³ ë¥¼ í•´ì¤˜ì„œ ì˜µì…˜ì„ ì¶”ê°€í•´ì£¼ì—ˆë‹¤.

const db = mongoose.connection;
const handleOpen = () => console.log("âœ… Conected to DB");
const handleError = (error) => console.log("DB Error", error);
db.on("error", handleError); //ì—¬ëŸ¬ë²ˆ ë°œë™ê°€ëŠ¥
db.once("open", handleOpen); //í•œë²ˆë§Œ ë°œë™
//server.js
import "./db"; //dbíŒŒì¼ì„ ì„í¬ìŠ¤í•´ì¤Œìœ¼ë¡œì¨ ë‚´ ì„œë²„ê°€ mongoì— ì—°ê²°ì´ ëœë‹¤. ë°ì´í„°ë² ì´ìŠ¤ë¥¼ importí•´ì¤€ê²Œì•„ë‹ˆë¼ dbì„¤ì •íŒŒì¼?ì„ importí•´ì¤€ê²ƒì´ë‹¤. importí•´ì¤€ìˆœê°„ ìë™ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.
```

- CRUD, create, read , upload ,delete

### modelsí´ë” Video.js -> Video Model

- databaseê°€ ì•Œì•„ì•¼ í• ê²ƒì€ ë°ì´í„°ê°€ ì–´ë–»ê²Œ ìƒê²¼ëŠ”ê°€ì— ëŒ€í•œê²ƒ. êµ¬ì²´ì ì¸ ê°’ì´ ì•„ë‹ˆë¼
- ê·¸ë˜ì„œ ìš°ë¦¬ê°€ ì„¤ëª…ì„ í•´ì£¼ì–´ì•¼ëŒ. videoë¼ëŠ” ê°ì²´ì— ì–´ë–¤ ë°ì´í„°ë“¤ì´ í•„ìš”í•œì§€.
- ì´ëŸ¬í•œ ìƒê¹€ìƒˆë¥¼ schemaë¼ê³  ì—¬ê¸°ì„œ ë¶€ë¥¸ë‹¤. ìŠ¤í‚¤ë§ˆë¼ëŠ”ê²ƒì€ ë¶•ì–´ë¹µí‹€? ì •ë„ë¼ë„ ìƒê°í•˜ë©´ë ë“¯

```js
//Video.js
import mongoose from "mongoose";

const videoSchema = new mongoose.Schema({
  title: String,
  description: String,
  createdAt: Date,
  hashtags: [{ type: String }],
  meta: {
    views: Number,
    rating: Number,
  },
});

const Video = mongoose.model("Video", videoSchema);
// ì²«ë²ˆì§¸ ì¸ìëŠ” í•´ë‹¹ collectionì˜ ë‹¨ìˆ˜ì  í‘œí˜„ì„ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ìì—´ì´ë‹¤. ì‹¤ì œ collectionì˜ ì´ë¦„ì€ videosë¡œ ìë™ë³€í™˜ë˜ì–´ ì‚¬ìš©ëœë‹¤.
export default Video;

//server.js
import "./db"; //ì´ dbì— ì—°ê±¸í• ê²Œìš”
import "./models/Video"; // ë¶•ì–´ë¹µí‹€
```

- import exportë¥¼ ë³´ë©´ì„œ ë‹¤ìŒì— ë‚´ê°€ ë‹¤ë¥¸ ì–¸ì–´ë¥¼ ë³´ë©´ ì´ë ‡ê²Œí• ìˆ˜ìˆì„ê¹Œ ë¼ëŠ” ìƒê°ì´ë“¤ì—ˆë‹¤ -> ê³„ì†ê³ ë¯¼í•´ë´£ëŠ”ë° ë„ˆë¬´ ì–´ë µê²Œ ìƒê°í•œë“¯í•˜ë‹¤. ëª¨ë‘ê·¸ëƒ¥ í•œ íŒŒì¼ì— ì ì„ìˆ˜ ìˆëŠ”ë°, ê·¸ëŸ¬ë©´ ë„ˆë¬´ ì–´ì§€ëŸ¬ìš°ë‹ˆê¹Œ ë”°ë¡œë”°ë¡œ ìª¼ê°œì„œ í•˜ëŠ”ê±°ê³  ê·¸ê²ƒì„ ë‹¨ì§€ ì—°ê²°ë§Œ ì‹œì¼œì¤¬ì„ë¿ì´ë¼ê³  ìƒê°í•˜ê¸°ë¡œ í–ˆë‹¤.
- moogooseì˜ ë§í¬ë“¤ [Link1](https://poiemaweb.com/mongoose) [Link2](https://dhddl.tistory.com/173)
- validation: numberë¶€ë¶„ì— stringì„ ë„£ìœ¼ë©´ ê·¸ë¶€ë¶„ì´ í¬í•¨ë˜ì§€ì•Šì€ì±„ ë§Œë“¤ì–´ì§„ë‹¤ëŠ”ê²ƒì„ ì•Œìˆ˜ìˆë‹¤.(ì˜¬ë°”ë¥´ì§€ì•Šì€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³ ì‹¶ì§€ì•Šìœ¼ë‹ˆê¹Œ) ì–´ëŠì •ë„ ë³´í˜¸ëœê°€ëŠ”ê²ƒì„ ì•Œìˆ˜ ìˆë‹¤.

<br>
### init.js -> importê°€ ë„ˆë¬´ë§ì•„ ê¸°ëŠ¥ë³„ë¡œ ë¶„ë¦¬

```js
import "./db";
import "./models/Video";
```

- server.jsì—ëŠ” serverì™€ ê´€ë ¨ëœ expressë§Œ
- ìœ„ì™€ê°™ì€ í˜•ì‹ì˜ importë¥¼ ì—„ì²­ë§ì´í•˜ê²Œë í…ë° ê·¸ëŸ¬ë©´ ì¢€ ë³µì¡í•´ì§€ë‹ˆ ë¶„ë¦¬í•˜ê² ë‹¤.

> server.js ì—ì„œ
> const PORT = 4000;
> const handleListening = () =>
> console.log(`âœ… Server listenting on http://localhost:${PORT} ğŸš€`);
> app.listen(PORT, handleListening);
> ë¶€ë¶„ì„ init.js ë¡œ ì˜®ê²¼ëŠ”ë°, ì´ ë¶€ë¶„ë„ server ì— ê´€ë ¨ëœ ì½”ë“œê°€ ì•„ë‹Œê°€ìš”?
> or
> app.listen(PORT, handleListening); ëŠ” just ì„œë²„ê°€ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ í™•ì¸ë§Œ í•˜ê³  handleListening í•¨ìˆ˜ë¥¼ callback í•´ì£¼ëŠ” ê±´ê°€ìš”?
> (ê·¸ë ‡ë‹¤ë©´ ì„œë²„ë¥¼ ì—´ì–´ì£¼ëŠ” ê²ƒì€ const app = express(); ë¶€ë¶„ì¸ê°€ìš”?)
>
> > ë‹µ .listen() is the code that opens the port to listen for connections.

<br>

### (dbì—ì„œ ë‚˜ì˜´) callbackê³¼ promise

- databaseê°€ ì¢…ë£Œë˜ê±°ë‚˜, ë°”ì˜ê±°ë‚˜ ë“±ë“±, databaseê°€ jsê°€ ì¡´ì¬í•˜ê¸°ë•Œë¬¸
- <br>
  [ë¹„ë™ê¸°ì²˜ë¦¬ë€?](https://joshua1988.github.io/web-development/javascript/javascript-asynchronous-operation/)
  íŠ¹ì • ì½”ë“œì˜ ì—°ì‚°ì´ ëë‚  ë•Œê¹Œì§€ ì½”ë“œì˜ ì‹¤í–‰ì„ ë©ˆì¶”ì§€ ì•Šê³  ë‹¤ìŒ ì½”ë“œë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ íŠ¹ì„±ì„ ì˜ë¯¸. ê·¸ë˜ì„œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ìœ„í•´ì„œ callbackí•¨ìˆ˜ë¥¼ ì‚¬ìš©-> ì˜¤ë˜ëœ ë°©ë²•ì„.
- [promise](https://joshua1988.github.io/web-development/javascript/promise-for-beginners/) : ë¹„ë™ê¸° ì²˜ë¦¬ì— ì‚¬ìš©ë˜ëŠ” ê°ì²´ ì¦‰, ë¹„ë™ê¸° ì²˜ë¦¬ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ê°ì²´ì´ë‹¤. í•´ê²°í•˜ê¸°ìœ„í•´ì„œ!
- [async & await](https://joshua1988.github.io/web-development/javascript/js-async-await/)
  callbackì˜ ìµœì‹ ë²„ì „, ê³„ì† ê¸°ë‹¬ë ¤ì¤€ë‹¤. ì§ê´€ì ì´ê¸°ë•Œë¬¸ì— javascriptê°€ ì–´ë””ì„œ ê¸°ë‹¤ë¦¬ëŠ”ì§€ ë°”ë¡œì•Œìˆ˜ìˆìŒ.(ìˆœì„œëŒ€ë¡œ ìœ„ì—ì„œë¶€í„° ì•„ë˜ë¡œì‹¤í–‰ëŒ.)
- [Promiseì™€ async/await ì°¨ì´ì ](https://velog.io/@pilyeooong/Promise%EC%99%80-asyncawait-%EC%B0%A8%EC%9D%B4%EC%A0%90)
- [try catchë¬¸](https://skmagic.tistory.com/157) : errorë¥¼ ë‹¤ë£¨ê¸°ìœ„í•´ ì‚¬ìš©, tryë¶€ë¶„ì„ ì‹¤í–‰í•˜ë‹¤ê°€ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ errorê°ì²´ì— errorê°€ ì €ì¥ëŒ. catchë¶€ë¶„ì´ ì‹¤í–‰ëŒ. ê·¸ëƒ¥ ì–¸ì–´ì°¨ì›ì—ì„œ ì œê³µí•˜ëŠ”ê²ƒ. ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì•„ë‹ˆë¼
  <br>

### ì™œ callbackí•¨ìˆ˜ì— error argumentê°€ ê»´ìˆëŠëƒ?

- [Stackoverflow](https://stackoverflow.com/questions/31375728/node-js-callback-function-error-parameter-explanation)
- [Link](http://thenodeway.io/posts/understanding-error-first-callbacks/) : ì½œë°±ì˜ ì²«ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ì— ì—ëŸ¬ ê°ì²´ë¥¼ ì‚¬ìš©.ì¼ì¢…ì˜ ì½”ë”©ì•½ì† [Link](https://www.hanumoka.net/2018/11/02/javascript-20181102-javascript-error-first-callback-pattern/)

<br>

### hashtags -> split()

- "#hello,#hi,#lalala".split(",") -> arrayë¡œ ë¦¬í„´í•´ì¤€ë‹¤.
- ë¬¸ìì—´ì„ ë°°ì—´ë¡œ ë³€í™˜ [splití•¨ìˆ˜](https://hianna.tistory.com/377)
- "food,movies,music".split(",").map(word => `#${wrod}`) ì´ëŸ°ì‹ìœ¼ë¡œë„ ê°€ëŠ¥
- ëª¨ë“  ë°°ì—´ì˜ ê°’ì— functionì„ ì‹¤í–‰í•˜ëŠ” [mapí•¨ìˆ˜](https://velog.io/@daybreak/Javascript-map%ED%95%A8%EC%88%98)

<br>

### ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥

- ë‘ê°€ì§€ë°©ë²•ì´ ìˆìŒ

```js
export const postUpload =  async (req, res) => {const { title, description, hashtags } = req.body;
// objectë¥¼ ë§Œë“¤ì–´ ì¤€í›„ ì €ì¥
  const video = new Video({
  ...
  });
  await video.save(); // ë°ì´í„°ë² ì´ìŠ¤ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°–ì—ìˆì–´ì„œ ì´ëŸ°ì‹ìœ¼ë¡œ ì²˜ë¦¬í•´ì£¼ì–´ì•¼í•œë‹¤.
  return res.redirect("/");
};
// createë¥¼ ì¨ì„œ ê·¸ ê³¼ì •ì„ ìƒëµí•˜ê²Œ í•´ì¤Œ
await Video.create({
    title,
    description,
    createdAt: Date.now(),
    hashtags: hashtags.split(",").map((word) => `#${word}`),
    meta: {
      views: 0,
      rating: 0,
    },
  });

```

- [save(),create()](https://mongoosejs.com/docs/documents.html) documnet.save() ,model.create()
- modelê³¼ documentì˜ ì°¨ì´, ë‚´ê°€ ìƒê°í•˜ê¸°ë¡  modelì€ ë¹µí‹€ì´ê³ , documnetëŠ” ë¹µì´ë‹¤.
- ê·¸ëŸ°ë‹¤ìŒ moogo shell ì—ê°€ì„œ show dbsë¥¼ í•˜ë©´ wetubeë¼ëŠ” ì¹´í…Œë¡œê¸°ì— ìƒê¸´ê²ƒì„ ì•Œìˆ˜ìˆë‹¤.(ì €ì¥ë˜ì—ˆë‹¤ëŠ” ì˜ë¯¸ì„).
- show dbs -> use wetube -> show collections(docì˜ ë¬¶ìŒ) -> db.videos.find() --->helpì¹˜ë©´ ëª…ë ¹ì–´ë“¤ ë‚˜ì˜´
- ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”ë°©ë²•-> ì•„ì˜ˆ ì‚­ì œì‹œí‚¤ëŠ”ë²•
  > How to reset DB
  > on cmd(console), enter mongo ,use dbName; , db.dropDatabase();

<br>

### Video.js

```js
//Video.js
const videoSchema = new mongoose.Schema({
  title: { type: String, required: true },
  description: { type: String, required: true },
  createdAt: { type: Date, required: true, default: Date.now },
  hashtags: [{ type: String }],
  meta: {
    views: { type: Number, default: 0, required: true },
    rating: { type: Number, default: 0, required: true },
  },
});
```

- [ìŠ¤í‚¤ë§ˆì˜µì…˜ë“¤](https://mongoosejs.com/docs/schematypes.html) + maxlengthë¥¼ ì„¤ì •í• ë•Œ upload.pugíŒŒì¼(ì‚¬ìš©ìë¥¼ ìœ„í•œ)ê³¼ Video.jsíŒŒì¼ ë‘˜ë‹¤ ì„¤ì •ì„ í•´ì£¼ì–´ì•¼í•œë‹¤. pugíŒŒì¼ì€ì™œ í•˜ëƒë©´ ê·¸ëƒ¥ htmlíƒœê·¸ë¥¼ ì‚­ì œ ì‹œì¼œì„œ ì œí•œì„ í’€ì–´ë²„ë¦´ìˆ˜ìˆê¸°ë•Œë¬¸ì´ë‹¤.
- required : ê¼­ í•„ìš”í•˜ë‹¤. date.nowì—ì„œ ê´„í˜¸ê°€ ì—†ëŠ”ê²½ìš°, ()ê°€ ìˆìœ¼ë©´ ë°”ë¡œì‹¤í–‰ë˜ê¸°ë•Œë¬¸ì— ë¶ˆë €ì„ ë•Œ ì‹¤í–‰ì‹œí‚¤ê²Œ í•˜ê¸°ìœ„í•´ì„œ.
- defaultê°’ì„ ì§€ì •í•˜ë©´ ë”°ë¡œ docë¥¼ ë§Œë“¤ë•Œ ë‚´ê°€ ê°’ì„ ë„£ì§€ ì•Šì•„ë„ ìë™ìœ¼ë¡œ ë””í´íŠ¸ê°’ìœ¼ë¡œ ì§€ì •í•´ì¤€ë‹¤. ì´ëŸ°ì‹ìœ¼ë¡œ defaultê°’ì„ ì§€ì •í•˜ë©´, ì½”ë“œë¥¼ ì¢€ë” ì¤„ì—¬ë‚˜ê°ˆìˆ˜ìˆë‹¤.

<br>

### exec()

```js
export const watch = async (req, res) => {
  const { id } = req.params;
  const video = await Video.findById(id).exec();
  return res.render("watch", { pageTitle: `Watching`, video });
};
```

- exec() : promiseë¥¼ ë¦¬í„´í•´ì£¼ëŠ”ê²ƒì¸ë° async % await ë¥¼ ì“°ê³ ìˆì–´ì„œ ì‹ ê²½ì•ˆì¨ë„ëœë‹¤.

<br>

### ë‚´ê°€ ì°¾ëŠ” videoê°€ ì—†ì„ ê²½ìš°

```js
// videoController.js
export const watch = async (req, res) => {
  const { id } = req.params;
  const video = await Video.findById(id);
  if (!video) {
    // ë¨¼ì € ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•´ì¤€ë‹¤. 404.pugë¥¼ ë§Œë“¤ì–´ ì²˜ë¦¬í•´ì¤Œ. dbì—ì„œ ì˜¤ë¥˜ê°€ ë‚˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ê·¸ëƒ¥ ì—†ì–´ì„œ ê·¸ëŸ°ê±°ê¸°ë•Œë¬¸ì— try catchë¬¸ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì•„ë‹Œë“¯.
    return res.renser("404", { pagetitle: "Video no found." });
  }
  return res.render("watch", { pageTitle: video.title, video });
};
```

<br>

### .join() startWith()

```js
// edit.pug
// ìˆ˜ì •ì„ í• ê±´ë° ìˆ˜ì •í• ì¹¸ì— valueë¥¼ ì§€ì •í•´ì£¼ê³  ì‹¶ë‹¤.(ì›ë˜ ì›ë³¸ê°’ì„ ë„£ì–´ë†“ê³ ì‹¶ë‹¤.)
// ê·¸ëŸ°ë° video.jastagsì¶œë ¥í•´ë³´ë©´ ë°°ì—´ì´ê¸°ë•Œë¬¸ì— ë°°ì—´í˜•íƒœë¡œ ë‚˜ì˜¤ëŠ”ë° ê·¸ë°°ì—´ì„ í˜•íƒœë¥¼ ë°”ê¿”ì£¼ê¸° ìœ„í•´ join()ì‚¬ìš©í•œë‹¤.
input(
  (placeholder = "Hashtags, separated by comma."),
  required,
  (type = "text"),
  (name = "hashtags"),
  (value = video.hashtags.join())
);

/// videoController.js
video.hashtags = hashtags
  .split(",")
  .map((word) => (word.startsWith("#") ? word : `#${word}`));
await video.save();
```

- [join()](https://www.codingfactory.net/10450) : ë°°ì—´ì˜ ì›ì†Œë¥¼ ì—°ê²°í•˜ì—¬ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ë§Œë“¤ê¸°
- [startWith("#")](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith) : ì–´ë–¤ ë¬¸ìì—´ì´ íŠ¹ì • ë¬¸ìë¡œ ì‹œì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ì—¬ ê²°ê³¼ë¥¼ true í˜¹ì€ falseë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

<br>

### moonse, Video.exists(), Video.findByIdAndUpdate()

```js
// exists() ê°ì²´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ì•Šê³ , ê·¸ ë°ì´í„°ê°€ ì¡´ì¬í•˜ëŠ”ì§€ë§Œ í™•ì¸í•˜ì—¬ true falseë¥¼ ë¦¬í„´.
const video = await Video.findById(id);
const video = await Video.exists({ _id: id });
// findByIdAndUpdate() ì°¾ì€ê³¼ ë™ì‹œì— ì—…ë°ì´íŠ¸ë¥¼ í•´ì¤€ë‹¤.
await Video.findByIdAndUpdate(id, {
  title,
  description,
  hashtags: hashtags
    .split(",")
    .map((word) => (word.startsWith("#") ? word : `#${word}`)),
});
```

- ê³µì‹ë¬¸ì„œì—ì„œ ë©”ì„œë“œë“¤ì˜ ê¸°ëŠ¥ë“¤ì„ ë³´ë©´ì„œ ì–´ë–»ê²Œí•´ì•¼ ë‚´ ì½”ë“œì— ì˜ ì“¸ìˆ˜ìˆëŠ”ì§€ ì˜ ì‚´í´ë³´ëŠ”ê²Œ ì¤‘ìš”í•œë“¯.
- videoì™€ VideoëŠ” ì°¨ì´ê°€ìˆë‹¤. videoì€ ë°ì´í„°ë¥¼ ë‹´ì€ ê°ì²´ì´ê³ , VideoëŠ” ëª¨ë¸ì´ë‹¤.

<br>

### monose Middleware

- express Middlewareì²˜ëŸ¼ ì¤‘ê°„ì— ê·¸ëƒ¥ ì–´ë–¤ê²ƒì„ í•˜ê¸°ìœ„í•´ ë„£ëŠ”ê²ƒì´ë‹¤. ì—¬ë¼ê°€ì§€ë°©ë©´ìœ¼ë¡œ ì“°ì¼ìˆ˜ìˆë‹¤.
- ìœ„ì˜ hashtagsë¥¼ ë³´ë©´ stringìœ¼ë¡œ ë„˜ì–´ì˜¨ê²ƒì„ arrayë¡œ ë°”ê¿”ì£¼ê¸°ìœ„í•´ ì €ë ‡ê²Œ í•˜ê³ ìˆëŠ”ë° ì €ê²ƒì„ ì—†ì• ê¸° ìœ„í•´ì„œ Middlewareë¥¼ ì‚¬ìš©í•œë‹¤.

```js
//Video.js
videoSchema.pre("save", async function () {
  this.hashtags = this.hashtags[0]
    .split(",")
    .map((word) => (word.startsWith("#") ? word : `#${word}`));
});
```

- [ê³µì‹ë¬¸ì„œ](https://mongoosejs.com/docs/middleware.html)

### static function

- [ê³µì‹ë¬¸ì„œ](https://mongoosejs.com/docs/guide.html)
- ìœ„ì— ì²˜ëŸ¼ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•´ì„œ ì²˜ë¦¬ë¥¼ í• ìˆ˜ë„ìˆì§€ë§Œ, Video.createì²˜ëŸ¼ ë‚´ê°€ ì§ì ‘ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ì“¸ìˆ˜ë„ ìˆë‹¤. modelì— í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ëŠ”ê²ƒì´ë‹¤.

<br>

### search ë¶€ë¶„ ë§Œë“¤ê¸° - req.bodyì™€ req.query

- GET ê³¼ POST ëŠ” HTTP ë©”ì„œë“œë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë¬´ì–¸ê°€ë¥¼ ìš”ì²­í•  ë•Œ ì‚¬ìš©í•œë‹¤.
- postì™€ getì˜ì°¨ì´ [Link](https://noahlogs.tistory.com/35) GETì„ í†µí•œ ìš”ì²­ì€ URL ì£¼ì†Œ ëì— íŒŒë¼ë¯¸í„°ë¡œ í¬í•¨ë˜ì–´ ì „ì†¡ë˜ë©°, ì´ ë¶€ë¶„ì„ ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ (query string) ì´ë¼ê³  ë¶€ë¥¸ë‹¤.
  (ì´ ê²Œì‹œë¬¼ ì˜í™•ì¸í•´ë´ì•¼í• ë“¯ ê¸°ì´ˆì— ëŒ€í•´ ë§ì´ìˆëŠ”ë“¯? HTTPì— ëŒ€í•´ì„œ ë§ì´ ê³µë¶€í•´ë´ì•¼í• ë“¯.)
- getì„ í†µí•´ì„œ searchë¥¼ ë§Œë“ ë‹¤.
- req.bodyëŠ” postë¡œ ë³´ë‚´ë©´ bodyì— ë‚´ìš©ì´ ì‹¤ë¦°ë‹¤.
- req.queryëŠ” URLì— ì‹¤ë¦° ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê² ë‹¤.

<br>

### search ë¶€ë¶„ ë§Œë“¤ê¸° - regular Expreesionì„ ì´ìš©í•œ êµ¬í˜„

- regular expressionì„ ì´ìš©í•´ ë‚´ ì¿¼ë¦¬ì— ì˜µì…˜ì„ ì¶”ê°€í• ìˆ˜ ìˆë‹¤. mongooseê°€ ì•„ë‹ˆë¼ mongodbê°€ í•´ì£¼ëŠ” ê²ƒì´ë‹¤.
- ê²€ìƒ‰í‚¤ì›Œë“œ : mongoose find regular expreesion [stackoverflow](https://stackoverflow.com/questions/9824010/mongoose-js-find-user-by-username-like-value) [Link](https://lunker91.tistory.com/entry/Mongoose-regex-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0)
- ê²€ìƒ‰í‚¤ì›Œë“œ : mongoose regular expression ìƒì„±ì, Regular expression ìƒì„±ìëŠ” jsì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. [Link](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/RegExp)
- jsì—ì„œ $ ì˜ë¯¸ : [Link](https://eotkd4791.github.io/javascript/JavaScript15/) document.getElementById() ì˜ ì¤„ì„ë§ë¡œì“°ì¸ë‹¤.

```js
// ì—¬ê¸°ì„œ ì™œ @regexë¥¼ í–ˆì„ê¹Œ?
videos = await Video.find({
  title: {
    $regex: new RegExp(keword, "i"),
  },
});
// ê·¸ëƒ¥ ë°”ë¡œì´ë ‡ê²Œí•˜ë©´ë˜ëŠ”ë°
videos = await Video.find({
      title: new RegExp(keyword, "i"),
    }),

// findì˜ ê³µì‹ë¬¸ì„œë¥¼ ë³´ë‹ˆ, parameterì— mongodb selectorë¼ê³  í•˜ëŠ”ë° ì¶”ì¸¡í•´ë³¸ê²ƒìœ¼ë¡œ, mongodbì—ì„œ ì“°ëŠ” ë°©ì‹ì„ ê·¸ëŒ€ë¡œ ì“¸ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì¸ê±° ê°™ë‹¤. ê·¸ë˜ì„œ ì¶”ì¸¡í•˜ê±´ë°, jsì™€ mongodbë¥¼ ì„ì–´ì„œ ì“´ê±°ê°™ë‹¤.
// ì—¬ê¸°ì„œ ê¹¨ë‹¬ì€ì ì€ ê³µì‹ë¬¸ì„œë¥¼ ê¼¼ê¼¼íˆ ì½ëŠ”ê²Œ ì¤‘ìš”í•œê±°ê°™ë‹¤.(parameter ë“±ë“±.)
title: {
        $regex: keyword, $options: "i"
  }

```

- $regexë¥¼ ì™œ í•´ì¤€ê²ƒì¼ê¹Œ? ê·¸ëƒ¥ ìƒëµí•´ë„ë í…ë°, ë¬´ìŠ¨ ì˜ë¯¸ì¸ì§€ ì°¾ê¸° í˜ë“¤ë‹¤. ->[Link](https://docs.mongodb.com/manual/reference/operator/query/regex/#examples) mongodbì—ì„œ ì“°ì´ëŠ” ê²ƒì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜¨ë“¯í•˜ë‹¤.
  <br>

* ê²€ìƒ‰í‚¤ì›Œë“œ : mongodb ë‹¨ì–´ë§Œ í¬í•¨ë˜ë„ [Link](https://whitenode.tistory.com/entry/mongodb%EC%97%90%EC%84%9C-%EB%AC%B8%EC%9E%90%EC%97%B4-%EA%B2%80%EC%83%89-%EC%BF%BC%EB%A6%AC)

- [Model.find()](https://mongoosejs.com/docs/api/model.html#model_Model.find)ë¥¼ ë³´ë©´
  filter ë¶€ë¶„ì˜ ì˜ˆì‹œë¥¼ ë³´ë©´ $gte: 18 ì´ëŸ°ê²Œ ìˆëŠ”ë° ì´ê²Œ ë­ì§€í•˜ê³  ê²€ìƒ‰ -> [mongodb ì¿¼ë¦¬ì˜µì…˜](https://fors.tistory.com/403) ì´ë¼ëŠ” ê²ƒì„ ì•Œìˆ˜ìˆë‹¤. -> ì•„ í•„í„°ë¶€ë¶„ì— mongodbì²˜ëŸ¼ ì¨ë„ ë˜êµ¬ë‚˜ ë¼ëŠ”ê²ƒì„ ì•Œìˆ˜ìˆë‹¤. -> ê·¸ëŸ¬ë©´ mongodbì— í•„í„°ë¶€ë¶„ì— ìˆëŠ” ë‹¤ë¥¸ê²ƒë“¤ì„ ì¨ë„ë˜ê²Ÿêµ¬ë‚˜. ì´ëŸ°ì‹ìœ¼ë¡œ ì •ë¦¬í•˜ë©´ì„œ í•´ì•¼í• ë“¯.

```js
// ê·¸ë˜ì„œ mongodbì— ìˆëŠ” orì´ë¼ëŠ” ì˜µì…˜ë„ ì¨ë³´ì•—ë‹¤.
const exists = await User.exists({ $or: [{ username }, { email }] });
```

- ì¿¼ë¦¬ ë…¼ë¦¬ì—°ì‚°ì ë¹„êµì—°ì‚°ì [Link](https://www.zerocho.com/category/MongoDB/post/57a17d114105f0a03bc55f74) ê²€ìƒ‰í‚¤ì›Œë“œ : mongodb ë‘ê°œì¤‘ í•˜ë‚˜ë§Œ -> ë‚˜ì¤‘ì—ëŠ” ë…¼ë¦¬ì—°ì‚°ì ë¹„êµì—°ì‚°ì ê°™ì€ ë‹¨ì–´ë¥¼ ì¨ì•¼í• ë“¯ ì‹¶ë‹¤.
- ë¬´ì—‡ì¸ê°€ ì •ê·œí‘œí˜„ì‹ì— ëŒ€í•œ ì´í•´ê°€ ì‚´ì§ ë–¨ì–´ì§„ë‹¤ ë‚´ì¼ ë‹¤ì‹œ ê²€ìƒ‰í•´ë´ì•¼ê²Ÿë‹¤. ë¬¸ìì—´ì²˜ë¦¬í•˜ëŠ”ë°, ê·¸ ì¡°ê±´ì— í•´ë‹¹ë˜ë©´ ë¬´ì¡°ê±´ ê·¸ ê°’ ì „ì²´ë¥¼ ë¦¬í„´?í•˜ëŠ”ëŠë‚Œ.

<br>

### passwordë¥¼ DBì— ì €ì¥í• ë•Œ, ì•”í˜¸í™”í•´ì•¼í•œë‹¤. í•´ì‹±(hashing)

- ê·¸ëƒ¥ ì €ì¥í•˜ë©´ ì•ˆëœë‹¤.
- í•´ì‹±(hashing) : ì¼ë°©í–¥í•¨ìˆ˜ë¼ ì ˆëŒ€ ë˜ëŒë¦´ìˆ˜ ì—†ë‹¤. ì…ë ¥ì„ í•˜ë©´ ì¶œë ¥ê°’ì´ ë‚˜ì˜¤ëŠ”ë° ì¶œë ¥ê°’ì„ ê°€ì§€ê³  ì…ë ¥ê°’ì„ ì•Œìˆ˜ê°€ ì—†ë‹¤. -> ì´ëŸ°ê±¸ ì»´í“¨í„°ê³¼í•™ì—ì„œ deterministic function(ê²°ì •ì  í•¨ìˆ˜)ë¼ê³  í•œë‹¤. í•­ìƒ ë˜‘ê°™ì´ ë‚˜ì˜¤ë‹ˆê¹Œ
- í•´ì‹±ì„ í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ [bcrype](https://www.npmjs.com/package/bcrypt) , rainbow tableì— ì˜í•œ ê³µê²©ì„ ë§‰ì•„ì¤€ë‹¤. í•´ì‹±ë¿ë§Œì•„ë‹ˆë¼ compareë„ í•´ì¤€ë‹¤.
- ë¬´ì—‡ì¸ê°€ ì–´ë–¤í•„ìš”í•œ ê¸°ëŠ¥ì„ í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì°¾ì„ë•Œ, jsê°€ ê¸°ë°˜ì´ì•„ë‹ˆë¼, ì„œë²„ê°€ ê¸°ë°˜ì´ì–´ì•¼í•˜ëŠ”ë“¯? ë¬´ì—‡ì´ baseì´ ì¸ì§€ ì˜ ì•Œì•„ì•¼í• ê±°ê°™ë‹¤. nodejsì— ì´ê²ƒì €ê²ƒ ë¶™ì—¬ì„œ ì“°ëŠ”ê±°ë‹ˆê¹Œ.

<br>

### status code (HTTP ì¤‘ìš”ê°œë…)

- ê³„ì •ìƒì„±ì„ í…ŒìŠ¤íŠ¸í• ë•Œ postë¡œ usrenameê³¼ passwordê°€ 200ìœ¼ë¡œ ì‘ë‹µì„í•œë‹¤ë©´, ìë™ìœ¼ë¡œ ë¸Œë¼ìš°ì €ì—ì„œ ì•„ì´ë””ë¥¼ ì €ì¥í•œë‹¤. í•˜ì§€ë§Œ ë‚˜ëŠ” ì´ë©”ì¼ì´ ê²¹ì³ì§„ìƒíƒœì´ê¸°ë•Œë¬¸ì— ê³„ì •ì´ ìƒì„±ì´ ì•ˆë˜ëŠ” ìƒí™©ì´ë¼ì„œ ì €ì¥í•˜ë©´ì•ˆëœë‹¤. ì´ë¶€ë¶„ì„ ì²˜ë¦¬í•´ì¤„ê²ƒì´ë‹¤.
- [HTTP status code](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes)
- 400 -> bad request
- ì•Œë§ì€ ìƒíƒœì½”ë“œë¥¼ ë³´ë‚´ëŠ”ê²ƒì€ ì¤‘ìš”í•˜ë‹¤. ì›¹ì‚¬ì´íŠ¸ì˜ íˆìŠ¤í† ë¦¬ë¥¼ ì €ì¥í•˜ëŠ”ë°, 200(ì •ìƒ)ì´ ëœ¨ë©´ ë¬´ì¡°ê±´ íˆìŠ¤í† ë¦¬ì— ì €ì¥í•˜ê¸°ë•Œë¬¸ì´ë‹¤. ë¸Œë¼ìš°ì €ì—ê²Œ ìƒí™©ì„ ì•Œë ¤ì¤˜ì•¼í•œë‹¤.
- [stackoverflow](https://stackoverflow.com/questions/6959017/tell-web-browser-that-login-failed-so-it-doesnt-ask-to-remember-the-password) ë‚˜ë‘ë˜‘ê°™ì€ ë¬¸ì œë¥¼ ê²ªê³ ìˆë‹¤.

<br>

### ì¿ í‚¤ cookie , session

- [ì¿ í‚¤ì™€ ì„¸ì…˜](https://interconnection.tistory.com/74) ë‘˜ë‹¤ idê°’ì„ ê°€ì§€ê³ ìˆëŠ”ê²ƒì¸ë°, ì •ë³´ë¥¼ ê°€ì§€ê³ ìˆëŠ” ì£¼ì²´ê°€ ì„œë²„ì¸ê°€ í´ë¼ì´ì–¸íŠ¸ì¸ê°€ì˜ ì°¨ì´ì´ë‹¤. ë¸Œë¼ìš°ì €ë¥¼ êµ¬ë³„í•˜ê¸° ìœ„í•œ idì´ë‹¤. ì¿ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ ì–´ë–¤ ë¸Œë¼ìš°ì €ë¥¼ ìœ„í•œ session idì¸ì§€ ì•Œìˆ˜ì‡ë‹¤. ex)ë¡œê·¸ì¸ ê³„ì†ìœ ì§€

- [express-session](https://ocsusu.tistory.com/55) +[Link](https://velopert.com/406):
  express-session ì€ Express í”„ë ˆì„ì›Œí¬ì—ì„œ ì„¸ì…˜ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ë¯¸ë“¤ì›¨ì–´, ì•Œì•„ì„œ ì„¸ì…˜ì„ ë§Œë“¤ì–´ì¤€ë‹¤. (express session npm ì‚¬ì´íŠ¸ì˜ noteë¥¼ ì‚´í´ë³´ë©´ ì¢‹ì„ë“¯.)
- ì„¸ì…˜ì—ë‹¤ê°€ ì •ë³´ë¥¼ ë‹´ì„ìˆ˜ ìˆë‹¤ëŠ” ì‚¬ì‹¤ì´ ì¤‘ìš”., ì„¸ì…˜ì´ ì˜¤ë¸Œì íŠ¸ í˜•ì‹ìœ¼ë¡œ ì €ì¥ë˜ì„œ, req.session.potato += 1; ì´ëŸ°ì‹ìœ¼ë¡œ ê°€ëŠ¥í•˜ë‹¤.
- ë”°ë¡œ ì•„ì§ ì²˜ë¦¬ë¥¼ ì•ˆí•´ì¤˜ì„œ, ì„œë²„ë¥¼ê»ë‹¤í‚¤ë©´ ë‹¤ ì‚¬ë¼ì§„ë‹¤. -> ë‚˜ì¤‘ì— ê¸°ì–µí• ìˆ˜ìˆê²Œ DBì— ì €ì¥í• ê²ƒì´ë‹¤.
- Session store : ìš°ë¦¬ê°€ sessionì„ ì €ì¥í•˜ëŠ”ê³³ì´ë‹¤. req.sessionStore, sessionstoreì— ëª¨ë“  ì„¸ì…˜ì´ ì €ì¥ëŒ.

<br>

### ì„¸ì…˜ì„ ë‹¤ë¥¸í˜ì´ì§€ì—ë„ ì „ë‹¬í•˜ê¸° - Logged In User part Two(ë¡œê·¸ì¸ëœ ìœ ì €)

- console.log(res) -> localsë¥¼ ë¹„ì–´ìˆëŠ” objectë¥¼ ë°œê²¬í• ìˆ˜ìˆë‹¤. ì´ê²ƒì„ ê°€ì§€ê³  templatesì™€ dataë¥¼ ê³µìœ í• ìˆ˜ìˆë‹¤. globalì´ë¼ì„œ ë‹¤ë¥¸ í…œí”Œë¦¿ì—ì„œë„ ì“¸ìˆ˜ìˆë‹¤.(locals objectëŠ” ì´ë¯¸ ëª¨ë“  pug templateì— importëœ objectì´ë‹¤.) -> res.renderë¡œ ë„˜ê²¨ì£¼ì§€ì•Šì•„ë„ëœë‹¤.
- pugíŒŒì¼ì´ locals objectì— ê·¸ëƒ¥ì ‘ê·¼í• ìˆ˜ìˆë‹¤.(localsì€ ìë™ì ìœ¼ë¡œ viewsë¡œ importëœë‹¤.)) -> ì´ê²ƒì„ ê°€ì§€ê³  loggedê¸°ëŠ¥ì„ êµ¬í˜„!
- [locals](https://darrengwon.tistory.com/487)

<br>

### sessionì— ëŒ€í•œ ê¶ê¸ˆì , ì™œ req.sessionì¸ê°€ + res.locals

```js
// ì´ëª¨ë“ ê²Œ ìƒˆë¡œê³ ì¹¨í•œë²ˆí• ë•Œë§ˆë‹¤ ìœ„ì—ì„œ ì•„ë˜ê¹Œì§€ ì½”ë“œë¥¼ í™ê³ ê°„ë‹¤ê³  ìƒê°í•´ì•¼ëŒ.
// ë¸Œë¼ìš°ì €ë‘ ì„œë²„ë‘ ë”°ë¡œ ìƒê°í•´ì•¼ëŒ.
// server.js
app.use(
  // ë¨¼ì € ì„¸ì…˜idë¥¼ í• ë‹¹, ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ì§„í–‰. ì„¸ì…˜ì´ê¸°ë•Œë¬¸ì— ë°ì´í„°ëŠ” ì„œë²„ì—ì„œê´€ë¦¬í•¨. ë¸Œë¼ìš°ì €ì— ì €ì¥ë˜ì§€ì•ŠìŒ. sessionstoreì— ëª¨ë“  ì„¸ì…˜(ì„œë²„)ì´ ì €ì¥ëŒ.
  session({
    secret: "Hello!",
    resave: true,
    saveUninitialized: true,
  })
);

app.use(localsMiddleware);
app.use("/", rootRouter);
app.use("/videos", videoRouter);
app.use("/users", userRouter);

//userController.js  postEdit
// ì„¸ì…˜ userë¥¼ ë³´ë‚´ì•¼í•˜ëŠ”ë° ì™œ  requestì— ì €ì¥í•˜ëŠ”ê±¸ê¹Œ? ë‹µì€ ì•„ë˜ì— ì ì–´ë†“ìŒ.
export const postLogin = async (req, res) => {
  ....
  //session idì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ê°€ ì €ì¥ë˜ëŠ”ê±°ì„. ì„¸ì…˜ë§ˆë‹¤ ë‹¤ë¥´ë‹¤ëŠ” ì‚¬ì‹¤ì´ ì¤‘ìš”.
req.session.loogedIn = true;
req.session.user = user;
return res.redirect("/"); //í™ˆìœ¼ë¡œ ì´ë™í•œìˆœê°„ ë˜ ìƒˆë¡œê³ ì¹¨ì´ ë˜ëŠ”ê±°ì„(ì½”ë“œëŠ” ìœ„ì—ì„œë¶€í„° ì•„ë˜ë¡œì½ìŒ)
}

// middlewares.js
export const localsMiddleware = (req, res, next) => {
  res.locals.loggedIn = Boolean(req.session.loggedIn);
  res.locals.siteName = "Wetube";
  res.locals.loggedInuser = req.session.user;
  next(); // ì´ í•¨ìˆ˜ë§Œ ì‹¤í–‰í•˜ê²Œ ì•„ë‹ˆê¸°ë•Œë¬¸ì´ê³  ë’¤ì—ë„ app.useê°€ ìˆê¸°ë•Œë¬¸ì´ë‹¤.
};
```

- sessionì€ ì„œë²„ì—ì„œ ê´€ë¦¬í•˜ê¸°ë•Œë¬¸ì—, ìƒˆë¡œê³ ì¹¨í•˜ì—¬ë„ ì‚¬ë¼ì§€ì§€ì•ŠëŠ”ë‹¤.(ë”°ë¡œ dbì— ì²˜ë¦¬ì•ˆí•´ì£¼ë©´ ì„œë²„ê°€ êº¼ì§€ë©´ ì‚¬ë¼ì§„ë‹¤. ë©”ëª¨ë¦¬ì— ì„ì‹œì €ì¥ë˜ì–´ìˆê¸°ë•Œë¬¸ì—) ì„¸ì…˜idë§Œ ë™ì¼í•˜ë‹¤ë©´ ê·¸ ì„¸ì…˜ì„ ë‹¤ì‹œ ì‚¬ìš©í• ìˆ˜ìˆë‹¤. -> ì €ì¥ì„ ìœ„í•´ req.sessionì„ ì‚¬ìš©í•œë‹¤.(req.sessionstoreì— ëª¨ë‘ì €ì¥ë˜ì–´ìˆë‹¤.)
- resëŠ” ë”± ë­”ê°€ ë°ì´í„°ë¥¼ ë³´ë‚¼ë•Œë§Œ ì‚¬ìš©í•œë‹¤.
- í…œí”Œë ›ì—ì„œë„ ë°ì´í„°ë¥¼ ì“¸ìˆ˜ìˆê²Œ res.localsì´ìš©í•œë‹¤. [res.locals í™œìš©í•˜ì—¬ ì „ì—­ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ë³€ìˆ˜ ë§Œë“¤ê¸°](https://darrengwon.tistory.com/487)

<br>

### connect-mongo

- sessionì„ dbì— ì €ì¥í•˜ê¸°ìœ„í•¨.
- [express-session](https://www.npmjs.com/package/express-session)ì˜ wariningì„ ì‚´í´ë³´ë©´ session strorageëŠ” MemoryStore, is purposely not designed for a production environment.(ê·¸ëƒ¥ì„ì‹œì ìœ¼ë¡œ ë©”ëª¨ë¦¬ìŠ¤í† ì–´ì— ì €ì¥.)
- [Compatible Session Stores](https://www.npmjs.com/package/express-session#compatible-session-stores)ì„ ë³´ë©´ connect-mongoê°€ ìˆëŠ”ê±¸ì„ ë³¼ìˆ˜ìˆìŒ.

<br>

### ëª¨ë“  ë°©ë¬¸ìì˜ sessionì„ DBì— ì €ì¥í•œë‹¤ë©´..

- ë¡œê·¸ì¸í•˜ì§€ì•Šì€ ëª¨ë“  ë°©ë¬¸ì(+ ë´‡)ë¥¼ DBì— ì €ì¥í•˜ëŠ”ê²ƒì€ ì¢‹ì§€ ì•Šì€ ìƒê°ì´ë‹¤. ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ ì €ì¥í•˜ë„ë¡ í•˜ì.

```js
app.use(
  session({
    secret: "Hello!",
    resave: false,
    saveUninitialized: false, // ìƒˆë¡œìš´ ì„¸ì…˜ì´ ìˆëŠ”ë°, ìˆ˜ì •ëœ ì ì´ ì—†ì„ ë•Œ.
    // ì´ì„¤ì •ì´ ë¬´ì—‡ì„ í•˜ëŠ”ê±°ëƒë©´, ì„¸ì…˜ì„ ìˆ˜ì •í• ë•Œë§Œ ì„¸ì…˜ì„ DBì— ì €ì¥(userControllerì—ì„œ ìˆ˜ì •í•¨.)í•˜ê³  ì¿ í‚¤ë¥¼ ë„˜ê¸´ë‹¤.
    store: MongoStore.create({ mongoUrl: "mongodb://127.0.0.1:27017/wetube" }),
  })
);
```

<br>

### cookie property Expiration and Secrets

- [expires and max-age](https://ko.javascript.info/cookie) : ìœ íš¨ì¼ìì™€ ë§Œë£Œê¸°ê°„.
- Secrets : DBURLì´ë‚˜, API key, cookie_secretê°™ì€ê²ƒì€ ê³µê°œë˜ì§€ ì•Šê¸°ë•Œë¬¸ì— ë”°ë¡œ íŒŒì¼ì„ ë§Œë“¤ì–´ì¤˜ì„œ ê´€ë¦¬í•œë‹¤. ê´€ìŠµì ìœ¼ë¡œ ë³€ìˆ˜ëª…ì€ ëŒ€ë¬¸ìë¡œ ì‚¬ìš©í•œë‹¤. .gitignoreì— ì¶”ê°€í•´ì¤˜ì„œ ì—…ë¡œë“œ ë˜ì§€ì•Šê²Œí•œë‹¤. [Link](https://sistinafibel.github.io/2019/07/18/Node-%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98%EB%A5%BC-%EA%B4%80%EB%A6%AC%ED%95%98%EB%8A%94-.env%ED%8C%8C%EC%9D%BC-%EB%A7%8C%EB%93%A4%EA%B8%B0.html)
- [dotenv](https://www.npmjs.com/package/dotenv) ì„ í™œìš©í•´ì„œ í™˜ê²½ë³€ìˆ˜ë¥¼ ê´€ë¦¬ í• ê²ƒì´ë‹¤.
  ê°€ì¥ë¨¼ì € í•´ì¤˜ì•¼í•œë‹¤. requireë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©í•˜ëŠ” ëª¨ë“ íŒŒì¼ë§ˆë‹¤ requireì„ ë¶™ì—¬ì¤˜ì•¼í•œë‹¤. importë¥¼ í•˜ë©´ ê·¸ë ‡ê²Œ ì•ˆí•´ë„ëœë‹¤.[Link](https://www.daleseo.com/js-dotenv/)
- ì™œ importí• ë•Œ import "dotenv/config"; ì¼ê¹Œ? configë¼ëŠ” íŒŒì¼ì´ ìˆìŒ ì°¾ì•„ë³´ë‹ˆê¹Œ. ê·¸ë˜ì„œì¸ë“¯.

<br>

### githubë¡œ ë¡œê·¸ì¸ êµ¬í˜„í•˜ê¸°

- [Link](https://tldud2404.tistory.com/41) ìš°ë¦¬ê°€ í• ë ¤ëŠ” ì¼ë ¨ì˜ ê³¼ì •ë“¤ì´ ì •ë§ ì•Œê¸°ì‰½ê²Œ ì •ë¦¬ë˜ì–´ìˆë‹¤.
- [ë¬¸ì„œ](https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps)
- github.com/settings/appsì„ ë“¤ì–´ê°„ë‹¤. OAuth Appsë¥¼ ëˆŒëŸ¬ì¤€ë‹¤.
- íë¦„ì„ ë³´ë©´, githubë¡œê·¸ì¸ì°½ìœ¼ë¡œ ì´ë™ ë¡œê·¸ì¸ -> ì½”ë“œê°’ì„ ë‚´ê°€ì§€ì •í•œ URLë¡œ ë³´ë‚´ì¤Œ(ì½”ë“œê°’ ìš”ì²­ GET) -> ì½”ë“œê°’ì„ ê°€ì§€ê³  githubì— ë‹¤ì‹œë³´ëƒ„(POST) ì—‘ì„¸ìŠ¤í† í°ìœ¼ë¡œ ë°”ê¿ˆ. -> access_tokenìœ¼ë¡œ Github APIë¥¼ ì‚¬ìš©í•´ userì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ê±°ì„.

```js
a(href="https://github.com/login/oauth/authorize?client_id=9fac726866be2ff14f36&allow_signup=false") Continue with Github &rarr;
// ì´ë ‡ê²Œ ê¸´ê²ƒì„ ì¤„ì´ê¸°ìœ„í•´ì„œ ì´ëŸ°ì‹ìœ¼ë¡œ ë§Œë“ ë‹¤.
a(href="/users/github/start") Continue with Github &rarr;
// ì € URLë¡œ ê°€ë©´ startGithubLogin functionì´ ì‹¤í–‰ë˜ê³  redirectí•´ì¤€ë‹¤. ì´ëŸ°ì‹ìœ¼ë¡œ í• ìˆ˜ìˆì„ì§€ ëª°ëë‹¤.

//userController.js
export const startGithubLogin = (req, res) => {
  const baseUrl = "https://github.com/login/oauth/authorize";
  const config = {
    client_id: "710e3bf684d455e2a0df",
    allow_signup: false,
    scope: "read:user user:email",
  };
  const params = new URLSearchParams(config).toString();
  const finalUrl = `${baseurl}?${params}`;
  return res.redirect(finalUrl);
};

```

- GETìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚¼ë•Œ ? & ì´ëŸ° ê²ƒì„ ì“´ë‹¤.
- scope parameterëŠ” ì´ëŸ°ì •ë³´ë¥¼ ì›í•œë‹¤ë¼ëŠ”ê²ƒì„ ì•Œë ¤ì£¼ëŠ” parameterì´ë‹¤.
- [URLê³¼ URLSearchParams](https://www.zerocho.com/category/HTML&DOM/post/5b3ae84fb3dabd001b53b9ab) : URLì˜ êµ¬ì„±ìš”ì†Œì™€ Seacrë¶€ë¶„ì„ ë‹¤ë£¨ëŠ” URLSearchParams(ë¸Œë¼ìš°ì € ì°¨ì›ì—ì„œ ì œê³µ)

```js
export const finishGithubLogin = async (req, res) => {
  // ìœ ì €ê°€ ìŠ¹ì¸í•˜ë©´ /github/finish?code=xxxx ë¼ëŠ” ë§ë¶™ì—¬ì§„ ë‚´ìš©ì„ ë°›ì„ê±°ì„
  // ì´ê²Œ codeëŠ” ìœ ì €ê°€ ìŠ¹ì¸í–ˆë‹¤ê³ ì•Œë ¤ì£¼ëŠ”ê±°ì„. ì´ ì½”ë“œë¥¼ ê°€ì§€ê³  ì—‘ì„¸ìŠ¤í† í°ìš”ì²­.
  const baseUrl = "https://github.com/login/oauth/access_token";
  const config = {
    client_id: process.env.GH_CLIENT,
    client_secret: process.env.GH_SECRET,
    code: req.query.code,
  };
  const params = new URLSearchParams(config).toString();
  const finalUrl = `${baseUrl}?${params}`;
  //ì—‘ì„¸ì„œí† í° ìš”ì²­í›„ .json() ë³€í™˜. ì—‘ì„¸ìŠ¤ í† í° : github APIì™€ ìƒí˜¸ì‘ìš©í• ë•Œ ì“¸ê±°ì„.
  const data = await fetch(finalUrl, {
    method: "POST",
    headers: {
      Accept: "application/json", //jsoní˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë°›ê¸°ìœ„í•¨. ê³µì‹ë¬¸ì„œë¥¼ ë³´ë‹ˆ Accept headerì— ì €ëŸ°ì‹ìœ¼ë¡œ í•˜ë©´ëœë‹¤ê³ í•¨.
    },
  });
  const json = await data.json(); // ë°”ë¡œ ì‚¬ìš©ì„ ëª»í•´ì„œ ë³€í™˜ì‹œì¼œì¤˜ì•¼í•œë‹¤.
  console.log(json);
  res.send(JSON.stringify(json)); // í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë³´ê¸°ìœ„í•´.
};
```

- fetchë€? [Link1](https://itkjspo56.tistory.com/115) then : ì´ ìš”ì²­ ëë‚˜ë©´ ì´ê²ƒì¢€ í•´ì£¼ë¼. [Link2](https://ljtaek2.tistory.com/130) ì„œë²„ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³  ì‘ë‹µì„ ë°›ì„ìˆ˜ìˆë„ë¡í•¨. APIë¥¼ ì‚¬ìš©í• ë•Œ ìì£¼ì“°ëŠ”ë“¯.
- fetchê°€ í•„ìš”í•œë° fetchëŠ” ë¸Œë¼ìš°ì €ì—ë§Œ ì¡´ì¬í•˜ê³ , ì„œë²„ì—” ì—†ì–´ì„œ ë”°ë¡œ ì„¤ì¹˜í•´ì¤˜ì•¼í•œë‹¤.->
  [node-fetch](https://www.npmjs.com/package/node-fetch) -> ìë°”ìŠ¤í¬ë¦½íŠ¸ì™€ Nodejsê°€ ë‹¤ë¥¸ í”Œë«í¼ì´ë¼ëŠ” ê²ƒì„ ì•Œìˆ˜ìˆìŒ.
- [.json()](<https://wooooooak.github.io/javascript/2018/11/25/fetch&json()/>) : // ë°”ë¡œ ì‚¬ìš©ì„ ëª»í•´ì„œ ë³€í™˜ì‹œì¼œì¤˜ì•¼í•œë‹¤.
- [req.queryì™€ req.parmas](https://wooooooak.github.io/web/2018/11/10/req.params-vs-req.query/)

<br>

### Oauthì™€ REST API

- [Oauth](https://showerbugs.github.io/2017-11-16/OAuth-%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C) ë‹¤ë¥¸í”Œë«í¼ìœ¼ë¡œ ë¡œê·¸ì¸í• ìˆ˜ìˆê²Œ ë§Œë“¤ì–´ ì£¼ëŠ” ì‚°ì—… í‘œì¤€ í”„ë¡œí† ì½œ, [ë¬¸ì„œ](https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps)
- [REST API](https://gmlwjd9405.github.io/2018/09/21/rest-and-restful.html) ì»´í“¨í„° í”„ë¡œê·¸ë¨ê°„ ì„œë¡œ ì •ë³´ë¥¼ êµí™˜í• ìˆ˜ìˆê²Œ. [ë¬¸ì„œ](https://docs.github.com/en/rest/reference/users)
- [Oauth](https://tldud2404.tistory.com/41) ë­”ê°€ ì¹œì ˆí•˜ê²Œ ì„¤ëª…ì´ ë˜ì–´ìˆë‹¤.
- client secrets ë‚´ê°€ Oatuh appì„ ì‚¬ìš©í•  ë•Œ ì“°ëŠ” ë¹„ë°€ë²ˆí˜¸ ê°™ì€ê²ƒ.
- Github Login part Five : ë‘ê°œì˜ ê´€ê³„ë¥¼ ìƒê°í•´ë³¸ë‹¤ë©´, Oauthë¥¼ ì´ìš©í•˜ë©´ ë¡œê·¸ì¸í• ë ¤ëŠ” ì‚¬ìš©ìì˜ access tokenì„ ì–»ì„ìˆ˜ ìˆê³ , ê·¸ í† í°ì„ ê°€ì§€ê³  REST APIë¥¼ ì´ìš©í•´ì„œ emailë¥¼ ë°›ì•„ì˜¤ëŠ”ê²ƒì¸ê°€? -> "ì¹œì ˆí•˜ê²Œ ì„¤ëª…ë˜ì–´ìˆë‹¤" ê³³ì— ë§í¬ë¥¼ í´ë¦­í•´ë³´ì•„ë¼.

```js
// userController.js , finishGithubLogin
// privateì•ˆ ê²½ìš° ë³´ì´ì§€ ì•Šì•„ì„œ emailë°ì´í„° REST APIì´ìš©í•´ì„œ ìš”ì²­
const emailData = await (
  await fetch(`${apiUrl}/user/emails`, {
    headers: {
      Authorization: `token ${access_token}`,
    },
  })
).json();
// emaildataì¤‘ primary trueê²ƒê³¼ verifiedê³¼ trueì¸ ê²ƒì„ ìš”ì²­
const email = emailData.find(
  (email) => email.primary === true && email.verified === true
);
if (!email) {
  return res.redirect("/login");
}
```

<br>

### Logout êµ¬í˜„

```js
//   /users/logout ì£¼ì†Œë¡œ ì´ë™í•˜ë©´, ìœ ì €ë¼ìš°í„°ì—ì„œ ë¡œê·¸ì•„ì›ƒì¸ ë¼ìš°í„°ë¡œ ì´ë™í•˜ê³  ì»¨íŠ¸ë¡¤ëŸ¬ì¸ logoutë¥¼ ì‹¤í–‰í•œë‹¤.

//ë§í¬(ì£¼ì†Œ)ë¡œ ì´ë™í•˜ë©´ ê·¸ ì£¼ì†Œì˜ ì»¨íŠ¸ë¡¤ëŸ¬(í•¨ìˆ˜)ê°€ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì„ ì•Œê³ ìˆì–´ì•¼í•œë‹¤.

//userController.js
export const logout = (req, res) => {
  req.session.destroy();
  return res.redirect("/");
};
```

- sessionì„ ì—†ì• ë²„ë ¤ì•¼í•œë‹¤.

<br>

### Edit profileì˜ ë¬¸ì œì 

- loggedInUserì— ì ‘ê·¼í•˜ë ¤ëŠ”ë° ë¡œê·¸ì¸ë˜ì–´ìˆì§€ì•Šìœ¼ë©´ ìƒê¸°ëŠ” ì—ëŸ¬
- ë¡œê·¸ì¸ë¼ ìˆì§€ ì•Šì€ì‚¬ëŒë“¤ì€ ì ‘ê·¼í• ìˆ˜ ì—†ê²Œ ë§Œë“¤ì–´ì•¼í•¨ (/users/edit) -> redirectí•´ì¤˜ì•¼í•¨. ëª‡ëª‡ routeë¥¼ ë³´í˜¸í•´ì£¼ëŠ” middleì„ ë§Œë“¤ì–´ì•¼í•¨.

```js
//middlewares.js
export const protectorMiddleware = (req, res, next) => {
  if (req.session.loggedIn) {
    return next();
  } else {
    return res.redirect("/login");
  }
};
//userRouter.js
userRouter.route("/edit").all(protectorMiddleware).get(getEdit).post(postEdit);
```

### reqì—ì„œ ê°€ì ¸ì˜¨ ë³€ìˆ˜ ìƒˆë¡œìš´ ë³€ìˆ˜ì— ë„£ê¸°.

```js
const {
  session: {
    user: { _id, username: sessionUsername, email: sessionEmail },
  },
  body: { name, email, username, location },
} = req;
```

- ì›ë³¸ì„ ì™¼ìª½ìœ¼ë¡œ ë‘ê³ , ìƒˆë¡œ í• ë‹¹í•˜ëŠ”ê²ƒì„ ì˜¤ë¥¸ ìª½ì— ë‘¬ì•¼í•˜ëŠ”ë“¯.

<br>

### viewsê°€ ì ì  ë§ì•„ì§€ë©´ì„œ ë¶„ë¥˜í•˜ê¸°ìœ„í•´ì„œ..

- views/usersd í´ë”ë¥¼ ë§Œë“¤ì–´ì¤¬ìŒ. extends ../base ì´ëŸ°ì‹ìœ¼ë¡œ í•´ì¤˜ì•¼í•¨. í´ë”ë¥¼ ë“¤ì–´ê°”ê¸°ë•Œë¬¸ì—.

<br>

### íŒŒì¼ì—…ë¡œë“œí•˜ê¸° multer.js

- express.jsì—ì„œ íŒŒì¼ ì—…ë¡œë“œë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë¯¸ë“¤ì›¨ì–´ì¸ [multer](https://www.npmjs.com/package/multer) -> req.fileì— ì ‘ê·¼ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ì„œ ë„˜ê²¨ì¤Œ.

```js
//edit-profile.pug
form(method="POST", enctype="multipart/form-data") // enctype ìš°ë¦¬ formì´ ë‹¤ë¥´ê²Œ encodeë ê±°ë€ ì˜ë¯¸. encoding type
        label(for="avatar") Avatar
        input(type="file", id="avatar", name="avatar", accept="image/*")

//userControoler.js , postEdit() , ì´ëŸ¬í•œ ë¬¸ë²•ë„ ìˆë‹¤.
avatarUrl: file ? file.path : avatarUrl, // ì—…ë¡œë“œí•œ íŒŒì¼ì´ ìˆìœ¼ë©´, file.pathë¥¼ ì§€ì •í•´ì£¼ê³ , ì•„ë‹ˆë©´ ê¸°ì¡´ì— ë¡œê·¸ì¸ë˜ì–´ìˆëŠ”ë° avatarUrlì„ ì§€ì •í•´ì¤€ë‹¤.

// edit-profile.pug , ë§¨ì•ì— /ì„ ë¶™ì—¬ì¤€ì´ìœ  ì•ë¶™ì—¬ì£¼ë©´ ìƒëŒ€ê²½ë¡œê°€ë˜ì„œ ì ˆëŒ€ê²½ë¡œë¡œ ë§Œë“¤ê¸°ìœ„í•´.
img(src="/" + loggedInUser.avatarUrl, width="100", height="100")
// ì´ë ‡ê²Œ ì—ëŸ¬ê°€ ìƒê¸°ëŠ”ë°, ì™œëƒí•˜ë©´ localhost:4000/uploades/avtarUrl ì´ ì—†ê¸°ë•Œë¬¸ì´ë‹¤.  Urlì— ìˆëŠ” ëª¨ë“ ê²ƒë“¤ì´ routerì— ìˆì–´ì•¼í•˜ëŠ”ê²Œ ì—†ì–´ì„œ ê·¸ë ‡ë‹¤. ì´ë¯¸ì§€ë¥¼ ìš”ì²­í•˜ëŠ”ê²ƒë„ urlë¡œ í•˜ëŠ”ê±°ë¼ ê·¸ëŸ°ê°€ë³´ë‹¤.

//middlewares.js , íŒŒì¼ì—…ë¡œë“œë¥¼ ìœ„í•œ ë¯¸ë“¤ì›¨ì–´. ê°ê° ì•„ë°”íƒ€í´ë”ì™€ ë¹„ë””ì˜¤í´ë”ì— ë„£ì„ë ¤ê³ .
export const videoUpload = multer({
  dest: "uploads/videos/",
  limits: {
    fileSize: 10000000,
  },
});

// videoRouter.js
videoRouter
  .route("/upload")
  .all(protectorMiddleware)
  .get(getUpload)
  .post(videoUpload.single("video"), postUpload); //videoUploadëŠ” mideeware.jsì— ìˆëŠ” ë¯¸ë“¤ì›¨ì–´ì´ë‹¤. pathê°€ ì•„ë‹ˆë¼ middlewareì´ë‹¤. +  multerì—ê²Œ íŒŒì¼ì„ ì—¬ê¸°ì— ì €ì¥í•˜ê² ë‹¤ê³  ì•Œë ¤ì£¼ëŠ”ê²ƒì´ë‹¤. ê·¸ë¦¬ê³  postUploadì—ê²Œ íŒŒì¼ì— ëŒ€í•œ ì •ë³´ë¥¼ ë„˜ê²¨ì£¼ê³ , express.jsì˜ app.postì˜ ì¸ìë¥¼ ë³´ë©´ app.post(path, callback [, callback ...])ì¸ë°ã…¡ routerì²˜ë¦¬ë¥¼ í•´ì¤¬ìŒìœ¼ë¡œ, pathì´ ì‚¬ë¼ì§€ê³  ë‚˜ë¨¸ì§€ë¶€ë¶„ì€ ë‹¤ callbackí•¨ìˆ˜ì´ë‹¤. + ê·¸ë¦¬ê³  "multer"ê°€ "req.file"ì„ ì œê³µí•´ì¤€ë‹¤.

```

- [labelíƒœê·¸ë€]? labelì€ í¼ì˜ ì–‘ì‹ì— ì´ë¦„ ë¶™ì´ëŠ” íƒœê·¸, idê°’ì´ ê°™ìœ¼ë©´ ì—°ê²°ëŒ. [label íƒœê·¸ëŠ” ì–‘ì‹ ì…ë ¥ ì°½ì˜ ìš”ì†Œë“¤ì„ ìœ„í•œ ìº¡ì…˜](https://neul-carpediem.tistory.com/266)
- [<input> íƒœê·¸ì˜ accept ì†ì„±](http://tcpschool.com/html-tag-attrs/input-accept) : <input> íƒœê·¸ì˜ accept ì†ì„±ì€ ì„œë²„ë¡œ ì—…ë¡œë“œí•  ìˆ˜ ìˆëŠ” íŒŒì¼ì˜ íƒ€ì…ì„ ëª…ì‹œ
- [enctypeì´ ë­ì•¼?](https://kasterra.github.io/what-is-multipart-form-data/)
- ì£¼ì˜í• ì  : DBì—ëŠ” ì—…ë¡œë“œí•  íŒŒì¼ì˜ ìœ„ì¹˜ë§Œ ì €ì¥í•˜ëŠ”ê²ƒì´ê³  ì‹¤ì œíŒŒì¼ì€ ë‚´ ì»´í“¨í„°ì— ì €ì¥í•˜ëŠ”ê²ƒì´ë‹¤. ì ˆëŒ€ DBì— íŒŒì¼ì €ì¥ì„ í•˜ì§€ì•ŠëŠ”ë‹¤. DBëŠ” ê·¸ëŸ°ìš©ë„ë¡œ ì“°ëŠ”ê²Œì•„ë‹ˆë‹¤. íŒŒì¼ì€ ì•„ë§ˆì¡´ì˜ í•˜ë“œë“œë¼ì´ë¸Œ ê°™ì€ë°ì— ì›ë³¸ì„ ì €ì¥í•˜ë©´ëœë‹¤.
- Expressì—ê²Œ ë§Œì•½ ëˆ„êµ°ê°€ /uploadsë¡œ ê°€ë ¤ê³  í•Ÿë‚˜ë©´, uploadsí´ë”ì˜ ë‚´ìš©ì„ ë³´ì—¬ì£¼ë¼.

<br>

### static, ì´ë¯¸ì§€ë¥¼ ìš”ì²­í•˜ë©´ ì²˜ë¦¬í•´ì¤Œ.

- ê²€ìƒ‰í‚¤ì›Œë“œ express image serve [Link](https://expressjs.com/ko/starter/static-files.html)
- [ì •ì (static) íŒŒì¼ ì„œë¹„ìŠ¤ í•˜ê¸°](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=pjok1122&logNo=221545195520)
- Expressí•œí…Œ ì‚¬ëŒë“¤ì´ ì´ í´ë” ì•ˆì— ìˆëŠ” íŒŒì¼ë“¤ì„ ë³¼ìˆ˜ìˆê²Œ í•´ë‹¬ë¼ê³  ìš”ì²­

```js
//serever.js
app.use("/uploads", express.static("uploads"));
// uploadsê²½ë¡œì— ìš”ì²­í•˜ë©´, uploadsí´ë”ì—ìˆëŠ”ê²ƒì„ ì¤€ë‹¤.
```

<br>

### html video

```js
//watch.pug
video((src = "/" + video.fileUrl), controls);
```

- [Link](https://developer.mozilla.org/ko/docs/Web/HTML/Element/Video) controlsì†ì„±ì„ ì£¼ë©´ ì†Œë¦¬ ì¡°ì ˆ(volume), ë™ì˜ìƒ íƒìƒ‰(seek), ì¼ì‹œ ì •ì§€(pause)/ì¬ì‹œì‘(resume)ì„ í•  ìˆ˜ ìˆëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

<br>

### userì™€ videoë¥¼ ì—°ê²°í•˜ê¸°

- videoì—ê²ŒëŠ” owenrì˜ \_idë¥¼ , userì—ê²ŒëŠ” videoì˜ \_idë¥¼(object id)
- [mongoose populate](https://mongoosejs.com/docs/populate.html)

```js
//Video.js
owner: { type: mongoose.Schema.Types.ObjectId, required: true, ref: "User" },
```

- [ê²€ìƒ‰í‚¤ì›Œë“œ mongoose type obecjectid](https://mongoosejs.com/docs/schematypes.html#objectids) : mongoose.Schema.Types.ObjectIdì— ëŒ€í•˜ì—¬
- [mongoose populate](https://velog.io/@ehgks0000/populate) í•œ ìŠ¤í‚¤ë§ˆì˜ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ ìŠ¤í‚¤ë§ˆì˜ idê°™ì€ê²ƒìœ¼ë¡œ ì§€ì •ì„ í•œë‹¤ë©´, refì™€ populateë¥¼ í†µí•´ findë¥¼ í• ë•Œ ìë™ìœ¼ë¡œ mongooseê°€ ë‹¤ë¥¸ ìŠ¤í‚¤ë§ˆì—ì„œ ì°¾ì€ objectë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ(ì›ë³¸ê·¸ëŒ€ë¡œ) ë„£ì–´ì¤€ë‹¤. populateë¥¼ í•˜ì§€ ì•Šìœ¼ë©´ objectìì²´ë¥¼ ì£¼ì§€ ì•ŠëŠ”ë‹¤.

```js
const video = await Video.findById(id);
const owner = await User.findById(video.owner);
//ìœ—ë¶€ë¶„ì„ ì¤„ì´ê¸° ìœ„í•´ì„œ ì•„ë˜ì™€ ê°™ì€ ê¸°ëŠ¥ì„ ë§Œë“  ë“¯. ë­ê°€ ì¤‘ë³µëœë‹¤ì‹¶ìœ¼ë©´ ê²€ìƒ‰ì„í•´ì„œ ì¤„ì—¬ì•¼í• ë“¯.

const video = await Video.findById(id).populate("owner");
// ì´ë ‡ê²Œí•˜ë©´ videoì—ì„œ ownerë¶€ë¶„ì— ìŠ¤í‚¤ë§ˆ ìƒìœ¼ë¡œëŠ” idë§Œ ë“¤ì–´ê°€ì§€ë§Œ, findë¡œ returní•´ì¤€ ë°ì´í„°ëŠ” idë¿ë§Œì•„ë‹ˆë¼ ì „ì²´ê°€ ë‹¤ ë“¤ì–´ê°„ë‹¤.
```

<br>

### mongoose documentì™€ modelì˜ ì°¨ì´

- [Link](https://mongoosejs.com/docs/documents.html) : modelì€ documentì˜ subclassì´ë‹¤

```js
const MyModel = mongoose.model("Test", new Schema({ name: String }));
const doc = new MyModel();

doc instanceof MyModel; // true
doc instanceof mongoose.Model; // true
doc instanceof mongoose.Document; // true
```

### ë°ì´í„°ë² ì´ìŠ¤(db) ì§€ìš¸ì¼ì´ ìˆì„ë•Œ

```js
mongo
use wetube
db.users.remove({})
db.videos.remove({})
db.sessions.remove({})
```

<br>
<br>
<br>
<br>
<br>
<br>

### front-end, webpack , Sass

- [ê³µì‹](https://webpack.js.org/concepts/#entry)
- [webpack](https://velog.io/@yon3115/%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-%ED%95%84%EC%88%98-Webpack%EC%9D%B4%EB%9E%80) : ëª¨ë“ íŒŒì¼ì„ ëª¨ì•„ì„œ ì••ì¶• ë³€í˜•ì‹œì¼œì¤€ë‹¤.ì¼ì¼íˆ ë”°ë¡œ ë³´ë‚´ë©´ ë°ì´í„°ì ì¸ ë¹„ìš©ì´ ë§ì´ë“¤ê¸°ë•Œë¬¸. ê·¸ê³¼ì •ì—ì„œ ìš°ë¦¬ê°€ ì‘ì„±í•œ ì½”ë“œë“¤ì„ ëª¨ë“  ë¸Œë¼ìš°ì €ê°€ ì´í•´í• ìˆ˜ ìˆëŠ” ì½”ë“œë¡œ ë±‰ì–´ë‚´ì¤€ë‹¤.(ê·¸ë˜ì„œ ES6ë¬¸ë²•ì¸ ì½”ë“œë¥¼ ë¡œë”í•´ì£¼ëŠ” babel-loaderë¥¼ ì“´ë‹¤.)
- ëŒ€ë¶€ë¶„ webpackì„ ì˜ ì•ˆ ì“´ë‹¤. ì´ë¯¸ í¬í•¨ë˜ì–´ ìˆëŠ” íˆ´ì„ ì“´ë‹¤. ëŒ€ë¶€ë¶„ ë¦¬ì—‘íŠ¸ ê°™ì€ê²ƒë“¤ì€ ì´ë¯¸ ë‚´ì¥ë˜ì–´ìˆì–´ì„œ ì§ì ‘ ì‚¬ìš©í•  ì¼ì€ ê±°ì˜ ì—†ë‹¤. ê·¸ë˜ë„ ì—…ê³„í‘œì¤€ì´ë¼ ì•Œì•„ë‘ë©´ ì¢‹ë‹¤.
- webpack clië¥¼ ì´ìš©í•´ì„œ ì½˜ì†”ì—ì„œ webpackì„ ì‚¬ìš©í• ìˆ˜ìˆìŒ.
- webpack.config.js íŒŒì¼ì„ ì¤˜ì•¼ëŒ. webpackì´ ì½ì„(ì´ íŒŒì¼ì„ ì „í™˜ì‹œì¼œë‹¬ë¼ê³  í•˜ëŠ”ê±°ì„.)
- babel-loader : [webpack](https://jeonghwan-kim.github.io/js/2017/05/15/webpack.html)ì— ì“°ì´ëŠ” loader. ES6 ë¬¸ë²•ì„ ES5ë¬¸ë²•ìœ¼ë¡œ
- clientí´ë”ëŠ” ìš°ë¦¬ê°€ ì½”ë”©í•  í´ë”ì´ê³ , assets í´ë”ëŠ” ë¸Œë¼ìš°ì €ê°€ ì ‘ê·¼í•´ì„œ ë³¼ í´ë”ì„.
  ìš°ë¦¬ê°€ webpackì„ ì‹¤í–‰í•˜ë©´(npm run assets) assetsí´ë”ì— ì›¹íŒ©ìœ¼ë¡œ ì²˜ë¦¬ê°€ ëœ í•˜ë‚˜ì˜ íŒŒì¼ì´ ë§Œë“¤ì–´ì§„ë‹¤.(ìª¼ê°¤ìˆ˜ë„ ìˆë‹¤.)
- assetsí´ë”ì— ì›¹íŒ©ìœ¼ë¡œ ì²˜ë¦¬ëœ í”„ë¡ íŠ¸ì—”ë“œì˜ js,scssíŒŒì¼ë“±ì´ ìˆìŒ.
- assetsí´ë”ê°€ ìˆëŠ”ì§€ expressëŠ” ëª¨ë¥´ê¸°ë•Œë¬¸ì— ì•Œë ¤ì¤˜ì•¼ëŒ. -> cssíŒŒì¼ì„ ìš”êµ¬í•œë‹¤. (base.pugì—ì„œ ìš”ì²­í•˜ëŠ”ê²ƒì„ ë³¼ìˆ˜ìˆìŒ.)
- [Multiple Entry Points](https://webpack.js.org/concepts/output/#multiple-entry-points) ë‚´ê°€ ìª¼ê°  jsíŒŒì¼ë§ˆë‹¤ assetsí´ë”ì— ê°ê° ìª¼ê°œì§„ ìƒíƒœë¡œ ë„£ê¸°. ê²€ìƒ‰í‚¤ì›Œë“œ : express webpack output filename differently
- í”„ë¡ íŠ¸ì—”ë“œì— jsíŒŒì¼ì„ ì¶”ê°€í• ë•Œë§ˆë‹¤(client/js/) webpackì—ë„ ì•Œë ¤ì¤˜ì•¼ëŒ. ê·¸ë˜ë´ ì¸ì‹í•¨.

```js
app.use("/static", express.static("assets")); // ì•ì—ìˆëŠ” ì¸ìëŠ” ê·¸ëƒ¥ ì ‘ê·¼í•˜ê¸°ìœ„í•œ ê²ƒì´ê³ , ì‹¤ì œ í´ë”ëª…ì€ ë‹¤ë¥¼ìˆ˜ìˆë‹¤.
```

<br>

# ì¤‘ìš”í•œ ì§ˆë¬¸, ë¦¬ì•¡íŠ¸ì™€ pugì˜ ì°¨ì¼ì´ ë¬´ì—‡ì´ëƒ?

- ë¦¬ì•¡íŠ¸ì™€ pugì˜ ì°¨ì´ëŠ”? [Link](https://www.inflearn.com/questions/72824) ì¢‹ì€ê¸€ì´ë‹¤.
- webpackì´ ì˜ ì´í•´ê°€ ê°€ì§€ì•ŠëŠ”ë‹¤. íŒŒì¼ì„ ë³€í˜•ì‹œì¼œì„œ í†µí•©ì‹œí‚¤ëŠ”ê±°ë¼ë©´, ì´ë¯¸ë§Œë“¤ì–´ë†“ì€ pugíŒŒì¼ë“¤ì€ ì–´ë–»ê²Œ í•´ì•¼í•˜ë‚˜? ì—¬ê¸°ì„œëŠ” í”„ë¡ íŠ¸ì—”ë“œ(cssë§Œ ì²˜ë¦¬í• ê±°ê¸°ë•Œë¬¸ì— ìƒê´€ì´ì—†ë‚˜?)
  -> [ì„œë²„/í´ë¼ì´ì–¸íŠ¸ í…œí”Œë¦¿ì—”ì§„](https://imgzon.tistory.com/97)ì˜ ì°¨ì´ì´ë‹¤. +[Link](https://cceeun.tistory.com/163) +[Link](https://insight-bgh.tistory.com/252)

### SassyCSS

- ë³´í†µ Sassycssë¥¼ ê°€ì ¸ë‹¤ê°€ cssë¡œ ë³€í™˜ì‹œí‚¨ë‹¤. cssë¥¼ ì¡°ê¸ˆë” ì„¸ë ¨ë˜ê²Œ ì‘ì„±í•˜ëŠ” ì½”ë“œì¸ë“¯
- [ì§§ì€ì„¤ëª…](https://yunzema.tistory.com/269) [ê³µí™ˆ](https://sass-lang.com/guide) : ì´ ë¬¸ë²•ì„ ì“¸ë ¤ë©´ ë˜ ë¡œë”ê°€ í•„ìš”í•˜ë‹¤.
- ì²«ë²ˆì§¸ loader(sass-loader)ëŠ” sassë¥¼ ê°€ì ¸ë‹¤ê°€ ì¼ë°˜ cssë¡œ ë³€í˜•. ë‘ë²ˆì§¸(css-loader)ëŠ” í°íŠ¸ê°™ì€ê²ƒì„ ë¶ˆëŸ¬ì˜¬ë•Œ cssì— êµ‰ì¥íˆ ìœ ìš©í•˜ê²Œ ì“°ì¼ loader. ë§ˆì§€ë§‰(style-loader), ë³€í™˜í•œ cssë¥¼ ì›¹ì‚¬ì´íŠ¸ì— ì ìš©ì‹œí‚¬ loaderì´ë‹¤.(webpack.config.js) [Link](https://webpack.js.org/loaders/sass-loader/) ë¡œë”ëŠ” ë§ˆì§€ë§‰ì—ì„œë¶€í„° ì‹¤í–‰ë˜ê¸°ë•Œë¬¸ì— ìˆœì„œê°€ ê±°ê¾¸ë¡œì´ë‹¤.

### MiniCssExtractPlugin

- [í”ŒëŸ¬ê·¸ì¸](https://joshua1988.github.io/webpack-guide/concepts/plugin.html#plugin)ì´ë€? í”ŒëŸ¬ê·¸ì¸(plugin)ì€ ì›¹íŒ©ì˜ ê¸°ë³¸ì ì¸ ë™ì‘ì— ì¶”ê°€ì ì¸ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì†ì„±
- [MiniCssExtractPlugin](https://github.com/webpack-contrib/mini-css-extract-plugin)ì€ cssíŒŒì¼ì„ ë¶„ë¦¬í•´ì£¼ëŠ” ë…€ì„ì´ë‹¤.
- íŒŒì¼ì„ ë¶„ë¦¬ì‹œì¼œì£¼ê¸°ìœ„í•´ì„œê¸°ë–„ë¬¸ì— main.jsíŒŒì¼ë„ ë¶„ë¦¬ì‹œì¼œì¤˜ì•¼í•œë‹¤. ê·¸ ë°©ë²•ì€ webpack.config.jsíŒŒì¼ì„ ë³´ë©´ëœë‹¤.
- style-loaderì´ë¼ëŠ” loaderë¥¼ ì‚¬ìš©í•˜ë©´, javascriptì½”ë“œê°€ cssíŒŒì¼ì„ ì½ëŠ”ë°,
  ìš°ë¦¬ëŠ” cssíŒŒì¼ ë”°ë¡œ, jsíŒŒì¼ ë”°ë¡œ ì›¹íŒ©ìœ¼ë¡œ ë²ˆë“¤í™” ì‹œí‚¤ê³ ì‹¶ë‹¤. í•œë²ˆì— í•  ê²½ìš° js ë¡œë”©ì„ ê¸°ë‹¤ë ¤ì•¼í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ê·¸ë˜ì„œ MiniCssExcractPlugin.loaderë¥¼ ì‚¬ìš©í•œë‹¤.

### nodemon.json

- í”„ë¡ íŠ¸ì—”ë“œìª½ íŒŒì¼ì„ ê³ ì¹ ë•Œë§ˆë‹¤ nodemonì´ ì¬ì‹œì‘ë˜ëŠ” ê²½ìš°ê°€ ìƒê¹€. ê·¸ë˜ì„œ nodemon.jsoníŒŒì¼ì„ ì´ìš©í•´ì„œ ignoreí• ê±°ì„.

```js
//package.jsoníŒŒì¼
"scripts": {
  "dev": "nodemon --exec babel-node src/init.js",
  "assets": "webpack --config webpack.config.js"
},

// ì´ëŸ°ì‹ìœ¼ë¡œ ë°”ê¿€ìˆ˜ìˆë‹¤. webpackì€ ê¸°ë³¸ì ìœ¼ë¡œ webpack.configuraiton.jsíŒŒì¼ì„ ê¸°ë³¸ì ìœ¼ë¡œì°¾ê³ , nodemon.jsoníŒŒì¼ì„ ì°¾ëŠ”ë‹¤.
"scripts": {
  "dev:server": "nodemon",
  "dev:assets": "webpack"
},
```

<br>

## scssë¶€ë¶„ ë³´ë©´ì„œ ëŠë‚€ì 

- ë‘ê°€ì§€ê·œì¹™ ì²«ë²ˆì¨° home, join, login, searchê°™ì€ templateì„ ë§Œë“¤ì—ˆë‹¤ë©´ screení´ë”ì— screeníŒŒì¼ì„ ë§Œë“œëŠ”ê²ƒì´ë‹¤. ë‘ë²ˆì§¸ mixinì´ë‚˜ partialíŒŒì¼ì„ ë§Œë“¤ì—ˆë‹¤ë©´, componenets í´ë”ì— íŒŒì¼ì„ ë§Œë“¤ì–´ì•¼í•œë‹¤ëŠ”ê²ƒì´ë‹¤.
- screensì•ˆì—ëŠ” homeì´ë‘ searchê°™ì€ê±¸ ë„£ì„ê²ƒì´ë‹¤. URLì´ë¼ê³  ë³´ë©´ëœë‹¤.
- componentëŠ” headerë‚˜ footerê°™ì€ ê²ƒì´ë‹¤.(ì¦‰ ê³µìœ ë˜ëŠ” ê²ƒë“¤ì„ ë„£ëŠ”ê²ƒì´ë‹¤.) íŒŒì¼ì„ ì§ì ‘ë´ë³´ë©´ëœë‹¤.
- ìœ íŠœë¸Œë¥¼ í´ë¡ í• ê²ƒì´ê¸°ë–„ë¬¸ì— ìœ íŠœë¸Œ ìƒ‰ê¹”(ìƒ‰ê¹”ì½”ë“œ)ì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜¬ìˆ˜ìˆëŠ” ë„êµ¬ê°€ìˆë‹¤.
- reset.scss[https://meyerweb.com/eric/tools/css/reset/] : marginì´ë‚˜ ì´ëŸ°ê²ƒë“¤ì„ ëª¨ë‘ 0ìœ¼ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.
- pugíŒŒì¼ì„ êµ¬ì¡°í™”ì‹œí‚¬ë•Œ(partialì´ë‚˜ mixinìœ¼ë¡œ ìƒì„±) scssì—ë„ ê°™ì€ì´ë¦„ì˜ íŒŒì¼(componentí´ë”)ë“¤ì„ ë§Œë“¤ì–´ë†“ëŠ”ë‹¤.
- [font awesome](https://markettraders.kr/font-awesome/)ì„ ì‚¬ìš©í•˜ë©´ ìœ íŠœë¸Œ ì•„ì´ì½˜ë“±ì„ ì‚¬ìš©í• ìˆ˜ìˆë‹¤. ì‚¬ìš©í• ë–„ëŠ” pugì˜ ë¬¸ë²•ì„ ë³´ë©´ì„œ ì–´ë–»ê²Œ ì“°ëŠ”ì§€ ë³´ë©´ë ë“¯.
- videoë°°ì¹˜ëŠ” gridë¥¼ í™œìš©í–ˆë‹¤. shared.scssì™€ video.scss,home.scssë¥¼ ë³´ë©´ëœë‹¤. ì´ëŸ°ì‹ìœ¼ë¡œ íŒŒì¼ì„ ì„¸ì„¸í•˜ê²Œ ë‚˜ëˆ„ëŠ”ê²ƒì„ ì˜ë³´ë©´ ì¢‹ì„ë“¯ í•˜ë‹¤.
- css ë¬¸ë²• : [:not()](https://developer.mozilla.org/ko/docs/Web/CSS/:not)

  <br>

- ë³´ë©´ì„œ ëŠë‚€ì . ë¼ìš°í„°ë‘ cssì™€ ë§Œì°¬ê°€ì§€ë¡œ í•œê°€ì§€ì— íŒŒì¼ì— ëª¨ë“  í•„ìš”í•œ importë¥¼ ì²˜ë¦¬í•˜ëŠ”ê²Œ íŒŒì¼ë³´ëŠ”ê²Œ ê¹”ë”í•˜ê³  ì¢‹ì€ë“¯.(jsë„ ë§ˆì°¬ê°€ì§€ì¸ë“¯) ë¼ìš°í„°(ë¼ìš°í„°íŒŒì¼ì— ê¸°ë³¸ì ì¸ importë‹¤í•´ë†“ìŒ.)ë„ ì´ì œ ëŠë‚€ê±´ë°, importë¥¼ ì •ë¦¬í•´ë†”ì„œ
  ë”°ë¡œ ë‹¤ë¥¸íŒŒì¼ë§ˆë‹¤ ë™ì¼ëœ importë¥¼ í•´ì¤„í•„ìš”ê°€ ì—†ì—ˆìŒ(cssë„ ë§ˆì°¬ê°€ì§€, styles.scss)
- cssë„ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì²˜ëŸ¼ cssë¥¼ í• ìˆ˜ì‡ë‹¤ëŠ”ê²ƒì„ ì•Œìˆ˜ì‡ìŒ. í´ë˜ìŠ¤ì•ˆì— img, btnë“±ë“±
- edit-profile.pug, forms.scss, edit-profile.scssì„ ë³´ë©´ ì¢‹ì„ë“¯. ê°ê°ì˜ êµ¬ì„±ìš”ì†Œë§ˆë‹¤ cssë¥¼ ì–´ë–»ê²Œ ë„£ëŠ”ì§€, ì–´ë–»ê²Œ íŒŒì¼ì„ ë‚˜ëˆ´ëŠ”ì§€ë¥¼ ì•Œìˆ˜ìˆìŒ. base.pugì—ì„œ í†µí•©ì ìœ¼ë¡œ styles.scss(staticì •ì íŒŒì¼ ìš”ì²­ ê°œë…ì€ ìœ„ì—)ì— ìš”ì²­í•œë‹¤.(styles.scssëŠ” ëª¨ë“  scssíŒŒì¼ì„ importì„ í•œ ìƒíƒœì´ë‹¤.)
- ê²°ë¡ ì ìœ¼ë¡œ styles.scssëŠ” ëª¨ë“  scssíŒŒì¼ import ê·¸ë˜ì„œ base.pugì—ì„œ ìš”ì²­ì„ í•œë²ˆë§Œ ë˜ê²Œ í•´ì¤Œ, server.jsì™€ ê°ê°ì˜ ë¼ìš°í„°ë“¤ë„ importë¥¼ í•œë‹¤.(ë¼ìš°í„°ì™€ server.jsì— ì— ëŒ€í•´ í™•ì‹¤í•œ ê°œë…ì •ë¦¬ê°€ í•„ìš”í•œë“¯.) ê·¸ë˜ì„œ ë­”ê°€ íŒŒì¼ì„ ë³´ê¸°ì‰½ê²Œ í•´ì£¼ì—ˆë‹¤.

<br>

### video playerë§Œë“¤ê¸° , ì—¬ëŸ¬ë‹¤ë¥¸íŒŒì¼ë“¤ì„ webpackìœ¼ë¡œ í¬í•¨ì‹œí‚¤ëŠ” ë°©ë²•

- ì§€ê¸ˆ í˜„ì¬ì½”ë“œì— í•˜ë‚˜ì˜ main.jsê°€ ìˆëŠ”ë°, videoë¥¼ ë³¼ë•Œë§Œ videoplayer ì½”ë“œê°€ ë¡œë“œê°€ ë˜ë©´ ì¢‹ì•„ì„œ(í™ˆí™”ë©´ì—ì„œëŠ” ë¹„ë””ì˜¤ë¥¼ ë³¼ìˆ˜ê°€ ì—†ìœ¼ë‹ˆê¹Œ videoplayerì½”ë“œ(js)ë¥¼ ê°€ì ¸ì˜¤ë©´ ì•ˆì¢‹ë‹¤. ), íŒŒì¼ì„ ìª¼ê°¤ê²ƒì´ë‹¤.
- [Link](https://velog.io/@khw970421/Webpack-5%EC%9E%A5-output-%EC%97%AC%EB%9F%AC%ED%8C%8C%EC%9D%BC-%EB%B2%88%EB%93%A4%EB%A7%81)
- [ê³µí™ˆ](https://webpack.js.org/concepts/output/) ê²€ìƒ‰í‚¤ì›Œë“œ webpack multi output

<br>

### videoPlayerë§Œë“¤ê¸°

- ê³µì‹ë¬¸ì„œì— [MediaElement](https://developer.mozilla.org/ko/docs/Web/API/HTMLMediaElement) ì˜ ë‚˜ì™€ìˆë‹¤.
- videoPlayer.jsíŒŒì¼ì„ ë³´ë©´ ê±°ì˜ ë°”ë‹ë¼JSë‘ ë˜‘ê°™ë‹¤.
- ë¬´ì—‡ì¸ê°€ ë°±ì—”ë“œìª½ì˜ jsë‘ í”„ë¡ íŠ¸ìª½ì˜ jsë‘ ë‹¤ë¥´ë‹¤. í”„ë¡ íŠ¸ìª½ì€ ì´ë¯¸ ì „ë‹¬ë°›ì€ htmlì—ì„œ ë²„íŠ¼í´ë¦­ê°™ì€ê²ƒìœ¼ë¡œ(ì´ë²¤íŠ¸ë“¤ì„) ì´ê²ƒì €ê²ƒ ë‹¤ë£¨ëŠ”ê²ƒ ê°™ë‹¤. ë°±ì—”ë“œìª½ì€ ì–´ë–»ê²Œ ìƒê¸´ htmlì„ ì „ë‹¬í• ê²ƒì¸ê°€? ì´ëŸ° ê°œë…ì •ë„. í•œë²ˆ htmlë„˜ê²¨ì£¼ë©´ ëì´ë‹¤. ì´ì •ë„?(í”„ë¡ íŠ¸ì—”ë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì“°ë©´ ë˜ ë‹¤ë¦„)
- ì´ë ‡ê²Œ ë¹„ë””ì˜¤í”Œë ˆì´ì–´ ë§Œë“œëŠ” ê³¼ì •ì€, ì¼ë‹¨ í•„ìš”í•œ ë²„íŠ¼(ê¸°ëŠ¥)ë“¤ì„ ë§Œë“¤ê³  -> ë²„íŠ¼ì´ ì‘ë™í•˜ê²Œ ë§Œë“¤ê³  -> ì˜ˆì˜ê²Œ cssì²˜ë¦¬í•˜ëŠ”ê³¼ì •ìœ¼ë¡œ í•œë‹¤.
- [event handler envet argumnet](https://developer.mozilla.org/en-US/docs/Web/Events/Event_handlers) + [ì´ë²¤íŠ¸ì—ëŒ€í•˜ì—¬](https://webclub.tistory.com/340)
- [js input range](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/range) ì´ê²ƒì„ ë³´ë©´ ì–´ë–¤ ì´ë²¤íŠ¸ë“¤ì„ ë‹¤ë£°ìˆ˜ ì‡ëŠ”ì§€ ë³¼ìˆ˜ìˆë‹¤. ì—¬ê¸°ì„œëŠ” change(ë§ˆìš°ìŠ¤ë¥¼ ë”± ë†“ì„ë–„ ë°œìƒ) input(ë§ˆìš°ìŠ¤ ì›€ì§ì´ëŠ” ëŒ€ë¡œ ë°œìƒ) ê°€ìˆë‹¤.
- range, button, checkboxë“±ë“± ê°ê°ì˜ ìš”ì†Œë§ˆë‹¤ ìƒê¸°ëŠ” ì´ë²¤íŠ¸ë“¤ì´ ë‹¤ë¥´ë‹¤. [html ìš”ì†Œ](https://heropy.blog/2019/05/26/html-elements/)
- ë¹„ë””ì˜¤ì˜ ë©”íƒ€ ë°ì´í„° : metadataë€? videoë¹¼ê³  ë‹¤ë¥¸ ê²ƒ(ì›€ì§ì´ëŠ”ê±° ë§ê³ )ì„ ë§í•œë‹¤. ê·¸ë˜ì„œ ì´ í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì•¼ ë¹„ë””ì˜¤ì˜ ì´ ì‹œê°„ì„ ì•Œìˆ˜ìˆë‹¤. [videoì˜ ì „ì²´ ê¸¸ì´ ê°€ì ¸ì˜¤ê¸°](https://m.blog.naver.com/ivory82/220096880567) + [StackOverFlow](https://stackoverflow.com/questions/40763057/trying-to-get-full-video-duration-but-returning-as-nan/40763111)
  > JSì—ì„œ eventlistenerì„ ì¶”ê°€í•˜ê¸° ì „ì— videoê°€ ì „ë¶€ ë¡œë”©ì´ ë˜ì–´ì„œ, handleLoadedMetadata() ê°€ ì•„ì˜ˆ ë¶ˆëŸ¬ì§€ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  > í•´ê²°ë²•ì€ videoPlayer.js ëë¶€ë¶„ ì¯¤ì— í•˜ë‹¨ì˜ ì½”ë“œë¥¼ ë¶™ì—¬ë„£ëŠ” ê²ƒì…ë‹ˆë‹¤.
  > if (video.readyState == 4) {
  > handleLoadedMetadata();
  > }
  > video.readyStateê°€ 4ë¼ëŠ” ëœ»ì€ videoê°€ ì¶©ë¶„íˆ ë¶ˆëŸ¬ì™€ì ¸ì„œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤. ìì„¸í•œ ì •ë³´ëŠ” https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/readyState ì°¸ê³ í•˜ì„¸ìš”.
- ì´ í˜„ìƒì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•´ì„œ ë¸”ë¡œê·¸ ê¸€ë„ í•˜ë‚˜ ì˜¬ë ¤ ë³´ì•˜ìŠµë‹ˆë‹¤. ì°¸ê³  ì›í•˜ì‹œëŠ” ë¶„ë“¤ì€ ì°¸ê³ í•˜ì„¸ìš”. [ê²Œì‹œë¬¼](https://kasterra.github.io/inconsistent-event-firing-with-html5-video/)
- video í˜ëŸ¬ê°€ëŠ” ì‹œê°„ì„ í‘œí˜„í•˜ê¸°ìœ„í•´ì„œ date() í¬ë§·ì„ ì´ìš©í•´ í‘œí˜„í• ê±°ì„. ì™œ? ë”°ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ importí•  í•„ìš”ë„ ì—†ê³ , 584ì´ˆê°™ì€ ê¸¸ì´ì˜ ë™ì˜ìƒì´ ìˆì„ë•Œ ìë™ìœ¼ë¡œ ë¶„ ì´ˆ ë¡œ ìª¼ê°œì£¼ë‹ˆê¹Œ
- [Fullscreen API](https://developer.mozilla.org/en-US/docs/Web/API/Fullscreen_API) APIí˜•íƒœë¡œ ì œê³µí•œë‹¤ê³  í•œë‹¤.
- [setTimeout, clearTinmeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) videoì˜ controls(ë²„íŠ¼ë“¤)ì„ ì¡°ì‘í•˜ê¸°ìœ„í•´
- [font awesome ì•„ì´ì½˜ ì‚¬ìš©ë²•](https://uxgjs.tistory.com/186)
- [ì•„ì´ì½˜ ìˆ¨ê¸°ê¸° opacity](https://developer.mozilla.org/ko/docs/Web/CSS/opacity) íˆ¬ëª…ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
- [scss "&" ì˜ë¯¸](https://99geo.tistory.com/5) ì²˜ìŒì—ëŠ” cssì— ì¡´ì¬í•˜ëŠ” ë¬¸ë²•ì¸ ì¤„ ì•Œì•˜ëŠ”ë° scssì— ì¡´ì¬í•˜ëŠ”ê±°ì˜€ìŒ.
- video-player ë¥¼ ë³´ë©´ì„œ ì–´ë–»ê²Œ cssí™œìš©í•˜ëŠ”ì§€ ë³´ë©´ì¢‹ì„ë“¯.

<br>

### ì¡°íšŒìˆ˜ê¸°ëŠ¥ê³¼ api

- ë°±ì—”ë“œê°€ í…œí”Œë¦¿ê¹Œì§€ ë Œë”ë§í•˜ê³ ì‡ëŠ”ë° ì´ ë°©ì‹ì„ ë°”ê¿”ë³¼ê±°ì„.
- ì¦‰, urlì´ ë°”ë€Œì§€ì•Šê³  ì¡°íšŒìˆ˜ê°€ ëŠ˜ì–´ë‚˜ê²Œ.
- ìš°ë¦¬ê°€ ë§Œë“  apiì— ìš”ì²­ì„ë³´ë‚¼ê±°ì„. (videoPlayer.jsì˜ handleEnded)
- [data attribute](https://velog.io/@yunsungyang-omc/HTML-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%86%8D%EC%84%B1-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0-data-attribute) : ë°±ì—”ë“œì—ì„œ ë Œë”ë§ video idë¥¼ ì–»ì„ë ¤ê³ , ì—¬ê¸°ì„œ ì•Œìˆ˜ìˆëŠ”ì ì€ ë°±ì—”ë“œê°€ ê·¸ëƒ¥ htmlê·¸ ìì²´ë§Œ ë Œë”ë§í•´ì¤€ë‹¤ëŠ” ì‚¬ì‹¤ì´ë‹¤.
- [sendStatusì™€ statusëŠ” ë‹¤ë¥´ë‹¤.](https://expressjs.com/ko/api.html#res.sendStatus) statusë§Œ ì“¸ê²½ìš°ì—ëŠ” renderë¥¼ í•´ì¤˜ì•¼ ì˜ë¯¸ê°€ìˆëŠ”ë°(renderì•ˆí•´ì£¼ë©´ ê³„ì† pendingí•¨), sendStatusëŠ” ê·¸ëƒ¥ ìƒíƒœì½”ë“œë§Œ ë³´ë‚´ê³  ì—°ê²°ì„ ëŠëŠ”ë‹¤. (videoController.js registerView)
- [fetchí•¨ìˆ˜](https://www.daleseo.com/js-window-fetch/) ë°±ì—”ë“œì™€ ì •ë³´ë¥¼ êµí™˜í•˜ê¸°ìœ„í•´

<br>

### Recorder, recoder.js

- [API](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia) ë˜ ì œê³µí•¨. ê·¸ëƒ¥ previewì²˜ëŸ¼ ë¯¸ë¦¬ë³´ê¸°ë§Œ ì œê³µí•˜ëŠ”ê±°ì„ ë³´ì—¬ì£¼ê¸°ë§Œí•˜ê³  ì €ì¥ì´ì•ˆëŒ.
- í”„ë¡ íŠ¸ì—”ë“œì—ì„œ async&awaitë¥¼ ì‚¬ìš©í• ë ¤ë©´ [regenerator-runtime](https://www.npmjs.com/package/regenerator-runtime)ì„ ê¹”ì•„ì•¼í•¨.
- [srcObject](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/srcObject)
- ë‚´ê°€ í˜¼ìí•œë‹¤ë©´ ì–´ë–»ê²Œ ì•Œìˆ˜ìˆì„ê¹Œ -> [Link](https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API/Recording_a_media_element) ì—¬ê¸°ì„œ ë‹¨ì„œë¥¼ ì–»ì–´ê°€ë©´ì„œ í•˜ëŠ”ê²Œì•„ë‹ˆë©´ í˜ë“¤ë“¯. ê³µì‹ APIë¬¸ì„œì—ì„œ ê°€ì´ë“œë¥¼ ëˆ„ë¥´ë©´ ëœ¸.
- ondataavailable : ë…¹í™”ë¥¼ ì‹œì‘í•˜ë©´ ê·¸ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ì´ìš©í• ì§€ë¥¼ ë¯¸ë¦¬ ì •í•˜ëŠ” ë“¯. ë…¹í™”ê°€ ì¢…ë£Œë˜ë©´ ë°œìƒë˜ëŠ” ì´ë²¤íŠ¸
- [removeEventListener](https://developer.mozilla.org/ko/docs/Web/API/EventTarget/removeEventListener)ì„ ì´ëŸ°ì‹ìœ¼ë¡œ ì´ìš©í• ìˆ˜ ìˆë‹¤.
- createObejectURL ê·¸ëƒ¥ íŒŒì¼ì„ ê°€ë¦¬í‚¤ê³  ìˆëŠ” URLì´ë¼ê³  ìƒê°í•˜ë©´í¸í•¨(ê·¸ íŒŒì¼ì— ì ‘ê·¼í• ìˆ˜ ìˆê²Œ). ë¸Œë¼ìš°ì €ë©”ëª¨ë¦¬ì—ì„œë§Œ ê°€ëŠ¥í•œ URLì„ ë§Œë“¤ì–´ì¤€ë‹¤. ë¸Œë¼ìš°ì €ìƒì— ì¡´ì¬í•˜ê³  ë¸Œë¼ìš°ì €ì—ì„œë§Œ íŒŒì¼ì— ì ‘ê·¼í• ìˆ˜ ìˆë‹¤. ë¸Œë¼ìš°ì €ê°€ íŒŒì¼ì„ ë³´ì—¬ì£¼ëŠ” ë°©ë²•ì„.
- ë‹¤ìš´ë¡œë“œë²„íŠ¼ì„ ë§Œë“¤ì–´ë³¼ê±°ì„ ì‚¬ì‹¤ ì˜¤ë¥¸ìª½í´ë¦­í•´ì„œ í•˜ë©´ë˜ê¸´í•˜ëŠ”ë° ë‚´ê°€ ì§ì ‘ ë§Œë“¤ì–´ì„œ ì‚¬ìš©ìì—ê²Œ ì œê³µí• ê±°ì„. aíƒœê·¸ë¥¼ ì´ìš©í•´ì„œ í• ìˆ˜ìˆëŠ” ì´ìœ ê°€ ë­˜ê¹Œ? videoê°€ urlí˜•ì‹ìœ¼ë¡œ ì ‘ê·¼í• ìˆ˜ìˆì–´ì„œ ì¸ë“¯. [stackoverflow](https://stackoverflow.com/questions/29900551/how-to-add-a-download-video-button-to-html5-player/29965788) ê²€ìƒ‰í‚¤ì›Œë“œ : html5 video create download button , [ì¶”ê°€ì ì¸ ë§í¬](https://miaow-miaow.tistory.com/83)
- FFmpeg : webmíŒŒì¼ì„ mp4íŒŒì¼ë¡œ ë°”ê¿€ê±°ì„. ë¹„ë””ì˜¤ì— ê´€í•œ ëª¨ë“ ê²ƒì„ í• ìˆ˜ìˆìŒ.
  í•˜ì§€ë§Œ ì‹¤í–‰í•˜ë©°ë…€ ë°±ì—”ë“œì—ì„œ ì‹¤í–‰í•´ì•¼í•˜ëŠ”ë° ê·¸ê±´ ë¹„ì‹¸ë‹¤.
- [WebAssembly](https://developer.mozilla.org/ko/docs/WebAssembly) : ì‹¤í–‰ë¹„ìš©ì´ í° í”„ë¡œê·¸ë¨ë“¤ì„ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰í• ìˆ˜ìˆë‹¤. cë¡œ ì´ë£¨ì–´ì§„ ffmpegë¥¼ ì‹¤í–‰ì‹œí‚¬ìˆ˜ ìˆë‹¤. ë‹¤ë¥¸ì–¸ì–´ë¡œ ì´ë£¨ì–´ì§„ê²ƒì„ jsì—ì„œ ì‹¤í–‰. ë³´í†µì€ ë°±ì—”ë“œì—ì„œë§Œ ì‚¬ìš©ì´ ê°€ëŠ¥í–ˆëŠ”ë°, í”„ë¡ íŠ¸ì—”ë“œì—ì„œë„ ì“¸ìˆ˜ìˆì–´ì¡Œë‹¤.
- ì´ ë‘ê°€ì§€ê°€ ê²°í•©ëœ [ffmpeg.wasm](https://ffmpegwasm.netlify.app/#demo) ì‚¬ìš©í• ê²ƒì´ë‹¤. ì‚¬ìš©ìì˜ ì»´í“¨í„°ë¥¼ ê°€ì§€ê³  í• ê±°ì„. ê°€ìƒì˜ ì»´í“¨í„°ë¥¼ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰í•˜ëŠ” ê·¸ëŸ°ëŠë‚Œ. ë¬¼ë¡  í”„ë¡ íŠ¸ì—”ë“œì—ì„œì´ë‹¤. ì‚¬ì‹¤ ë§ì´ ì–´ë µë‹¤. ê·¸ëƒ‰ ì ‘í•´ë³´ëŠ”ì •ë„ë¡œ ë§Œì¡±í•´ì•¼í• ë“¯.
- ì—ëŸ¬ê°€ ë„ˆë¬´ë§ìŒ
  > >

1. ë‹¤ë¥¸ë¶„ë“¤ì€ ë˜ì‹œëŠ”ì§€ ëª¨ë¥´ê² ì§€ë§Œ ìµœì‹ ë²„ì „ìœ¼ë¡œ ì„¤ì¹˜í•˜ë‹ˆ ì „ 400 ì—ëŸ¬ ë‚˜ë„¤ìš”.
   npm install @ffmpeg/ffmpepg@0.9.7 @ffmpeg/core@0.8.5
   ë¡œ ì„¤ì¹˜í•˜ë‹ˆ ì œëŒ€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

2. Uncaught ReferenceError: createFFmpegCore is not defined at HTMLScriptElement.eventHandler (getCreateFFmpegCore.js:101))

1ï¸âƒ£ server.js
app.use("/convert", express.static("node_modules/@ffmpeg/core/dist"));
2ï¸âƒ£ recorder.js
const ffmpeg = createFFmpeg({
corePath: "/convert/ffmpeg-core.js",
log: true,
});

3. Uncaught (in promise) ReferenceError: SharedArrayBuffer is not defined
   ì´ê±´
   app.use((req, res, next) => {
   res.header("Cross-Origin-Embedder-Policy", "require-corp");
   res.header("Cross-Origin-Opener-Policy", "same-origin");
   next();
   });
   [ë§í¬](https://stackoverflow.com/questions/64962224/how-to-use-ffmpeg-wasm-in-firefox-without-getting-the-sharedarraybuffer) ë‚˜ì¤‘ì— ë” ë§ì´ ì•Œê²Œë˜ë©´ ë‹¤ì‹œë³´ëŠ”ê²Œ ì¢‹ì„ë“¯.
   <br>

ëˆ„ê°€ë˜ ì •ë¦¬í•´ë†ˆ 4. ë²„ì „ ë‹¬ë¼ì„œ ì—ëŸ¬ë‚¬ì„ë•Œ âœ…
-> ë‹ˆì½”ìŒ¤ ì‚¬ìš©í•˜ì‹œëŠ” ë²„ì „ ì„¤ì¹˜
npm install @ffmpeg/core@0.8.5
npm install @ffmpeg/ffmpeg@0.9.7
recorder.jsì—
corePath: "https://unpkg.com/@ffmpeg/core@0.8.5/dist/ffmpeg-core.js" ë¶™ì—¬ì“°ê¸°

sharedArrayBuffer ì—ëŸ¬ë‚¬ì„ë•Œ âœ…
-> ì§ˆë¬¸í•´ì£¼ì‹  ë¶„ ì´ìŠˆì—ì„œ ë‹ˆì½”ìŒ¤ì˜ ë‹µë³€ ì°¸ê³ í•´ì„œ ë˜ì—ˆìŠµë‹ˆë‹¤
ë§í¬: https://nomadcoders.co/wetube/lectures/2776/issues/1707
ğŸ“Œë‹ˆì½”ìŒ¤ì˜ ë‹µë³€:
Add this before your routers.

app.use((req, res, next) => {
res.header("Cross-Origin-Embedder-Policy", "require-corp");
res.header("Cross-Origin-Opener-Policy", "same-origin");
next();
});

And add crossorigin to the github avatar in header.pug

img.header\_\_avatar(src=loggedInUser.avatarUrl,crossorigin)

ë‹ˆì½”ìŒ¤ ì§± Nico teacher is the BestğŸ‘ í™”ì´íŒ…í•©ì‹œë‹¹

- [HTTP êµ¬ì¡° ë° í•µì‹¬ ìš”ì†Œ](https://velog.io/@teddybearjung/HTTP-%EA%B5%AC%EC%A1%B0-%EB%B0%8F-%ED%95%B5%EC%8B%AC-%EC%9A%94%EC%86%8C)
  ì½ì–´ë³´ë©´ ì¢‹ì„ë“¯.
- [Blob ë¸”ë¡­](https://m.blog.naver.com/magnking/220950061851)
- [buffer](https://lienkooky.tistory.com/93) ì•„ì§ì—¬ê¸°ê¹Œì§€ ì´í•´ê°€ ì˜ì•ˆê°.

<br>

### ì¸ë„¤ì¼

- ì¸ë„¤ì¼ì¸ ì´ë¯¸ì§€íŒŒì¼ê³¼ ë¹„ë””ì˜¤íŒŒì¼ 2ê°€ì§€ë¥¼ ë³´ë‚´ì•¼ëŒ. ì´ì „ì— expressì—ì„œ íŒŒì¼ì„ ì²˜ë¦¬í•˜ê¸°ìœ„í•´ multerë¼ëŠ”ê²ƒì„ ì»ëŠ”ë°, ê·¸ì¤‘ì— fieldsë¼ëŠ”ê²ƒìœ¼ë¡œ êµ¬ë³„í• ìˆ˜ìˆìŒ. [multer](https://www.npmjs.com/package/multer) ì£¼ì˜í• ì ì€ req.filesì— ì €ì¥ëŒ. req.fileì•„ë‹ˆë¼.
- recorder.jsì—ì„œ ì˜ìƒê³¼ ì¸ë„¤ì¼ì„ ë§Œë“¤ê³  video.pug formì—ì„œ postë¥¼ í•œë’¤ routerì—ì„œ multerë¯¸ë“¤ì›¨ì–´ë¥¼ ê±°ì³ì„œ videoControllerì—ì„œ postuploadí•¨ìˆ˜ë¥¼ ì“´ë‹¤.

### flash message

- ì‚¬ìš©ìì—ê²Œ messageë¥¼ ë‚¨ê¸¸ìˆ˜ìˆìŒ. sessionì— ê·¼ê±°.
- í…œí”Œë¦¿ì—ì„œ ì‚¬ìš©í• ìˆ˜ìˆê²Œ , messagesë¼ëŠ” localsë¥¼ ì‚¬ìš©í•˜ê²Œ í•´ì¤€ë‹¤.

```js

```

- ë‹ˆê¼¬ í•´ë‹µ. [Link](https://nomadcoders.co/wetube/lectures/2794/issues/1556)

<br>

# ëŒ“ê¸€ì°½ ë§Œë“¤ê¸°. ì¤‘ìš”í•œ ë‚´ìš©ì´ ë§ì´ë‚˜ì˜´. í”„ë¡ íŠ¸ì—”ë“œê°€ í° objectë¥¼ ë°±ì—”ë“œë¡œ ë³´ë‚¼ë–„

- ì§€ê¸ˆê¹Œì§€ í”„ë¡ íŠ¸ì—”ë“œ(client)ì—ì„œ ë°±ì—”ë“œë¡œ ë³´ë‚´ëŠ” ë°©ë²•ì„ ë°°ìš°ì§€ ëª»í–ˆìŒ. ë­”ê°€ ë°”ë¡œ clientê¹Œì§€ ê°€ì§€ì•Šê³  pugì™€ ë¼ìš°í„°ì„ ì—ì„œ ì²˜ë¦¬í–ˆë‹¤ê³  í•´ì•¼í• ê¹Œ..
- ì‚¬ì‹¤ fetchë¥¼ í†µí•´ urlë¡œ ë³´ë‚¼ìˆ˜ ìˆë‹¤. í´ë¼ì´ì–¸íŠ¸ì™€ ë°±ì—”ë“œê°€ í†µì‹ í•˜ëŠ”ê²ƒì˜ ì¤‘ê°„ì—­í• ì´ apiì´ë‹¤.
- req.paramsì€ ì˜ ì‘ë™í•˜ëŠ”ë° req.body ì¶œë ¥í•˜ë©´ ì•„ë¬´ê²ƒë„ ì—†ë‹¤. ì„œë²„ê°€ ì´í•´í• ë§Œí•œê²ƒì„ ë³´ë‚´ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ë‹¤.
- í”„ë¡ íŠ¸ì—”ë“œê°€ ë°±ì—”ë“œì— ë°ì´í„°ë¥¼ ì£¼ëŠ”ê²ƒì€ [fetch](https://www.daleseo.com/js-window-fetch/)(fetch ì‚¬ìš©ë²•)ì¸ ë“¯.
- ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ë•Œ JSONìœ¼ë¡œ í†µì¼ì„ ì‹œì¼œì¤˜ì•¼ ì„œë¡œê°€ ì½ê³  ë³´ë‚¼ìˆ˜ìˆë‹¤.
- fetch requestë¥¼ ë³´ë‚´ë©´(networkì—ì„œ ë¬´ì—‡ì„ ë³´ëƒˆê³ , ë°›ì•˜ëŠ”ì§€ í™•ì¸ê°€ëŠ¥.) ì¿ í‚¤ë¥¼ í¬í•¨í•´ì„œ ì—¬ëŸ¬ê°€ì§€ ì •ë³´ë¥¼ ë³´ë‚¸ë‹¤. ê·¸ì¤‘ì—ì„œ ì¿ í‚¤ë¥¼ í†µí•´ ì–´ë–¤ ì„¸ì…˜(session)ì—ì„œ ë³´ëƒˆëŠ”ì§€ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.

```js
// req.paramsì€ ì˜ ì‘ë™í•˜ëŠ”ë° req.body ì¶œë ¥í•˜ë©´ ì•„ë¬´ê²ƒë„ ì—†ë‹¤. ì„œë²„ê°€ ì´í•´í• ë§Œí•œê²ƒì„ ë³´ë‚´ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ë‹¤. -> JSONìœ¼ë¡œ ë°”ê¿”ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ë‹¤.
const handleSubmit = (event) => {
  event.preventDefault();
  const textarea = form.querySelector("textarea");
  const text = textarea.value;
  const videoId = videoContainer.dataset.id;
  fetch(`/api/videos/${videoId}/comment`, {
    method: "POST",
    body: {
      text,
    },
  });
};

// fetchë¶€ë¶„ì„ ì´ëŸ°ì‹ìœ¼ë¡œ ë°”ê¿”ì£¼ë©´ ëœë‹¤.
fetch(`/api/videos/${videoId}/comment`, {
    method: "POST",
    body: {
      text,
    headers: {
      "Content-Type": "application/json", // expressì—ê²Œ ì´ê±´ jsonì´ë¼ê³  ì•Œë ¤ì£¼ëŠ”ê²ƒì´ë‹¤.
    },
    body: JSON.stringify({ text }),
  });

// server.js, jsoníŒŒì¼ì„ ë³´ëƒˆìœ¼ë‹ˆ objectë¡œ ë°”ê¿”ì¤˜ëŠ” ë¯¸ë“¤ì›¨ì–´ì´ë‹¤.
app.use(express.json());

```

- [javascript - Express ë° Fetchë¡œ POST ìš”ì²­ ë³¸ë¬¸ ê°€ì ¸ ì˜¤ê¸°](https://www.python2.net/questions-1131541.htm), ê°•ì˜ì—ì„œëŠ” body paserë¥¼ ì“°ì§€ì•Šì•˜ë‹¤.

> (BIG ì¤‘ìš” í¬ì¸íŠ¸) ìš”ì•½:

1. [fetch](https://ljtaek2.tistory.com/130)ë¡œ ë°±ì—”ë“œì— ìš”ì²­ì„ ë³´ë‚¼ ë•Œì—
   method: "POST",
   headers: {},
   body: {},

URLê³¼ ë”ë¶ˆì–´ ì´ ì„¸ ê°€ì§€ë¥¼ ë§ë¶™ì—¬ì•¼ í•œë‹¤.

2. headersì—ëŠ” ì´ ìš”ì²­ì˜ ì„¸ë¶€ ì‚¬í•­ì„ ëª…ì‹œí•˜ë©°, bodyì—ëŠ” ì‹¤ì§ˆì ì¸ ì»¨í…ì¸ ê°€ í¬í•¨ëœë‹¤.

3. ë”°ë¡œ ëª…ì‹œí•˜ì§€ ì•Šì„ ì‹œì— ëª¨ë“  bodyì˜ ì»¨í…ì¸ ëŠ” Text Fileë¡œì„œ ì „ì†¡ë˜ê³  ë°›ì•„ ì¸ì‹ëœë‹¤.

4. íŠ¹íˆ body: { ... }, ì´ëŸ° ì‹ìœ¼ë¡œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì˜¤ë¸Œì íŠ¸ë¥¼ ë„˜ê²¨ì¤„ ì‹œ ì™¸ë¶€ì—ì„œ ì´ ì˜¤ë¸Œì íŠ¸ëŠ” [object Object]ë¼ëŠ” ì˜ë¯¸ ì—†ëŠ” ë¬¸ìì—´ë¡œ ë³€í™˜ëœë‹¤.

5. ì˜¤ë¸Œì íŠ¸ì™€ ê·¸ ì•ˆì˜ ì„¸ë¶€ ë³€ìˆ˜ ëª©ë¡ë“¤ì„ ë„˜ê²¨ì£¼ê³  ì‹¶ì„ ì‹œ, JSONì´ë¼ëŠ” ê·œì•½ì— ì˜ê±°í•œ ì˜¤ë¸Œì íŠ¸ ë‚´ì˜ ëª¨ë“  ê¸°ë¡ì„ í…ìŠ¤íŠ¸í™”í•˜ì—¬ ë„˜ê²¨ì£¼ì–´ì•¼ í•˜ëŠ”ë°, ì´ë•Œ JSON.stringify({ ... }) ë¼ëŠ” í¸ë¦¬í•œ ìì²´ í‘œì¤€ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

6. ë§ë¶™ì—¬ headers ì•ˆì— "Content-Type": "application/json"ì´ë¼ëŠ” ëª…ì‹œë¥¼ í•´ ì£¼ì–´ ì „ì†¡ëœ í…ìŠ¤íŠ¸ê°€ JSONíŒŒì¼ì„ì„ ë°±ì—”ë“œì— ì¸ì‹ì‹œì¼œ ì¤€ë‹¤.

7. ë°±ì—”ë“œì— (ì´ë¥¼í…Œë©´ expressë¥¼ ì‚¬ìš© ì¤‘ì´ë¼ë©´) app.use(express.json()); ë¯¸ë“¤ì›¨ì–´ë¥¼ ì¶”ê°€í•´ì£¼ì–´ ìì²´ ë‚´ì—ì„œ JSON.parse("..."); JSONíŒŒì¼ì„ ë‹¤ì‹œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì˜¤ë¸Œì íŠ¸ë¡œ ë³€í™˜í•´ì£¼ëŠ” í‘œì¤€ í•¨ìˆ˜ë¡œ ìš”ì²­ body ë‚´ì˜ ì»¨í…ì¸ ë¥¼ ë””ì½”ë”©í•˜ëŠ” ì‘ì—…ì„ í•œë‹¤.

<br>

### req.flash error

```js userController.js
export const logout = (req, res) => {
  req.session.destroy(); //ì´ë ‡ê²Œ í–ˆë”ë‹ˆ sessionsì´ í•„ìš”í•˜ë‹¥ ì—ëŸ¬ê°€ ëœ¸.
  req.flash("info", "Bye Bye");
  return res.redirect("/");
};
```

- ìê¾¸ ë¡œê·¸ì•„ì›ƒí•˜ë©´ undefinedì—ëŸ¬ê°€ ëœ¨ê³  í–‡ë”ë‹ˆ req.flash() ì„ ì§€ì› ë”ë‹ˆ ì—ëŸ¬ê°€ ì‹¹ë‹¤ ì‚¬ë¼ì§ ê·¸ëƒ¥ ë„ˆë¬´ í—›ìˆ˜ê³ í•œë“¯. ë‚˜ì¤‘ì— ì´ë¬¸ì œì— ëŒ€í•´ ê²€ìƒ‰í•´ë´ì•¼í• ë“¯.

### ëŠë‚€ì 

- ë¬¸ì„œë“¤ì„ ì²˜ìŒë³´ë©´ ì˜ˆì œë“¤ì´ ì‡ëŠ”ë° ì´ê²Œ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ ê²€ìƒ‰í•´ë³´ë©´ì„œ ì •ë¦¬í•˜ë©´ í° ë„ì›€ì´ ë ë“¯. ë¬¸ì„œë¿ë§Œ ì•„ë‹ˆë¼ ë‚¨ì˜ ì½”ë“œë“¤ë„.
- ë­”ê°€ ì½”ë”©ì€ ë°˜ë³µë˜ëŠ” ë¶€ë¶„ì„ ì¤„ì´ê³ ,ì´ê±°ëŠ” ìˆì„ë²•í•œ ê±´ë°í•˜ë©´ ìˆê³ , ë³µì¡í•´ë³´ì´ë©´ ë‚˜ëˆ„ê³  ì´ê²Œ ì¤‘ìš”í•œë“¯ í•˜ë‹¤.
- ë­”ê°€ ì´í•´ê°€ ì˜ ì•ˆê°„ë‹¤ ì‹¶ìœ¼ë©´ ì§ì ‘ í•´ë³´ëŠ”ê²Œ ì¤‘ìš”í•œê±°ê°™ë‹¤. ì™œ ì´ë ‡ê²Œ í–ˆì§€? ì´ë ‡ê²Œ í•˜ë©´ ì•ˆë˜ë‚˜?
- ë¬¸ì„œë¥¼ ì½ì„ë•Œ pameterì— ì–´ë–¤ê²ƒì´ ë“¤ì–´ê°€ëŠ”ì§€ë„ ì˜ ë³´ëŠ”ê²Œ ì¤‘ìš”í• ê±°ê°™ë‹¤. (mongoose findì˜ pameterì— mongodb selectorë¥¼ ì“¸ìˆ˜ì‡ëŠ”ê²ƒì²˜ëŸ¼.) ì¦‰ ê¼¼ê¼¼íˆ ì½ì–´ë³´ì.
- ë¬´ì—‡ì¸ê°€ ì–´ë–¤í•„ìš”í•œ ê¸°ëŠ¥ì„ í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì°¾ì„ë•Œ, jsê°€ ê¸°ë°˜ì´ì•„ë‹ˆë¼, ì„œë²„ê°€ ê¸°ë°˜ì´ì–´ì•¼í•˜ëŠ”ë“¯? ë¬´ì—‡ì´ baseì´ ì¸ì§€ ì˜ ì•Œì•„ì•¼í• ê±°ê°™ë‹¤. nodejsì— ì´ê²ƒì €ê²ƒ ë¶™ì—¬ì„œ ì“°ëŠ”ê±°ë‹ˆê¹Œ.
- ê¸°ëŠ¥ë³„ë¡œ íŒŒì¼ë“¤ì„ ì–´ë–¤ì‹ìœ¼ë¡œ ë¶„ë¦¬í•˜ê³ , importí•˜ëŠ”ì§€ë¥¼ ì˜ ë°°ì›Œì•¼ í• ê±° ê°™ë‹¤.
- ì˜¤ë¥˜ê°€ ìˆëŠ”ì§€ íŒë‹¨í• ë ¤ë©´ ì„œë²„ìƒì˜ ì½˜ì†”ì—ì„œ ì˜¤ë¥˜ê°€ ìˆëŠ”ì§€, ë¸Œë¼ìš°ì €ìƒì—ì„œ ì½˜ì†”ë¡œê·¸ë¥¼ ë³´ê³ , ë°ì´í„°ê°€ ì˜ fetchë˜ëŠ”ì§€ í™•ì¸í• ë ¤ë©´ browserì—ì„œ networkë¥¼ ë³´ë©´ ë  ë“¯ í•˜ë‹¤.

### í”„ë¡œê·¸ë˜ë¨¸ë“¤ì—ê²Œ ë°”ì´ë¸”ì¸ì±… clean code ì—ì„œ ë‹ˆê¼¬ê°€ ë°°ìš´ê²ƒ

- ì¼ë‹¨ì€ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ë”ëŸ¬ì›Œë„ ìƒê´€ì—†ìŒ.
- ì½”ë“œë¥¼ ì‘ì„±í•œ ì‹œê°„ë§Œí¼ ì½”ë“œë¥¼ ì •ë¦¬ë¥¼ í•˜ëŠ”ë°ì— ì‹œê°„ì„ ì“°ëŠ”ê±°ì„

### ì‚¬ìš©í•œê²ƒë“¤

- Server: nodejs, express, npm <-> npxë€? + babel ,morgan, express-session , connect-mongo , dotenv , node-fetch , multer
- Template: pug
- DB: mongoDB, monsgoose
- xcodeë€?
- front-end , webpack, wepack-cli , babel-loader(webpack)+ css-loader + style-loder, mini-css-extract-plugin , font-awesome , regenerator-runtime , express-flash

### ì–´ë– í•œê²ƒì„ ë§Œë“¤ë–„ ì–´ë–¤ ìŠ¤íƒ,ê¸°ìˆ ì„ ì‚¬ìš©í• ê²ƒì¸ì§€ì—ëŒ€í•´ ì•Œì•„ì•¼í• ë“¯. ê·¸ëŸ´ë ¤ë©´ ì–´ë–¤ ìŠ¤íƒ,ê¸°ìˆ ë“±ì´ í•„ìš”í•œì§€ ì •ë¦¬í•´ë´ì•¼í• ë“¯.í´ë¡ ì½”ë”©í• ë•Œë„ ì–´ë–¤ ìŠ¤íƒ,ê¸°ìˆ ì´ ì‚¬ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ”ê²Œ ì¢‹ì„ë“¯. í”„ë ˆì„ì›Œí¬ ê³µë¶€ë°©ë²•ë„ ì•Œì•„ë³´ë©´ì¢‹ì„ë“¯.

### ë‹¤ë¥¸ì‚¬ëŒì´ í•œê²ƒ

- https://github.com/junghyuntaek/taektube/tree/master/src
